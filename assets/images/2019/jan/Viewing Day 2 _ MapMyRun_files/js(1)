var mmf_mapping_api;!function(){if(!mmf_mapping_api||!mmf_mapping_api.requirejs){mmf_mapping_api?require=mmf_mapping_api:mmf_mapping_api={};var requirejs,require,define;!function(Z){function H(e){return"[object Function]"===L.call(e)}function I(e){return"[object Array]"===L.call(e)}function y(e,t){if(e){var i;for(i=0;i<e.length&&(!e[i]||!t(e[i],i,e));i+=1);}}function M(e,t){if(e){var i;for(i=e.length-1;i>-1&&(!e[i]||!t(e[i],i,e));i-=1);}}function t(e,t){return ga.call(e,t)}function l(e,i){return t(e,i)&&e[i]}function F(e,i){for(var n in e)if(t(e,n)&&i(e[n],n))break}function Q(e,i,n,s){return i&&F(i,function(i,o){(n||!t(e,o))&&(s&&"string"!=typeof i?(e[o]||(e[o]={}),Q(e[o],i,n,s)):e[o]=i)}),e}function u(e,t){return function(){return t.apply(e,arguments)}}function aa(e){throw e}function ba(e){if(!e)return e;var t=Z;return y(e.split("."),function(e){t=t[e]}),t}function A(e,t,i,n){return t=Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e),t.requireType=e,t.requireModules=n,i&&(t.originalError=i),t}function ha(e){function i(e,t,i){var n,s,o,r,a,c,h,u=t&&t.split("/");n=u;var p=T.map,d=p&&p["*"];if(e&&"."===e.charAt(0))if(t){for(n=l(T.pkgs,t)?u=[t]:u.slice(0,u.length-1),t=e=n.concat(e.split("/")),n=0;t[n];n+=1)if(s=t[n],"."===s)t.splice(n,1),n-=1;else if(".."===s){if(1===n&&(".."===t[2]||".."===t[0]))break;n>0&&(t.splice(n-1,2),n-=2)}n=l(T.pkgs,t=e[0]),e=e.join("/"),n&&e===t+"/"+n.main&&(e=t)}else 0===e.indexOf("./")&&(e=e.substring(2));if(i&&p&&(u||d)){for(t=e.split("/"),n=t.length;n>0;n-=1){if(o=t.slice(0,n).join("/"),u)for(s=u.length;s>0;s-=1)if((i=l(p,u.slice(0,s).join("/")))&&(i=l(i,o))){r=i,a=n;break}if(r)break;!c&&d&&l(d,o)&&(c=l(d,o),h=n)}!r&&c&&(r=c,a=h),r&&(t.splice(0,a,r),e=t.join("/"))}return e}function n(e){z&&y(document.getElementsByTagName("script"),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===w.contextName?(t.parentNode.removeChild(t),!0):void 0})}function s(e){var t=l(T.paths,e);return t&&I(t)&&1<t.length?(t.shift(),w.require.undef(e),w.require([e]),!0):void 0}function o(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function r(e,t,n,s){var r,a,c=null,h=t?t.name:null,u=e,p=!0,d="";return e||(p=!1,e="_@r"+(q+=1)),e=o(e),c=e[0],e=e[1],c&&(c=i(c,h,s),a=l(N,c)),e&&(c?d=a&&a.normalize?a.normalize(e,function(e){return i(e,h,s)}):i(e,h,s):(d=i(e,h,s),e=o(d),c=e[0],d=e[1],n=!0,r=w.nameToUrl(d))),n=!c||a||n?"":"_unnormalized"+(B+=1),{prefix:c,name:d,parentMap:t,unnormalized:!!n,url:r,originalName:u,isDefine:p,id:(c?c+"!"+d:d)+n}}function a(e){var t=e.id,i=l(C,t);return i||(i=C[t]=new w.Module(e)),i}function c(e,i,n){var s=e.id,o=l(C,s);!t(N,s)||o&&!o.defineEmitComplete?(o=a(e),o.error&&"error"===i?n(o.error):o.on(i,n)):"defined"===i&&n(N[s])}function h(e,t){var i=e.requireModules,n=!1;t?t(e):(y(i,function(t){(t=l(C,t))&&(t.error=e,t.events.error&&(n=!0,t.emit("error",e)))}),n||j.onError(e))}function p(){R.length&&(ia.apply(S,[S.length-1,0].concat(R)),R=[])}function d(e){delete C[e],delete E[e]}function f(e,t,i){var n=e.map.id;e.error?e.emit("error",e.error):(t[n]=!0,y(e.depMaps,function(n,s){var o=n.id,r=l(C,o);r&&!e.depMatched[s]&&!i[o]&&(l(t,o)?(e.defineDep(s,N[o]),e.check()):f(r,t,i))}),i[n]=!0)}function g(){var e,t,i,o,r=(i=1e3*T.waitSeconds)&&w.startTime+i<(new Date).getTime(),a=[],l=[],c=!1,u=!0;if(!b){if(b=!0,F(E,function(i){if(e=i.map,t=e.id,i.enabled&&(e.isDefine||l.push(i),!i.error))if(!i.inited&&r)s(t)?c=o=!0:(a.push(t),n(t));else if(!i.inited&&i.fetched&&e.isDefine&&(c=!0,!e.prefix))return u=!1}),r&&a.length)return i=A("timeout","Load timeout for modules: "+a,null,a),i.contextName=w.contextName,h(i);u&&y(l,function(e){f(e,{},{})}),r&&!o||!c||!z&&!da||M||(M=setTimeout(function(){M=0,g()},50)),b=!1}}function m(e){t(N,e[0])||a(r(e[0],null,!0)).init(e[1],e[2])}function v(e){var e=e.currentTarget||e.srcElement,t=w.onScriptLoad;return e.detachEvent&&!W?e.detachEvent("onreadystatechange",t):e.removeEventListener("load",t,!1),t=w.onScriptError,(!e.detachEvent||W)&&e.removeEventListener("error",t,!1),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function _(){var e;for(p();S.length;){if(e=S.shift(),null===e[0])return h(A("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));m(e)}}var b,x,w,k,M,T={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},C={},E={},D={},S=[],N={},L={},q=1,B=1;return k={require:function(e){return e.require?e.require:e.require=w.makeRequire(e.map)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports?e.exports:e.exports=N[e.map.id]={}:void 0},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){var t=l(T.pkgs,e.map.id);return(t?l(T.config,e.map.id+"/"+t.main):l(T.config,e.map.id))||{}},exports:N[e.map.id]}}},x=function(e){this.events=l(D,e.id)||{},this.map=e,this.shim=l(T.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},x.prototype={init:function(e,t,i,n){n=n||{},this.inited||(this.factory=t,i?this.on("error",i):this.events.error&&(i=u(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=i,this.inited=!0,this.ignore=n.ignore,n.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,w.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();w.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],u(this,function(){return e.prefix?this.callPlugin():this.load()}))}},load:function(){var e=this.map.url;L[e]||(L[e]=!0,w.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,i=this.map.id;t=this.depExports;var n=this.exports,s=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,1>this.depCount&&!this.defined){if(H(s)){if(this.events.error&&this.map.isDefine||j.onError!==aa)try{n=w.execCb(i,s,t,n)}catch(o){e=o}else n=w.execCb(i,s,t,n);if(this.map.isDefine&&((t=this.module)&&void 0!==t.exports&&t.exports!==this.exports?n=t.exports:void 0===n&&this.usingExports&&(n=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",h(this.error=e)}else n=s;this.exports=n,this.map.isDefine&&!this.ignore&&(N[i]=n,j.onResourceLoad)&&j.onResourceLoad(w,this.map,this.depMaps),d(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,n=e.id,s=r(e.prefix);this.depMaps.push(s),c(s,"defined",u(this,function(s){var o,p;p=this.map.name;var f=this.map.parentMap?this.map.parentMap.name:null,g=w.makeRequire(e.parentMap,{enableBuildCallback:!0});this.map.unnormalized?(s.normalize&&(p=s.normalize(p,function(e){return i(e,f,!0)})||""),s=r(e.prefix+"!"+p,this.map.parentMap),c(s,"defined",u(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),(p=l(C,s.id))&&(this.depMaps.push(s),this.events.error&&p.on("error",u(this,function(e){this.emit("error",e)})),p.enable())):(o=u(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),o.error=u(this,function(e){this.inited=!0,this.error=e,e.requireModules=[n],F(C,function(e){0===e.map.id.indexOf(n+"_unnormalized")&&d(e.map.id)}),h(e)}),o.fromText=u(this,function(i,s){var l=e.name,c=r(l),u=O;s&&(i=s),u&&(O=!1),a(c),t(T.config,n)&&(T.config[l]=T.config[n]);try{j.exec(i)}catch(p){return h(A("fromtexteval","fromText eval for "+n+" failed: "+p,p,[n]))}u&&(O=!0),this.depMaps.push(c),w.completeLoad(l),g([l],o)}),s.load(e.name,g,o,T))})),w.enable(s,this),this.pluginMaps[s.id]=s},enable:function(){E[this.map.id]=this,this.enabling=this.enabled=!0,y(this.depMaps,u(this,function(e,i){var n,s;if("string"==typeof e){if(e=r(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[i]=e,n=l(k,e.id))return this.depExports[i]=n(this),void 0;this.depCount+=1,c(e,"defined",u(this,function(e){this.defineDep(i,e),this.check()})),this.errback&&c(e,"error",u(this,this.errback))}n=e.id,s=C[n],!t(k,n)&&s&&!s.enabled&&w.enable(e,this)})),F(this.pluginMaps,u(this,function(e){var t=l(C,e.id);t&&!t.enabled&&w.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var i=this.events[e];i||(i=this.events[e]=[]),i.push(t)},emit:function(e,t){y(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},w={config:T,contextName:e,registry:C,defined:N,urlFetched:L,defQueue:S,Module:x,makeModuleMap:r,nextTick:j.nextTick,onError:h,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=T.pkgs,i=T.shim,n={paths:!0,config:!0,map:!0};F(e,function(e,t){n[t]?"map"===t?(T.map||(T.map={}),Q(T[t],e,!0,!0)):Q(T[t],e,!0):T[t]=e}),e.shim&&(F(e.shim,function(e,t){I(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=w.makeShimExports(e)),i[t]=e}),T.shim=i),e.packages&&(y(e.packages,function(e){e="string"==typeof e?{name:e}:e,t[e.name]={name:e.name,location:e.location||e.name,main:(e.main||"main").replace(ja,"").replace(ea,"")}}),T.pkgs=t),F(C,function(e,t){!e.inited&&!e.map.unnormalized&&(e.map=r(t))}),(e.deps||e.callback)&&w.require(e.deps||[],e.callback)},makeShimExports:function(e){return function(){var t;return e.init&&(t=e.init.apply(Z,arguments)),t||e.exports&&ba(e.exports)}},makeRequire:function(s,o){function c(i,n,l){var u,p;return o.enableBuildCallback&&n&&H(n)&&(n.__requireJsBuild=!0),"string"==typeof i?H(n)?h(A("requireargs","Invalid require call"),l):s&&t(k,i)?k[i](C[s.id]):j.get?j.get(w,i,s,c):(u=r(i,s,!1,!0),u=u.id,t(N,u)?N[u]:h(A("notloaded",'Module name "'+u+'" has not been loaded yet for context: '+e+(s?"":". Use require([])")))):(_(),w.nextTick(function(){_(),p=a(r(null,s)),p.skipMap=o.skipMap,p.init(i,n,l,{enabled:!0}),g()}),c)}return o=o||{},Q(c,{isBrowser:z,toUrl:function(e){var t,n=e.lastIndexOf("."),o=e.split("/")[0];return-1!==n&&("."!==o&&".."!==o||n>1)&&(t=e.substring(n,e.length),e=e.substring(0,n)),w.nameToUrl(i(e,s&&s.id,!0),t,!0)},defined:function(e){return t(N,r(e,s,!1,!0).id)},specified:function(e){return e=r(e,s,!1,!0).id,t(N,e)||t(C,e)}}),s||(c.undef=function(e){p();var t=r(e,s,!0),i=l(C,e);n(e),delete N[e],delete L[t.url],delete D[e],i&&(i.events.defined&&(D[e]=i.events),d(e))}),c},enable:function(e){l(C,e.id)&&a(e).enable()},completeLoad:function(e){var i,n,o=l(T.shim,e)||{},r=o.exports;for(p();S.length;){if(n=S.shift(),null===n[0]){if(n[0]=e,i)break;i=!0}else n[0]===e&&(i=!0);m(n)}if(n=l(C,e),!i&&!t(N,e)&&n&&!n.inited){if(T.enforceDefine&&(!r||!ba(r)))return s(e)?void 0:h(A("nodefine","No define call for "+e,null,[e]));m([e,o.deps||[],o.exportsFn])}g()},nameToUrl:function(e,t,i){var n,s,o,r,a,c;if(j.jsExtRegExp.test(e))r=e+(t||"");else{for(n=T.paths,s=T.pkgs,r=e.split("/"),a=r.length;a>0;a-=1){if(c=r.slice(0,a).join("/"),o=l(s,c),c=l(n,c)){I(c)&&(c=c[0]),r.splice(0,a,c);break}if(o){e=e===o.name?o.location+"/"+o.main:o.location,r.splice(0,a,e);break}}r=r.join("/"),r+=t||(/^data\:|\?/.test(r)||i?"":".js"),r=("/"===r.charAt(0)||r.match(/^[\w\+\.\-]+:/)?"":T.baseUrl)+r}return T.urlArgs?r+((-1===r.indexOf("?")?"?":"&")+T.urlArgs):r},load:function(e,t){j.load(w,e,t)},execCb:function(e,t,i,n){return t.apply(n,i)},onScriptLoad:function(e){("load"===e.type||ka.test((e.currentTarget||e.srcElement).readyState))&&(P=null,e=v(e),w.completeLoad(e.id))},onScriptError:function(e){var t=v(e);return s(t.id)?void 0:h(A("scripterror","Script error for: "+t.id,e,[t.id]))}},w.require=w.makeRequire(),w}var j,w,x,C,J,D,P,K,q,fa,la=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,ma=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,ea=/\.js$/,ja=/^\.\//;w=Object.prototype;var L=w.toString,ga=w.hasOwnProperty,ia=Array.prototype.splice,z=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),da=!z&&"undefined"!=typeof importScripts,ka=z&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,W="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),E={},s={},R=[],O=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(H(requirejs))return;s=requirejs,requirejs=void 0}"undefined"!=typeof require&&!H(require)&&(s=require,require=void 0),j=requirejs=function(e,t,i,n){var s,o="_";return!I(e)&&"string"!=typeof e&&(s=e,I(t)?(e=t,t=i,i=n):e=[]),s&&s.context&&(o=s.context),(n=l(E,o))||(n=E[o]=j.s.newContext(o)),s&&n.configure(s),n.require(e,t,i)},j.config=function(e){return j(e)},j.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=j),j.version="2.1.9",j.jsExtRegExp=/^\/|:|\?|\.js$/,j.isBrowser=z,w=j.s={contexts:E,newContext:ha},j({}),y(["toUrl","undef","defined","specified"],function(e){j[e]=function(){var t=E._;return t.require[e].apply(t,arguments)}}),z&&(x=w.head=document.getElementsByTagName("head")[0],C=document.getElementsByTagName("base")[0])&&(x=w.head=C.parentNode),j.onError=aa,j.createNode=function(e){var t=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return t.type=e.scriptType||"text/javascript",t.charset="utf-8",t.async=!0,t},j.load=function(e,t,i){var n=e&&e.config||{};if(z)return n=j.createNode(n,t,i),n.setAttribute("data-requirecontext",e.contextName),n.setAttribute("data-requiremodule",t),!n.attachEvent||n.attachEvent.toString&&0>n.attachEvent.toString().indexOf("[native code")||W?(n.addEventListener("load",e.onScriptLoad,!1),n.addEventListener("error",e.onScriptError,!1)):(O=!0,n.attachEvent("onreadystatechange",e.onScriptLoad)),n.src=i,K=n,C?x.insertBefore(n,C):x.appendChild(n),K=null,n;if(da)try{importScripts(i),e.completeLoad(t)}catch(s){e.onError(A("importscripts","importScripts failed for "+t+" at "+i,s,[t]))}},z&&!s.skipDataMain&&M(document.getElementsByTagName("script"),function(e){return x||(x=e.parentNode),(J=e.getAttribute("data-main"))?(q=J,s.baseUrl||(D=q.split("/"),q=D.pop(),fa=D.length?D.join("/")+"/":"./",s.baseUrl=fa),q=q.replace(ea,""),j.jsExtRegExp.test(q)&&(q=J),s.deps=s.deps?s.deps.concat(q):[q],!0):void 0}),define=function(e,t,i){var n,s;"string"!=typeof e&&(i=t,t=e,e=null),I(t)||(i=t,t=null),!t&&H(i)&&(t=[],i.length&&(i.toString().replace(la,"").replace(ma,function(e,i){t.push(i)}),t=(1===i.length?["require"]:["require","exports","module"]).concat(t))),O&&((n=K)||(P&&"interactive"===P.readyState||M(document.getElementsByTagName("script"),function(e){return"interactive"===e.readyState?P=e:void 0}),n=P),n&&(e||(e=n.getAttribute("data-requiremodule")),s=E[n.getAttribute("data-requirecontext")])),(s?s.defQueue:R).push([e,t,i])},define.amd={jQuery:!0},j.exec=function(b){return eval(b)},j(s)}}(this),mmf_mapping_api.requirejs=requirejs,mmf_mapping_api.require=require,mmf_mapping_api.define=define}}(),mmf_mapping_api.define("require_lib",function(){}),function(e,t){function i(e){var t=ft[e]={};return Q.each(e.split(tt),function(e,i){t[i]=!0}),t}function n(e,i,n){if(n===t&&1===e.nodeType){var s="data-"+i.replace(mt,"-$1").toLowerCase();if(n=e.getAttribute(s),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:gt.test(n)?Q.parseJSON(n):n}catch(o){}Q.data(e,i,n)}else n=t}return n}function s(e){var t;for(t in e)if(("data"!==t||!Q.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function o(){return!1}function r(){return!0}function a(e){return!e||!e.parentNode||11===e.parentNode.nodeType}function l(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function c(e,t,i){if(t=t||0,Q.isFunction(t))return Q.grep(e,function(e,n){var s=!!t.call(e,n,e);return s===i});if(t.nodeType)return Q.grep(e,function(e){return e===t===i});if("string"==typeof t){var n=Q.grep(e,function(e){return 1===e.nodeType});if(Ot.test(t))return Q.filter(t,n,!i);t=Q.filter(t,n)}return Q.grep(e,function(e){return Q.inArray(e,t)>=0===i})}function h(e){var t=Ht.split("|"),i=e.createDocumentFragment();if(i.createElement)for(;t.length;)i.createElement(t.pop());return i}function u(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function p(e,t){if(1===t.nodeType&&Q.hasData(e)){var i,n,s,o=Q._data(e),r=Q._data(t,o),a=o.events;if(a){delete r.handle,r.events={};for(i in a)for(n=0,s=a[i].length;s>n;n++)Q.event.add(t,i,a[i][n])}r.data&&(r.data=Q.extend({},r.data))}}function d(e,t){var i;1===t.nodeType&&(t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),i=t.nodeName.toLowerCase(),"object"===i?(t.parentNode&&(t.outerHTML=e.outerHTML),Q.support.html5Clone&&e.innerHTML&&!Q.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===i&&Yt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===i?t.selected=e.defaultSelected:"input"===i||"textarea"===i?t.defaultValue=e.defaultValue:"script"===i&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(Q.expando))}function f(e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName("*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll("*"):[]}function g(e){Yt.test(e.type)&&(e.defaultChecked=e.checked)}function m(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),n=t,s=vi.length;s--;)if(t=vi[s]+i,t in e)return t;return n}function v(e,t){return e=t||e,"none"===Q.css(e,"display")||!Q.contains(e.ownerDocument,e)}function _(e,t){for(var i,n,s=[],o=0,r=e.length;r>o;o++)i=e[o],i.style&&(s[o]=Q._data(i,"olddisplay"),t?(s[o]||"none"!==i.style.display||(i.style.display=""),""===i.style.display&&v(i)&&(s[o]=Q._data(i,"olddisplay",w(i.nodeName)))):(n=ii(i,"display"),s[o]||"none"===n||Q._data(i,"olddisplay",n)));for(o=0;r>o;o++)i=e[o],i.style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?s[o]||"":"none"));return e}function y(e,t,i){var n=hi.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function b(e,t,i,n){for(var s=i===(n?"border":"content")?4:"width"===t?1:0,o=0;4>s;s+=2)"margin"===i&&(o+=Q.css(e,i+mi[s],!0)),n?("content"===i&&(o-=parseFloat(ii(e,"padding"+mi[s]))||0),"margin"!==i&&(o-=parseFloat(ii(e,"border"+mi[s]+"Width"))||0)):(o+=parseFloat(ii(e,"padding"+mi[s]))||0,"padding"!==i&&(o+=parseFloat(ii(e,"border"+mi[s]+"Width"))||0));return o}function x(e,t,i){var n="width"===t?e.offsetWidth:e.offsetHeight,s=!0,o=Q.support.boxSizing&&"border-box"===Q.css(e,"boxSizing");if(0>=n||null==n){if(n=ii(e,t),(0>n||null==n)&&(n=e.style[t]),ui.test(n))return n;s=o&&(Q.support.boxSizingReliable||n===e.style[t]),n=parseFloat(n)||0}return n+b(e,t,i||(o?"border":"content"),s)+"px"}function w(e){if(di[e])return di[e];var t=Q("<"+e+">").appendTo(W.body),i=t.css("display");return t.remove(),("none"===i||""===i)&&(ni=W.body.appendChild(ni||Q.extend(W.createElement("iframe"),{frameBorder:0,width:0,height:0})),si&&ni.createElement||(si=(ni.contentWindow||ni.contentDocument).document,si.write("<!doctype html><html><body>"),si.close()),t=si.body.appendChild(si.createElement(e)),i=ii(t,"display"),W.body.removeChild(ni)),di[e]=i,i}function k(e,t,i,n){var s;if(Q.isArray(t))Q.each(t,function(t,s){i||bi.test(e)?n(e,s):k(e+"["+("object"==typeof s?t:"")+"]",s,i,n)});else if(i||"object"!==Q.type(t))n(e,t);else for(s in t)k(e+"["+s+"]",t[s],i,n)}function M(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,s,o,r=t.toLowerCase().split(tt),a=0,l=r.length;if(Q.isFunction(i))for(;l>a;a++)n=r[a],o=/^\+/.test(n),o&&(n=n.substr(1)||"*"),s=e[n]=e[n]||[],s[o?"unshift":"push"](i)}}function T(e,i,n,s,o,r){o=o||i.dataTypes[0],r=r||{},r[o]=!0;for(var a,l=e[o],c=0,h=l?l.length:0,u=e===Oi;h>c&&(u||!a);c++)a=l[c](i,n,s),"string"==typeof a&&(!u||r[a]?a=t:(i.dataTypes.unshift(a),a=T(e,i,n,s,a,r)));return!u&&a||r["*"]||(a=T(e,i,n,s,"*",r)),a}function C(e,i){var n,s,o=Q.ajaxSettings.flatOptions||{};for(n in i)i[n]!==t&&((o[n]?e:s||(s={}))[n]=i[n]);s&&Q.extend(!0,e,s)}function E(e,i,n){var s,o,r,a,l=e.contents,c=e.dataTypes,h=e.responseFields;for(o in h)o in n&&(i[h[o]]=n[o]);for(;"*"===c[0];)c.shift(),s===t&&(s=e.mimeType||i.getResponseHeader("content-type"));if(s)for(o in l)if(l[o]&&l[o].test(s)){c.unshift(o);break}if(c[0]in n)r=c[0];else{for(o in n){if(!c[0]||e.converters[o+" "+c[0]]){r=o;break}a||(a=o)}r=r||a}return r?(r!==c[0]&&c.unshift(r),n[r]):void 0}function P(e,t){var i,n,s,o,r=e.dataTypes.slice(),a=r[0],l={},c=0;if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),r[1])for(i in e.converters)l[i.toLowerCase()]=e.converters[i];for(;s=r[++c];)if("*"!==s){if("*"!==a&&a!==s){if(i=l[a+" "+s]||l["* "+s],!i)for(n in l)if(o=n.split(" "),o[1]===s&&(i=l[a+" "+o[0]]||l["* "+o[0]])){i===!0?i=l[n]:l[n]!==!0&&(s=o[0],r.splice(c--,0,s));break}if(i!==!0)if(i&&e["throws"])t=i(t);else try{t=i(t)}catch(h){return{state:"parsererror",error:i?h:"No conversion from "+a+" to "+s}}}a=s}return{state:"success",data:t}}function z(){try{return new e.XMLHttpRequest}catch(t){}}function D(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function S(){return setTimeout(function(){$i=t},0),$i=Q.now()}function I(e,t){Q.each(t,function(t,i){for(var n=(Ji[t]||[]).concat(Ji["*"]),s=0,o=n.length;o>s;s++)if(n[s].call(e,t,i))return})}function N(e,t,i){var n,s=0,o=Qi.length,r=Q.Deferred().always(function(){delete a.elem}),a=function(){for(var t=$i||S(),i=Math.max(0,l.startTime+l.duration-t),n=1-(i/l.duration||0),s=0,o=l.tweens.length;o>s;s++)l.tweens[s].run(n);return r.notifyWith(e,[l,n,i]),1>n&&o?i:(r.resolveWith(e,[l]),!1)},l=r.promise({elem:e,props:Q.extend({},t),opts:Q.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:$i||S(),duration:i.duration,tweens:[],createTween:function(t,i){var n=Q.Tween(e,l.opts,t,i,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(n),n},stop:function(t){for(var i=0,n=t?l.tweens.length:0;n>i;i++)l.tweens[i].run(1);return t?r.resolveWith(e,[l,t]):r.rejectWith(e,[l,t]),this}}),c=l.props;for(A(c,l.opts.specialEasing);o>s;s++)if(n=Qi[s].call(l,e,c,l.opts))return n;return I(l,c),Q.isFunction(l.opts.start)&&l.opts.start.call(e,l),Q.fx.timer(Q.extend(a,{anim:l,queue:l.opts.queue,elem:e})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function A(e,t){var i,n,s,o,r;for(i in e)if(n=Q.camelCase(i),s=t[n],o=e[i],Q.isArray(o)&&(s=o[1],o=e[i]=o[0]),i!==n&&(e[n]=o,delete e[i]),r=Q.cssHooks[n],r&&"expand"in r){o=r.expand(o),delete e[n];for(i in o)i in e||(e[i]=o[i],t[i]=s)}else t[n]=s}function L(e,t,i){var n,s,o,r,a,l,c,h,u=this,p=e.style,d={},f=[],g=e.nodeType&&v(e);i.queue||(c=Q._queueHooks(e,"fx"),null==c.unqueued&&(c.unqueued=0,h=c.empty.fire,c.empty.fire=function(){c.unqueued||h()}),c.unqueued++,u.always(function(){u.always(function(){c.unqueued--,Q.queue(e,"fx").length||c.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===Q.css(e,"display")&&"none"===Q.css(e,"float")&&(Q.support.inlineBlockNeedsLayout&&"inline"!==w(e.nodeName)?p.zoom=1:p.display="inline-block")),i.overflow&&(p.overflow="hidden",Q.support.shrinkWrapBlocks||u.done(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(n in t)if(o=t[n],Yi.exec(o)){if(delete t[n],o===(g?"hide":"show"))continue;f.push(n)}if(r=f.length)for(a=Q._data(e,"fxshow")||Q._data(e,"fxshow",{}),g?Q(e).show():u.done(function(){Q(e).hide()}),u.done(function(){var t;Q.removeData(e,"fxshow",!0);for(t in d)Q.style(e,t,d[t])}),n=0;r>n;n++)s=f[n],l=u.createTween(s,g?a[s]:0),d[s]=a[s]||Q.style(e,s),s in a||(a[s]=l.start,g&&(l.end=l.start,l.start="width"===s||"height"===s?1:0))}function O(e,t,i,n,s){return new O.prototype.init(e,t,i,n,s)}function R(e,t){var i,n={height:e},s=0;for(t=t?1:0;4>s;s+=2-t)i=mi[s],n["margin"+i]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function j(e){return Q.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var H,q,W=e.document,B=e.location,F=e.navigator,U=e.jQuery,G=e.$,V=Array.prototype.push,$=Array.prototype.slice,X=Array.prototype.indexOf,Y=Object.prototype.toString,K=Object.prototype.hasOwnProperty,Z=String.prototype.trim,Q=function(e,t){return new Q.fn.init(e,t,H)},J=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,et=/\S/,tt=/\s+/,it=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,nt=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,st=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ot=/^[\],:{}\s]*$/,rt=/(?:^|:|,)(?:\s*\[)+/g,at=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,lt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,ct=/^-ms-/,ht=/-([\da-z])/gi,ut=function(e,t){return(t+"").toUpperCase()},pt=function(){W.addEventListener?(W.removeEventListener("DOMContentLoaded",pt,!1),Q.ready()):"complete"===W.readyState&&(W.detachEvent("onreadystatechange",pt),Q.ready())},dt={};Q.fn=Q.prototype={constructor:Q,init:function(e,i,n){var s,o,r;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if("string"==typeof e){if(s="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:nt.exec(e),!s||!s[1]&&i)return!i||i.jquery?(i||n).find(e):this.constructor(i).find(e);if(s[1])return i=i instanceof Q?i[0]:i,r=i&&i.nodeType?i.ownerDocument||i:W,e=Q.parseHTML(s[1],r,!0),st.test(s[1])&&Q.isPlainObject(i)&&this.attr.call(e,i,!0),Q.merge(this,e);if(o=W.getElementById(s[2]),o&&o.parentNode){if(o.id!==s[2])return n.find(e);this.length=1,this[0]=o}return this.context=W,this.selector=e,this}return Q.isFunction(e)?n.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),Q.makeArray(e,this))},selector:"",jquery:"1.8.2",length:0,size:function(){return this.length},toArray:function(){return $.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e,t,i){var n=Q.merge(this.constructor(),e);return n.prevObject=this,n.context=this.context,"find"===t?n.selector=this.selector+(this.selector?" ":"")+i:t&&(n.selector=this.selector+"."+t+"("+i+")"),n},each:function(e,t){return Q.each(this,e,t)},ready:function(e){return Q.ready.promise().done(e),this},eq:function(e){return e=+e,-1===e?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack($.apply(this,arguments),"slice",$.call(arguments).join(","))},map:function(e){return this.pushStack(Q.map(this,function(t,i){return e.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:V,sort:[].sort,splice:[].splice},Q.fn.init.prototype=Q.fn,Q.extend=Q.fn.extend=function(){var e,i,n,s,o,r,a=arguments[0]||{},l=1,c=arguments.length,h=!1;for("boolean"==typeof a&&(h=a,a=arguments[1]||{},l=2),"object"==typeof a||Q.isFunction(a)||(a={}),c===l&&(a=this,--l);c>l;l++)if(null!=(e=arguments[l]))for(i in e)n=a[i],s=e[i],a!==s&&(h&&s&&(Q.isPlainObject(s)||(o=Q.isArray(s)))?(o?(o=!1,r=n&&Q.isArray(n)?n:[]):r=n&&Q.isPlainObject(n)?n:{},a[i]=Q.extend(h,r,s)):s!==t&&(a[i]=s));return a},Q.extend({noConflict:function(t){return e.$===Q&&(e.$=G),t&&e.jQuery===Q&&(e.jQuery=U),Q},isReady:!1,readyWait:1,holdReady:function(e){e?Q.readyWait++:Q.ready(!0)},ready:function(e){if(e===!0?!--Q.readyWait:!Q.isReady){if(!W.body)return setTimeout(Q.ready,1);Q.isReady=!0,e!==!0&&--Q.readyWait>0||(q.resolveWith(W,[Q]),Q.fn.trigger&&Q(W).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===Q.type(e)},isArray:Array.isArray||function(e){return"array"===Q.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):dt[Y.call(e)]||"object"},isPlainObject:function(e){if(!e||"object"!==Q.type(e)||e.nodeType||Q.isWindow(e))return!1;try{if(e.constructor&&!K.call(e,"constructor")&&!K.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}var n;for(n in e);return n===t||K.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,i){var n;return e&&"string"==typeof e?("boolean"==typeof t&&(i=t,t=0),t=t||W,(n=st.exec(e))?[t.createElement(n[1])]:(n=Q.buildFragment([e],t,i?null:[]),Q.merge([],(n.cacheable?Q.clone(n.fragment):n.fragment).childNodes))):null},parseJSON:function(t){return t&&"string"==typeof t?(t=Q.trim(t),e.JSON&&e.JSON.parse?e.JSON.parse(t):ot.test(t.replace(at,"@").replace(lt,"]").replace(rt,""))?new Function("return "+t)():(Q.error("Invalid JSON: "+t),void 0)):null},parseXML:function(i){var n,s;if(!i||"string"!=typeof i)return null;try{e.DOMParser?(s=new DOMParser,n=s.parseFromString(i,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(i))}catch(o){n=t}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||Q.error("Invalid XML: "+i),n},noop:function(){},globalEval:function(t){t&&et.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(ct,"ms-").replace(ht,ut)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,i,n){var s,o=0,r=e.length,a=r===t||Q.isFunction(e);if(n)if(a){for(s in e)if(i.apply(e[s],n)===!1)break}else for(;r>o&&i.apply(e[o++],n)!==!1;);else if(a){for(s in e)if(i.call(e[s],s,e[s])===!1)break}else for(;r>o&&i.call(e[o],o,e[o++])!==!1;);return e},trim:Z&&!Z.call("")?function(e){return null==e?"":Z.call(e)}:function(e){return null==e?"":(e+"").replace(it,"")},makeArray:function(e,t){var i,n=t||[];return null!=e&&(i=Q.type(e),null==e.length||"string"===i||"function"===i||"regexp"===i||Q.isWindow(e)?V.call(n,e):Q.merge(n,e)),n},inArray:function(e,t,i){var n;if(t){if(X)return X.call(t,e,i);for(n=t.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,i){var n=i.length,s=e.length,o=0;if("number"==typeof n)for(;n>o;o++)e[s++]=i[o];else for(;i[o]!==t;)e[s++]=i[o++];return e.length=s,e},grep:function(e,t,i){var n,s=[],o=0,r=e.length;for(i=!!i;r>o;o++)n=!!t(e[o],o),i!==n&&s.push(e[o]);return s},map:function(e,i,n){var s,o,r=[],a=0,l=e.length,c=e instanceof Q||l!==t&&"number"==typeof l&&(l>0&&e[0]&&e[l-1]||0===l||Q.isArray(e));if(c)for(;l>a;a++)s=i(e[a],a,n),null!=s&&(r[r.length]=s);else for(o in e)s=i(e[o],o,n),null!=s&&(r[r.length]=s);return r.concat.apply([],r)},guid:1,proxy:function(e,i){var n,s,o;return"string"==typeof i&&(n=e[i],i=e,e=n),Q.isFunction(e)?(s=$.call(arguments,2),o=function(){return e.apply(i,s.concat($.call(arguments)))},o.guid=e.guid=e.guid||Q.guid++,o):t},access:function(e,i,n,s,o,r,a){var l,c=null==n,h=0,u=e.length;if(n&&"object"==typeof n){for(h in n)Q.access(e,i,h,n[h],1,r,s);o=1}else if(s!==t){if(l=a===t&&Q.isFunction(s),c&&(l?(l=i,i=function(e,t,i){return l.call(Q(e),i)}):(i.call(e,s),i=null)),i)for(;u>h;h++)i(e[h],n,l?s.call(e[h],h,i(e[h],n)):s,a);o=1}return o?e:c?i.call(e):u?i(e[0],n):r},now:function(){return(new Date).getTime()}}),Q.ready.promise=function(t){if(!q)if(q=Q.Deferred(),"complete"===W.readyState)setTimeout(Q.ready,1);else if(W.addEventListener)W.addEventListener("DOMContentLoaded",pt,!1),e.addEventListener("load",Q.ready,!1);else{W.attachEvent("onreadystatechange",pt),e.attachEvent("onload",Q.ready);var i=!1;try{i=null==e.frameElement&&W.documentElement}catch(n){}i&&i.doScroll&&!function s(){if(!Q.isReady){try{i.doScroll("left")}catch(e){return setTimeout(s,50)}Q.ready()}}()}return q.promise(t)},Q.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){dt["[object "+t+"]"]=t.toLowerCase()}),H=Q(W);var ft={};Q.Callbacks=function(e){e="string"==typeof e?ft[e]||i(e):Q.extend({},e);var n,s,o,r,a,l,c=[],h=!e.once&&[],u=function(t){for(n=e.memory&&t,s=!0,l=r||0,r=0,a=c.length,o=!0;c&&a>l;l++)if(c[l].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}o=!1,c&&(h?h.length&&u(h.shift()):n?c=[]:p.disable())},p={add:function(){if(c){var t=c.length;!function i(t){Q.each(t,function(t,n){var s=Q.type(n);
"function"!==s||e.unique&&p.has(n)?n&&n.length&&"string"!==s&&i(n):c.push(n)})}(arguments),o?a=c.length:n&&(r=t,u(n))}return this},remove:function(){return c&&Q.each(arguments,function(e,t){for(var i;(i=Q.inArray(t,c,i))>-1;)c.splice(i,1),o&&(a>=i&&a--,l>=i&&l--)}),this},has:function(e){return Q.inArray(e,c)>-1},empty:function(){return c=[],this},disable:function(){return c=h=n=t,this},disabled:function(){return!c},lock:function(){return h=t,n||p.disable(),this},locked:function(){return!h},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!c||s&&!h||(o?h.push(t):u(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!s}};return p},Q.extend({Deferred:function(e){var t=[["resolve","done",Q.Callbacks("once memory"),"resolved"],["reject","fail",Q.Callbacks("once memory"),"rejected"],["notify","progress",Q.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var e=arguments;return Q.Deferred(function(i){Q.each(t,function(t,n){var o=n[0],r=e[t];s[n[1]](Q.isFunction(r)?function(){var e=r.apply(this,arguments);e&&Q.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o+"With"](this===s?i:this,[e])}:i[o])}),e=null}).promise()},promise:function(e){return null!=e?Q.extend(e,n):n}},s={};return n.pipe=n.then,Q.each(t,function(e,o){var r=o[2],a=o[3];n[o[1]]=r.add,a&&r.add(function(){i=a},t[1^e][2].disable,t[2][2].lock),s[o[0]]=r.fire,s[o[0]+"With"]=r.fireWith}),n.promise(s),e&&e.call(s,s),s},when:function(e){var t,i,n,s=0,o=$.call(arguments),r=o.length,a=1!==r||e&&Q.isFunction(e.promise)?r:0,l=1===a?e:Q.Deferred(),c=function(e,i,n){return function(s){i[e]=this,n[e]=arguments.length>1?$.call(arguments):s,n===t?l.notifyWith(i,n):--a||l.resolveWith(i,n)}};if(r>1)for(t=new Array(r),i=new Array(r),n=new Array(r);r>s;s++)o[s]&&Q.isFunction(o[s].promise)?o[s].promise().done(c(s,n,o)).fail(l.reject).progress(c(s,i,t)):--a;return a||l.resolveWith(n,o),l.promise()}}),Q.support=function(){var t,i,n,s,o,r,a,l,c,h,u,p=W.createElement("div");if(p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=p.getElementsByTagName("*"),n=p.getElementsByTagName("a")[0],n.style.cssText="top:1px;float:left;opacity:.5",!i||!i.length)return{};s=W.createElement("select"),o=s.appendChild(W.createElement("option")),r=p.getElementsByTagName("input")[0],t={leadingWhitespace:3===p.firstChild.nodeType,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(n.getAttribute("style")),hrefNormalized:"/a"===n.getAttribute("href"),opacity:/^0.5/.test(n.style.opacity),cssFloat:!!n.style.cssFloat,checkOn:"on"===r.value,optSelected:o.selected,getSetAttribute:"t"!==p.className,enctype:!!W.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==W.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===W.compatMode,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},r.checked=!0,t.noCloneChecked=r.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!o.disabled;try{delete p.test}catch(d){t.deleteExpando=!1}if(!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",u=function(){t.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick"),p.detachEvent("onclick",u)),r=W.createElement("input"),r.value="t",r.setAttribute("type","radio"),t.radioValue="t"===r.value,r.setAttribute("checked","checked"),r.setAttribute("name","t"),p.appendChild(r),a=W.createDocumentFragment(),a.appendChild(p.lastChild),t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=r.checked,a.removeChild(r),a.appendChild(p),p.attachEvent)for(c in{submit:!0,change:!0,focusin:!0})l="on"+c,h=l in p,h||(p.setAttribute(l,"return;"),h="function"==typeof p[l]),t[c+"Bubbles"]=h;return Q(function(){var i,n,s,o,r="padding:0;margin:0;border:0;display:block;overflow:hidden;",a=W.getElementsByTagName("body")[0];a&&(i=W.createElement("div"),i.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",a.insertBefore(i,a.firstChild),n=W.createElement("div"),i.appendChild(n),n.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=n.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",h=0===s[0].offsetHeight,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=h&&0===s[0].offsetHeight,n.innerHTML="",n.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===n.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==a.offsetTop,e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(n,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(n,null)||{width:"4px"}).width,o=W.createElement("div"),o.style.cssText=n.style.cssText=r,o.style.marginRight=o.style.width="0",n.style.width="1px",n.appendChild(o),t.reliableMarginRight=!parseFloat((e.getComputedStyle(o,null)||{}).marginRight)),"undefined"!=typeof n.style.zoom&&(n.innerHTML="",n.style.cssText=r+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===n.offsetWidth,n.style.display="block",n.style.overflow="visible",n.innerHTML="<div></div>",n.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==n.offsetWidth,i.style.zoom=1),a.removeChild(i),i=n=s=o=null)}),a.removeChild(p),i=n=s=o=r=a=p=null,t}();var gt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,mt=/([A-Z])/g;Q.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(Q.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?Q.cache[e[Q.expando]]:e[Q.expando],!!e&&!s(e)},data:function(e,i,n,s){if(Q.acceptData(e)){var o,r,a=Q.expando,l="string"==typeof i,c=e.nodeType,h=c?Q.cache:e,u=c?e[a]:e[a]&&a;if(u&&h[u]&&(s||h[u].data)||!l||n!==t)return u||(c?e[a]=u=Q.deletedIds.pop()||Q.guid++:u=a),h[u]||(h[u]={},c||(h[u].toJSON=Q.noop)),("object"==typeof i||"function"==typeof i)&&(s?h[u]=Q.extend(h[u],i):h[u].data=Q.extend(h[u].data,i)),o=h[u],s||(o.data||(o.data={}),o=o.data),n!==t&&(o[Q.camelCase(i)]=n),l?(r=o[i],null==r&&(r=o[Q.camelCase(i)])):r=o,r}},removeData:function(e,t,i){if(Q.acceptData(e)){var n,o,r,a=e.nodeType,l=a?Q.cache:e,c=a?e[Q.expando]:Q.expando;if(l[c]){if(t&&(n=i?l[c]:l[c].data)){Q.isArray(t)||(t in n?t=[t]:(t=Q.camelCase(t),t=t in n?[t]:t.split(" ")));for(o=0,r=t.length;r>o;o++)delete n[t[o]];if(!(i?s:Q.isEmptyObject)(n))return}(i||(delete l[c].data,s(l[c])))&&(a?Q.cleanData([e],!0):Q.support.deleteExpando||l!=l.window?delete l[c]:l[c]=null)}}},_data:function(e,t,i){return Q.data(e,t,i,!0)},acceptData:function(e){var t=e.nodeName&&Q.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),Q.fn.extend({data:function(e,i){var s,o,r,a,l,c=this[0],h=0,u=null;if(e===t){if(this.length&&(u=Q.data(c),1===c.nodeType&&!Q._data(c,"parsedAttrs"))){for(r=c.attributes,l=r.length;l>h;h++)a=r[h].name,a.indexOf("data-")||(a=Q.camelCase(a.substring(5)),n(c,a,u[a]));Q._data(c,"parsedAttrs",!0)}return u}return"object"==typeof e?this.each(function(){Q.data(this,e)}):(s=e.split(".",2),s[1]=s[1]?"."+s[1]:"",o=s[1]+"!",Q.access(this,function(i){return i===t?(u=this.triggerHandler("getData"+o,[s[0]]),u===t&&c&&(u=Q.data(c,e),u=n(c,e,u)),u===t&&s[1]?this.data(s[0]):u):(s[1]=i,this.each(function(){var t=Q(this);t.triggerHandler("setData"+o,s),Q.data(this,e,i),t.triggerHandler("changeData"+o,s)}),void 0)},null,i,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){Q.removeData(this,e)})}}),Q.extend({queue:function(e,t,i){var n;return e?(t=(t||"fx")+"queue",n=Q._data(e,t),i&&(!n||Q.isArray(i)?n=Q._data(e,t,Q.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(e,t){t=t||"fx";var i=Q.queue(e,t),n=i.length,s=i.shift(),o=Q._queueHooks(e,t),r=function(){Q.dequeue(e,t)};"inprogress"===s&&(s=i.shift(),n--),s&&("fx"===t&&i.unshift("inprogress"),delete o.stop,s.call(e,r,o)),!n&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return Q._data(e,i)||Q._data(e,i,{empty:Q.Callbacks("once memory").add(function(){Q.removeData(e,t+"queue",!0),Q.removeData(e,i,!0)})})}}),Q.fn.extend({queue:function(e,i){var n=2;return"string"!=typeof e&&(i=e,e="fx",n--),arguments.length<n?Q.queue(this[0],e):i===t?this:this.each(function(){var t=Q.queue(this,e,i);Q._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&Q.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Q.dequeue(this,e)})},delay:function(e,t){return e=Q.fx?Q.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,i){var n,s=1,o=Q.Deferred(),r=this,a=this.length,l=function(){--s||o.resolveWith(r,[r])};for("string"!=typeof e&&(i=e,e=t),e=e||"fx";a--;)n=Q._data(r[a],e+"queueHooks"),n&&n.empty&&(s++,n.empty.add(l));return l(),o.promise(i)}});var vt,_t,yt,bt=/[\t\r\n]/g,xt=/\r/g,wt=/^(?:button|input)$/i,kt=/^(?:button|input|object|select|textarea)$/i,Mt=/^a(?:rea|)$/i,Tt=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Ct=Q.support.getSetAttribute;Q.fn.extend({attr:function(e,t){return Q.access(this,Q.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Q.removeAttr(this,e)})},prop:function(e,t){return Q.access(this,Q.prop,e,t,arguments.length>1)},removeProp:function(e){return e=Q.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(i){}})},addClass:function(e){var t,i,n,s,o,r,a;if(Q.isFunction(e))return this.each(function(t){Q(this).addClass(e.call(this,t,this.className))});if(e&&"string"==typeof e)for(t=e.split(tt),i=0,n=this.length;n>i;i++)if(s=this[i],1===s.nodeType)if(s.className||1!==t.length){for(o=" "+s.className+" ",r=0,a=t.length;a>r;r++)o.indexOf(" "+t[r]+" ")<0&&(o+=t[r]+" ");s.className=Q.trim(o)}else s.className=e;return this},removeClass:function(e){var i,n,s,o,r,a,l;if(Q.isFunction(e))return this.each(function(t){Q(this).removeClass(e.call(this,t,this.className))});if(e&&"string"==typeof e||e===t)for(i=(e||"").split(tt),a=0,l=this.length;l>a;a++)if(s=this[a],1===s.nodeType&&s.className){for(n=(" "+s.className+" ").replace(bt," "),o=0,r=i.length;r>o;o++)for(;n.indexOf(" "+i[o]+" ")>=0;)n=n.replace(" "+i[o]+" "," ");s.className=e?Q.trim(n):""}return this},toggleClass:function(e,t){var i=typeof e,n="boolean"==typeof t;return Q.isFunction(e)?this.each(function(i){Q(this).toggleClass(e.call(this,i,this.className,t),t)}):this.each(function(){if("string"===i)for(var s,o=0,r=Q(this),a=t,l=e.split(tt);s=l[o++];)a=n?a:!r.hasClass(s),r[a?"addClass":"removeClass"](s);else("undefined"===i||"boolean"===i)&&(this.className&&Q._data(this,"__className__",this.className),this.className=this.className||e===!1?"":Q._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(bt," ").indexOf(t)>=0)return!0;return!1},val:function(e){var i,n,s,o=this[0];{if(arguments.length)return s=Q.isFunction(e),this.each(function(n){var o,r=Q(this);1===this.nodeType&&(o=s?e.call(this,n,r.val()):e,null==o?o="":"number"==typeof o?o+="":Q.isArray(o)&&(o=Q.map(o,function(e){return null==e?"":e+""})),i=Q.valHooks[this.type]||Q.valHooks[this.nodeName.toLowerCase()],i&&"set"in i&&i.set(this,o,"value")!==t||(this.value=o))});if(o)return i=Q.valHooks[o.type]||Q.valHooks[o.nodeName.toLowerCase()],i&&"get"in i&&(n=i.get(o,"value"))!==t?n:(n=o.value,"string"==typeof n?n.replace(xt,""):null==n?"":n)}}}),Q.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,i,n,s,o=e.selectedIndex,r=[],a=e.options,l="select-one"===e.type;if(0>o)return null;for(i=l?o:0,n=l?o+1:a.length;n>i;i++)if(s=a[i],!(!s.selected||(Q.support.optDisabled?s.disabled:null!==s.getAttribute("disabled"))||s.parentNode.disabled&&Q.nodeName(s.parentNode,"optgroup"))){if(t=Q(s).val(),l)return t;r.push(t)}return l&&!r.length&&a.length?Q(a[o]).val():r},set:function(e,t){var i=Q.makeArray(t);return Q(e).find("option").each(function(){this.selected=Q.inArray(Q(this).val(),i)>=0}),i.length||(e.selectedIndex=-1),i}}},attrFn:{},attr:function(e,i,n,s){var o,r,a,l=e.nodeType;if(e&&3!==l&&8!==l&&2!==l)return s&&Q.isFunction(Q.fn[i])?Q(e)[i](n):"undefined"==typeof e.getAttribute?Q.prop(e,i,n):(a=1!==l||!Q.isXMLDoc(e),a&&(i=i.toLowerCase(),r=Q.attrHooks[i]||(Tt.test(i)?_t:vt)),n!==t?null===n?(Q.removeAttr(e,i),void 0):r&&"set"in r&&a&&(o=r.set(e,n,i))!==t?o:(e.setAttribute(i,n+""),n):r&&"get"in r&&a&&null!==(o=r.get(e,i))?o:(o=e.getAttribute(i),null===o?t:o))},removeAttr:function(e,t){var i,n,s,o,r=0;if(t&&1===e.nodeType)for(n=t.split(tt);r<n.length;r++)s=n[r],s&&(i=Q.propFix[s]||s,o=Tt.test(s),o||Q.attr(e,s,""),e.removeAttribute(Ct?s:i),o&&i in e&&(e[i]=!1))},attrHooks:{type:{set:function(e,t){if(wt.test(e.nodeName)&&e.parentNode)Q.error("type property can't be changed");else if(!Q.support.radioValue&&"radio"===t&&Q.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}},value:{get:function(e,t){return vt&&Q.nodeName(e,"button")?vt.get(e,t):t in e?e.value:null},set:function(e,t,i){return vt&&Q.nodeName(e,"button")?vt.set(e,t,i):(e.value=t,void 0)}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,i,n){var s,o,r,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return r=1!==a||!Q.isXMLDoc(e),r&&(i=Q.propFix[i]||i,o=Q.propHooks[i]),n!==t?o&&"set"in o&&(s=o.set(e,n,i))!==t?s:e[i]=n:o&&"get"in o&&null!==(s=o.get(e,i))?s:e[i]},propHooks:{tabIndex:{get:function(e){var i=e.getAttributeNode("tabindex");return i&&i.specified?parseInt(i.value,10):kt.test(e.nodeName)||Mt.test(e.nodeName)&&e.href?0:t}}}}),_t={get:function(e,i){var n,s=Q.prop(e,i);return s===!0||"boolean"!=typeof s&&(n=e.getAttributeNode(i))&&n.nodeValue!==!1?i.toLowerCase():t},set:function(e,t,i){var n;return t===!1?Q.removeAttr(e,i):(n=Q.propFix[i]||i,n in e&&(e[n]=!0),e.setAttribute(i,i.toLowerCase())),i}},Ct||(yt={name:!0,id:!0,coords:!0},vt=Q.valHooks.button={get:function(e,i){var n;return n=e.getAttributeNode(i),n&&(yt[i]?""!==n.value:n.specified)?n.value:t},set:function(e,t,i){var n=e.getAttributeNode(i);return n||(n=W.createAttribute(i),e.setAttributeNode(n)),n.value=t+""}},Q.each(["width","height"],function(e,t){Q.attrHooks[t]=Q.extend(Q.attrHooks[t],{set:function(e,i){return""===i?(e.setAttribute(t,"auto"),i):void 0}})}),Q.attrHooks.contenteditable={get:vt.get,set:function(e,t,i){""===t&&(t="false"),vt.set(e,t,i)}}),Q.support.hrefNormalized||Q.each(["href","src","width","height"],function(e,i){Q.attrHooks[i]=Q.extend(Q.attrHooks[i],{get:function(e){var n=e.getAttribute(i,2);return null===n?t:n}})}),Q.support.style||(Q.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=t+""}}),Q.support.optSelected||(Q.propHooks.selected=Q.extend(Q.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),Q.support.enctype||(Q.propFix.enctype="encoding"),Q.support.checkOn||Q.each(["radio","checkbox"],function(){Q.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),Q.each(["radio","checkbox"],function(){Q.valHooks[this]=Q.extend(Q.valHooks[this],{set:function(e,t){return Q.isArray(t)?e.checked=Q.inArray(Q(e).val(),t)>=0:void 0}})});var Et=/^(?:textarea|input|select)$/i,Pt=/^([^\.]*|)(?:\.(.+)|)$/,zt=/(?:^|\s)hover(\.\S+|)\b/,Dt=/^key/,St=/^(?:mouse|contextmenu)|click/,It=/^(?:focusinfocus|focusoutblur)$/,Nt=function(e){return Q.event.special.hover?e:e.replace(zt,"mouseenter$1 mouseleave$1")};Q.event={add:function(e,i,n,s,o){var r,a,l,c,h,u,p,d,f,g,m;if(3!==e.nodeType&&8!==e.nodeType&&i&&n&&(r=Q._data(e))){for(n.handler&&(f=n,n=f.handler,o=f.selector),n.guid||(n.guid=Q.guid++),l=r.events,l||(r.events=l={}),a=r.handle,a||(r.handle=a=function(e){return"undefined"==typeof Q||e&&Q.event.triggered===e.type?t:Q.event.dispatch.apply(a.elem,arguments)},a.elem=e),i=Q.trim(Nt(i)).split(" "),c=0;c<i.length;c++)h=Pt.exec(i[c])||[],u=h[1],p=(h[2]||"").split(".").sort(),m=Q.event.special[u]||{},u=(o?m.delegateType:m.bindType)||u,m=Q.event.special[u]||{},d=Q.extend({type:u,origType:h[1],data:s,handler:n,guid:n.guid,selector:o,needsContext:o&&Q.expr.match.needsContext.test(o),namespace:p.join(".")},f),g=l[u],g||(g=l[u]=[],g.delegateCount=0,m.setup&&m.setup.call(e,s,p,a)!==!1||(e.addEventListener?e.addEventListener(u,a,!1):e.attachEvent&&e.attachEvent("on"+u,a))),m.add&&(m.add.call(e,d),d.handler.guid||(d.handler.guid=n.guid)),o?g.splice(g.delegateCount++,0,d):g.push(d),Q.event.global[u]=!0;e=null}},global:{},remove:function(e,t,i,n,s){var o,r,a,l,c,h,u,p,d,f,g,m=Q.hasData(e)&&Q._data(e);if(m&&(p=m.events)){for(t=Q.trim(Nt(t||"")).split(" "),o=0;o<t.length;o++)if(r=Pt.exec(t[o])||[],a=l=r[1],c=r[2],a){for(d=Q.event.special[a]||{},a=(n?d.delegateType:d.bindType)||a,f=p[a]||[],h=f.length,c=c?new RegExp("(^|\\.)"+c.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null,u=0;u<f.length;u++)g=f[u],!s&&l!==g.origType||i&&i.guid!==g.guid||c&&!c.test(g.namespace)||n&&n!==g.selector&&("**"!==n||!g.selector)||(f.splice(u--,1),g.selector&&f.delegateCount--,d.remove&&d.remove.call(e,g));0===f.length&&h!==f.length&&(d.teardown&&d.teardown.call(e,c,m.handle)!==!1||Q.removeEvent(e,a,m.handle),delete p[a])}else for(a in p)Q.event.remove(e,a+t[o],i,n,!0);Q.isEmptyObject(p)&&(delete m.handle,Q.removeData(e,"events",!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(i,n,s,o){if(!s||3!==s.nodeType&&8!==s.nodeType){var r,a,l,c,h,u,p,d,f,g,m=i.type||i,v=[];if(!It.test(m+Q.event.triggered)&&(m.indexOf("!")>=0&&(m=m.slice(0,-1),a=!0),m.indexOf(".")>=0&&(v=m.split("."),m=v.shift(),v.sort()),s&&!Q.event.customEvent[m]||Q.event.global[m]))if(i="object"==typeof i?i[Q.expando]?i:new Q.Event(m,i):new Q.Event(m),i.type=m,i.isTrigger=!0,i.exclusive=a,i.namespace=v.join("."),i.namespace_re=i.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,u=m.indexOf(":")<0?"on"+m:"",s){if(i.result=t,i.target||(i.target=s),n=null!=n?Q.makeArray(n):[],n.unshift(i),p=Q.event.special[m]||{},!p.trigger||p.trigger.apply(s,n)!==!1){if(f=[[s,p.bindType||m]],!o&&!p.noBubble&&!Q.isWindow(s)){for(g=p.delegateType||m,c=It.test(g+m)?s:s.parentNode,h=s;c;c=c.parentNode)f.push([c,g]),h=c;h===(s.ownerDocument||W)&&f.push([h.defaultView||h.parentWindow||e,g])}for(l=0;l<f.length&&!i.isPropagationStopped();l++)c=f[l][0],i.type=f[l][1],d=(Q._data(c,"events")||{})[i.type]&&Q._data(c,"handle"),d&&d.apply(c,n),d=u&&c[u],d&&Q.acceptData(c)&&d.apply&&d.apply(c,n)===!1&&i.preventDefault();return i.type=m,o||i.isDefaultPrevented()||p._default&&p._default.apply(s.ownerDocument,n)!==!1||"click"===m&&Q.nodeName(s,"a")||!Q.acceptData(s)||u&&s[m]&&("focus"!==m&&"blur"!==m||0!==i.target.offsetWidth)&&!Q.isWindow(s)&&(h=s[u],h&&(s[u]=null),Q.event.triggered=m,s[m](),Q.event.triggered=t,h&&(s[u]=h)),i.result}}else{r=Q.cache;for(l in r)r[l].events&&r[l].events[m]&&Q.event.trigger(i,n,r[l].handle.elem,!0)}}},dispatch:function(i){i=Q.event.fix(i||e.event);var n,s,o,r,a,l,c,h,u,p=(Q._data(this,"events")||{})[i.type]||[],d=p.delegateCount,f=$.call(arguments),g=!i.exclusive&&!i.namespace,m=Q.event.special[i.type]||{},v=[];if(f[0]=i,i.delegateTarget=this,!m.preDispatch||m.preDispatch.call(this,i)!==!1){if(d&&(!i.button||"click"!==i.type))for(o=i.target;o!=this;o=o.parentNode||this)if(o.disabled!==!0||"click"!==i.type){for(a={},c=[],n=0;d>n;n++)h=p[n],u=h.selector,a[u]===t&&(a[u]=h.needsContext?Q(u,this).index(o)>=0:Q.find(u,this,null,[o]).length),a[u]&&c.push(h);c.length&&v.push({elem:o,matches:c})}for(p.length>d&&v.push({elem:this,matches:p.slice(d)}),n=0;n<v.length&&!i.isPropagationStopped();n++)for(l=v[n],i.currentTarget=l.elem,s=0;s<l.matches.length&&!i.isImmediatePropagationStopped();s++)h=l.matches[s],(g||!i.namespace&&!h.namespace||i.namespace_re&&i.namespace_re.test(h.namespace))&&(i.data=h.data,i.handleObj=h,r=((Q.event.special[h.origType]||{}).handle||h.handler).apply(l.elem,f),r!==t&&(i.result=r,r===!1&&(i.preventDefault(),i.stopPropagation())));return m.postDispatch&&m.postDispatch.call(this,i),i.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,i){var n,s,o,r=i.button,a=i.fromElement;return null==e.pageX&&null!=i.clientX&&(n=e.target.ownerDocument||W,s=n.documentElement,o=n.body,e.pageX=i.clientX+(s&&s.scrollLeft||o&&o.scrollLeft||0)-(s&&s.clientLeft||o&&o.clientLeft||0),e.pageY=i.clientY+(s&&s.scrollTop||o&&o.scrollTop||0)-(s&&s.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?i.toElement:a),e.which||r===t||(e.which=1&r?1:2&r?3:4&r?2:0),e}},fix:function(e){if(e[Q.expando])return e;var t,i,n=e,s=Q.event.fixHooks[e.type]||{},o=s.props?this.props.concat(s.props):this.props;for(e=Q.Event(n),t=o.length;t;)i=o[--t],e[i]=n[i];return e.target||(e.target=n.srcElement||W),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,n):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,i){Q.isWindow(this)&&(this.onbeforeunload=i)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,i,n){var s=Q.extend(new Q.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?Q.event.trigger(s,null,t):Q.event.dispatch.call(t,s),s.isDefaultPrevented()&&i.preventDefault()}},Q.event.handle=Q.event.dispatch,Q.removeEvent=W.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)}:function(e,t,i){var n="on"+t;e.detachEvent&&("undefined"==typeof e[n]&&(e[n]=null),e.detachEvent(n,i))},Q.Event=function(e,t){return this instanceof Q.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?r:o):this.type=e,t&&Q.extend(this,t),this.timeStamp=e&&e.timeStamp||Q.now(),this[Q.expando]=!0,void 0):new Q.Event(e,t)},Q.Event.prototype={preventDefault:function(){this.isDefaultPrevented=r;var e=this.originalEvent;e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=r;var e=this.originalEvent;e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=r,this.stopPropagation()},isDefaultPrevented:o,isPropagationStopped:o,isImmediatePropagationStopped:o},Q.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){Q.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,s=e.relatedTarget,o=e.handleObj;return o.selector,(!s||s!==n&&!Q.contains(n,s))&&(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}}),Q.support.submitBubbles||(Q.event.special.submit={setup:function(){return Q.nodeName(this,"form")?!1:(Q.event.add(this,"click._submit keypress._submit",function(e){var i=e.target,n=Q.nodeName(i,"input")||Q.nodeName(i,"button")?i.form:t;n&&!Q._data(n,"_submit_attached")&&(Q.event.add(n,"submit._submit",function(e){e._submit_bubble=!0}),Q._data(n,"_submit_attached",!0))}),void 0)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&Q.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return Q.nodeName(this,"form")?!1:(Q.event.remove(this,"._submit"),void 0)}}),Q.support.changeBubbles||(Q.event.special.change={setup:function(){return Et.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(Q.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),Q.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),Q.event.simulate("change",this,e,!0)})),!1):(Q.event.add(this,"beforeactivate._change",function(e){var t=e.target;Et.test(t.nodeName)&&!Q._data(t,"_change_attached")&&(Q.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||Q.event.simulate("change",this.parentNode,e,!0)}),Q._data(t,"_change_attached",!0))}),void 0)},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return Q.event.remove(this,"._change"),!Et.test(this.nodeName)}}),Q.support.focusinBubbles||Q.each({focus:"focusin",blur:"focusout"},function(e,t){var i=0,n=function(e){Q.event.simulate(t,e.target,Q.event.fix(e),!0)};Q.event.special[t]={setup:function(){0===i++&&W.addEventListener(e,n,!0)},teardown:function(){0===--i&&W.removeEventListener(e,n,!0)}}}),Q.fn.extend({on:function(e,i,n,s,r){var a,l;if("object"==typeof e){"string"!=typeof i&&(n=n||i,i=t);for(l in e)this.on(l,i,n,e[l],r);return this}if(null==n&&null==s?(s=i,n=i=t):null==s&&("string"==typeof i?(s=n,n=t):(s=n,n=i,i=t)),s===!1)s=o;else if(!s)return this;return 1===r&&(a=s,s=function(e){return Q().off(e),a.apply(this,arguments)},s.guid=a.guid||(a.guid=Q.guid++)),this.each(function(){Q.event.add(this,e,s,n,i)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,i,n){var s,r;if(e&&e.preventDefault&&e.handleObj)return s=e.handleObj,Q(e.delegateTarget).off(s.namespace?s.origType+"."+s.namespace:s.origType,s.selector,s.handler),this;if("object"==typeof e){for(r in e)this.off(r,i,e[r]);return this}return(i===!1||"function"==typeof i)&&(n=i,i=t),n===!1&&(n=o),this.each(function(){Q.event.remove(this,e,n,i)})},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,i){return Q(this.context).on(e,this.selector,t,i),this},die:function(e,t){return Q(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},trigger:function(e,t){return this.each(function(){Q.event.trigger(e,t,this)})},triggerHandler:function(e,t){return this[0]?Q.event.trigger(e,t,this[0],!0):void 0},toggle:function(e){var t=arguments,i=e.guid||Q.guid++,n=0,s=function(i){var s=(Q._data(this,"lastToggle"+e.guid)||0)%n;return Q._data(this,"lastToggle"+e.guid,s+1),i.preventDefault(),t[s].apply(this,arguments)||!1};for(s.guid=i;n<t.length;)t[n++].guid=i;return this.click(s)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),Q.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Q.fn[t]=function(e,i){return null==i&&(i=e,e=null),arguments.length>0?this.on(t,null,e,i):this.trigger(t)},Dt.test(t)&&(Q.event.fixHooks[t]=Q.event.keyHooks),St.test(t)&&(Q.event.fixHooks[t]=Q.event.mouseHooks)}),function(e,t){function i(e,t,i,n){i=i||[],t=t||S;var s,o,r,a,l=t.nodeType;if(!e||"string"!=typeof e)return i;if(1!==l&&9!==l)return[];if(r=x(t),!r&&!n&&(s=it.exec(e)))if(a=s[1]){if(9===l){if(o=t.getElementById(a),!o||!o.parentNode)return i;if(o.id===a)return i.push(o),i}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&w(t,o)&&o.id===a)return i.push(o),i}else{if(s[2])return O.apply(i,R.call(t.getElementsByTagName(e),0)),i;if((a=s[3])&&pt&&t.getElementsByClassName)return O.apply(i,R.call(t.getElementsByClassName(a),0)),i}return g(e.replace(Z,"$1"),t,i,n,r)}function n(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function s(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function o(e){return H(function(t){return t=+t,H(function(i,n){for(var s,o=e([],i.length,t),r=o.length;r--;)i[s=o[r]]&&(i[s]=!(n[s]=i[s]))})})}function r(e,t,i){if(e===t)return i;for(var n=e.nextSibling;n;){if(n===t)return-1;n=n.nextSibling}return 1}function a(e,t){var n,s,o,r,a,l,c,h=B[z][e];if(h)return t?0:h.slice(0);for(a=e,l=[],c=y.preFilter;a;){(!n||(s=J.exec(a)))&&(s&&(a=a.slice(s[0].length)),l.push(o=[])),n=!1,(s=et.exec(a))&&(o.push(n=new D(s.shift())),a=a.slice(n.length),n.type=s[0].replace(Z," "));for(r in y.filter)!(s=at[r].exec(a))||c[r]&&!(s=c[r](s,S,!0))||(o.push(n=new D(s.shift())),a=a.slice(n.length),n.type=r,n.matches=s);if(!n)break}return t?a.length:a?i.error(e):B(e,l).slice(0)}function l(e,t,i){var n=t.dir,s=i&&"parentNode"===t.dir,o=A++;return t.first?function(t,i,o){for(;t=t[n];)if(s||1===t.nodeType)return e(t,i,o)}:function(t,i,r){if(r){for(;t=t[n];)if((s||1===t.nodeType)&&e(t,i,r))return t}else for(var a,l=N+" "+o+" ",c=l+v;t=t[n];)if(s||1===t.nodeType){if((a=t[z])===c)return t.sizset;if("string"==typeof a&&0===a.indexOf(l)){if(t.sizset)return t}else{if(t[z]=c,e(t,i,r))return t.sizset=!0,t;t.sizset=!1}}}}function c(e){return e.length>1?function(t,i,n){for(var s=e.length;s--;)if(!e[s](t,i,n))return!1;return!0}:e[0]}function h(e,t,i,n,s){for(var o,r=[],a=0,l=e.length,c=null!=t;l>a;a++)(o=e[a])&&(!i||i(o,n,s))&&(r.push(o),c&&t.push(a));return r}function u(e,t,i,n,s,o){return n&&!n[z]&&(n=u(n)),s&&!s[z]&&(s=u(s,o)),H(function(o,r,a,l){if(!o||!s){var c,u,p,d=[],g=[],m=r.length,v=o||f(t||"*",a.nodeType?[a]:a,[],o),_=!e||!o&&t?v:h(v,d,e,a,l),y=i?s||(o?e:m||n)?[]:r:_;if(i&&i(_,y,a,l),n)for(p=h(y,g),n(p,[],a,l),c=p.length;c--;)(u=p[c])&&(y[g[c]]=!(_[g[c]]=u));if(o)for(c=e&&y.length;c--;)(u=y[c])&&(o[d[c]]=!(r[d[c]]=u));else y=h(y===r?y.splice(m,y.length):y),s?s(null,r,y,l):O.apply(r,y)}})}function p(e){for(var t,i,n,s=e.length,o=y.relative[e[0].type],r=o||y.relative[" "],a=o?1:0,h=l(function(e){return e===t},r,!0),d=l(function(e){return j.call(t,e)>-1},r,!0),f=[function(e,i,n){return!o&&(n||i!==C)||((t=i).nodeType?h(e,i,n):d(e,i,n))}];s>a;a++)if(i=y.relative[e[a].type])f=[l(c(f),i)];else{if(i=y.filter[e[a].type].apply(null,e[a].matches),i[z]){for(n=++a;s>n&&!y.relative[e[n].type];n++);return u(a>1&&c(f),a>1&&e.slice(0,a-1).join("").replace(Z,"$1"),i,n>a&&p(e.slice(a,n)),s>n&&p(e=e.slice(n)),s>n&&e.join(""))}f.push(i)}return c(f)}function d(e,t){var n=t.length>0,s=e.length>0,o=function(r,a,l,c,u){var p,d,f,g=[],m=0,_="0",b=r&&[],x=null!=u,w=C,k=r||s&&y.find.TAG("*",u&&a.parentNode||a),M=N+=null==w?1:Math.E;for(x&&(C=a!==S&&a,v=o.el);null!=(p=k[_]);_++){if(s&&p){for(d=0;f=e[d];d++)if(f(p,a,l)){c.push(p);break}x&&(N=M,v=++o.el)}n&&((p=!f&&p)&&m--,r&&b.push(p))}if(m+=_,n&&_!==m){for(d=0;f=t[d];d++)f(b,g,a,l);if(r){if(m>0)for(;_--;)b[_]||g[_]||(g[_]=L.call(c));g=h(g)}O.apply(c,g),x&&!r&&g.length>0&&m+t.length>1&&i.uniqueSort(c)}return x&&(N=M,C=w),b};return o.el=0,n?H(o):o}function f(e,t,n,s){for(var o=0,r=t.length;r>o;o++)i(e,t[o],n,s);return n}function g(e,t,i,n,s){var o,r,l,c,h,u=a(e);if(u.length,!n&&1===u.length){if(r=u[0]=u[0].slice(0),r.length>2&&"ID"===(l=r[0]).type&&9===t.nodeType&&!s&&y.relative[r[1].type]){if(t=y.find.ID(l.matches[0].replace(rt,""),t,s)[0],!t)return i;
e=e.slice(r.shift().length)}for(o=at.POS.test(e)?-1:r.length-1;o>=0&&(l=r[o],!y.relative[c=l.type]);o--)if((h=y.find[c])&&(n=h(l.matches[0].replace(rt,""),nt.test(r[0].type)&&t.parentNode||t,s))){if(r.splice(o,1),e=n.length&&r.join(""),!e)return O.apply(i,R.call(n,0)),i;break}}return k(e,u)(n,t,s,i,nt.test(e)),i}function m(){}var v,_,y,b,x,w,k,M,T,C,E=!0,P="undefined",z=("sizcache"+Math.random()).replace(".",""),D=String,S=e.document,I=S.documentElement,N=0,A=0,L=[].pop,O=[].push,R=[].slice,j=[].indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(this[t]===e)return t;return-1},H=function(e,t){return e[z]=null==t||t,e},q=function(){var e={},t=[];return H(function(i,n){return t.push(i)>y.cacheLength&&delete e[t.shift()],e[i]=n},e)},W=q(),B=q(),F=q(),U="[\\x20\\t\\r\\n\\f]",G="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",V=G.replace("w","w#"),$="([*^$|!~]?=)",X="\\["+U+"*("+G+")"+U+"*(?:"+$+U+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+V+")|)|)"+U+"*\\]",Y=":("+G+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+X+")|[^:]|\\\\.)*|.*))\\)|)",K=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+U+"*((?:-\\d)?\\d*)"+U+"*\\)|)(?=[^-]|$)",Z=new RegExp("^"+U+"+|((?:^|[^\\\\])(?:\\\\.)*)"+U+"+$","g"),J=new RegExp("^"+U+"*,"+U+"*"),et=new RegExp("^"+U+"*([\\x20\\t\\r\\n\\f>+~])"+U+"*"),tt=new RegExp(Y),it=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,nt=/[\x20\t\r\n\f]*[+~]/,st=/h\d/i,ot=/input|select|textarea|button/i,rt=/\\(?!\\)/g,at={ID:new RegExp("^#("+G+")"),CLASS:new RegExp("^\\.("+G+")"),NAME:new RegExp("^\\[name=['\"]?("+G+")['\"]?\\]"),TAG:new RegExp("^("+G.replace("w","w*")+")"),ATTR:new RegExp("^"+X),PSEUDO:new RegExp("^"+Y),POS:new RegExp(K,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+U+"*(even|odd|(([+-]|)(\\d*)n|)"+U+"*(?:([+-]|)"+U+"*(\\d+)|))"+U+"*\\)|)","i"),needsContext:new RegExp("^"+U+"*[>+~]|"+K,"i")},lt=function(e){var t=S.createElement("div");try{return e(t)}catch(i){return!1}finally{t=null}},ct=lt(function(e){return e.appendChild(S.createComment("")),!e.getElementsByTagName("*").length}),ht=lt(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==P&&"#"===e.firstChild.getAttribute("href")}),ut=lt(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),pt=lt(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),dt=lt(function(e){e.id=z+0,e.innerHTML="<a name='"+z+"'></a><div name='"+z+"'></div>",I.insertBefore(e,I.firstChild);var t=S.getElementsByName&&S.getElementsByName(z).length===2+S.getElementsByName(z+0).length;return _=!S.getElementById(z),I.removeChild(e),t});try{R.call(I.childNodes,0)[0].nodeType}catch(ft){R=function(e){for(var t,i=[];t=this[e];e++)i.push(t);return i}}i.matches=function(e,t){return i(e,null,null,t)},i.matchesSelector=function(e,t){return i(t,null,null,[e]).length>0},b=i.getText=function(e){var t,i="",n=0,s=e.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=b(e)}else if(3===s||4===s)return e.nodeValue}else for(;t=e[n];n++)i+=b(t);return i},x=i.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},w=i.contains=I.contains?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!!(n&&1===n.nodeType&&i.contains&&i.contains(n))}:I.compareDocumentPosition?function(e,t){return t&&!!(16&e.compareDocumentPosition(t))}:function(e,t){for(;t=t.parentNode;)if(t===e)return!0;return!1},i.attr=function(e,t){var i,n=x(e);return n||(t=t.toLowerCase()),(i=y.attrHandle[t])?i(e):n||ut?e.getAttribute(t):(i=e.getAttributeNode(t),i?"boolean"==typeof e[t]?e[t]?t:null:i.specified?i.value:null:null)},y=i.selectors={cacheLength:50,createPseudo:H,match:at,attrHandle:ht?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:_?function(e,t,i){if(typeof t.getElementById!==P&&!i){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}}:function(e,i,n){if(typeof i.getElementById!==P&&!n){var s=i.getElementById(e);return s?s.id===e||typeof s.getAttributeNode!==P&&s.getAttributeNode("id").value===e?[s]:t:[]}},TAG:ct?function(e,t){return typeof t.getElementsByTagName!==P?t.getElementsByTagName(e):void 0}:function(e,t){var i=t.getElementsByTagName(e);if("*"===e){for(var n,s=[],o=0;n=i[o];o++)1===n.nodeType&&s.push(n);return s}return i},NAME:dt&&function(e,t){return typeof t.getElementsByName!==P?t.getElementsByName(name):void 0},CLASS:pt&&function(e,t,i){return typeof t.getElementsByClassName===P||i?void 0:t.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(rt,""),e[3]=(e[4]||e[5]||"").replace(rt,""),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1]?(e[2]||i.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*("even"===e[2]||"odd"===e[2])),e[4]=+(e[6]+e[7]||"odd"===e[2])):e[2]&&i.error(e[0]),e},PSEUDO:function(e){var t,i;return at.CHILD.test(e[0])?null:(e[3]?e[2]=e[3]:(t=e[4])&&(tt.test(t)&&(i=a(t,!0))&&(i=t.indexOf(")",t.length-i)-t.length)&&(t=t.slice(0,i),e[0]=e[0].slice(0,i)),e[2]=t),e.slice(0,3))}},filter:{ID:_?function(e){return e=e.replace(rt,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace(rt,""),function(t){var i=typeof t.getAttributeNode!==P&&t.getAttributeNode("id");return i&&i.value===e}},TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(rt,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=W[z][e];return t||(t=W(e,new RegExp("(^|"+U+")"+e+"("+U+"|$)"))),function(e){return t.test(e.className||typeof e.getAttribute!==P&&e.getAttribute("class")||"")}},ATTR:function(e,t,n){return function(s){var o=i.attr(s,e);return null==o?"!="===t:t?(o+="","="===t?o===n:"!="===t?o!==n:"^="===t?n&&0===o.indexOf(n):"*="===t?n&&o.indexOf(n)>-1:"$="===t?n&&o.substr(o.length-n.length)===n:"~="===t?(" "+o+" ").indexOf(n)>-1:"|="===t?o===n||o.substr(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,i,n){return"nth"===e?function(e){var t,s,o=e.parentNode;if(1===i&&0===n)return!0;if(o)for(s=0,t=o.firstChild;t&&(1!==t.nodeType||(s++,e!==t));t=t.nextSibling);return s-=n,s===i||0===s%i&&s/i>=0}:function(t){var i=t;switch(e){case"only":case"first":for(;i=i.previousSibling;)if(1===i.nodeType)return!1;if("first"===e)return!0;i=t;case"last":for(;i=i.nextSibling;)if(1===i.nodeType)return!1;return!0}}},PSEUDO:function(e,t){var n,s=y.pseudos[e]||y.setFilters[e.toLowerCase()]||i.error("unsupported pseudo: "+e);return s[z]?s(t):s.length>1?(n=[e,e,"",t],y.setFilters.hasOwnProperty(e.toLowerCase())?H(function(e,i){for(var n,o=s(e,t),r=o.length;r--;)n=j.call(e,o[r]),e[n]=!(i[n]=o[r])}):function(e){return s(e,0,n)}):s}},pseudos:{not:H(function(e){var t=[],i=[],n=k(e.replace(Z,"$1"));return n[z]?H(function(e,t,i,s){for(var o,r=n(e,null,s,[]),a=e.length;a--;)(o=r[a])&&(e[a]=!(t[a]=o))}):function(e,s,o){return t[0]=e,n(t,null,o,i),!i.pop()}}),has:H(function(e){return function(t){return i(e,t).length>0}}),contains:H(function(e){return function(t){return(t.textContent||t.innerText||b(t)).indexOf(e)>-1}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!y.pseudos.empty(e)},empty:function(e){var t;for(e=e.firstChild;e;){if(e.nodeName>"@"||3===(t=e.nodeType)||4===t)return!1;e=e.nextSibling}return!0},header:function(e){return st.test(e.nodeName)},text:function(e){var t,i;return"input"===e.nodeName.toLowerCase()&&"text"===(t=e.type)&&(null==(i=e.getAttribute("type"))||i.toLowerCase()===t)},radio:n("radio"),checkbox:n("checkbox"),file:n("file"),password:n("password"),image:n("image"),submit:s("submit"),reset:s("reset"),button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},input:function(e){return ot.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return!(e!==t.activeElement||t.hasFocus&&!t.hasFocus()||!e.type&&!e.href)},active:function(e){return e===e.ownerDocument.activeElement},first:o(function(){return[0]}),last:o(function(e,t){return[t-1]}),eq:o(function(e,t,i){return[0>i?i+t:i]}),even:o(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:o(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:o(function(e,t,i){for(var n=0>i?i+t:i;--n>=0;)e.push(n);return e}),gt:o(function(e,t,i){for(var n=0>i?i+t:i;++n<t;)e.push(n);return e})}},M=I.compareDocumentPosition?function(e,t){return e===t?(T=!0,0):(e.compareDocumentPosition&&t.compareDocumentPosition?4&e.compareDocumentPosition(t):e.compareDocumentPosition)?-1:1}:function(e,t){if(e===t)return T=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var i,n,s=[],o=[],a=e.parentNode,l=t.parentNode,c=a;if(a===l)return r(e,t);if(!a)return-1;if(!l)return 1;for(;c;)s.unshift(c),c=c.parentNode;for(c=l;c;)o.unshift(c),c=c.parentNode;i=s.length,n=o.length;for(var h=0;i>h&&n>h;h++)if(s[h]!==o[h])return r(s[h],o[h]);return h===i?r(e,o[h],-1):r(s[h],t,1)},[0,0].sort(M),E=!T,i.uniqueSort=function(e){var t,i=1;if(T=E,e.sort(M),T)for(;t=e[i];i++)t===e[i-1]&&e.splice(i--,1);return e},i.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},k=i.compile=function(e,t){var i,n=[],s=[],o=F[z][e];if(!o){for(t||(t=a(e)),i=t.length;i--;)o=p(t[i]),o[z]?n.push(o):s.push(o);o=F(e,d(s,n))}return o},S.querySelectorAll&&!function(){var e,t=g,n=/'|\\/g,s=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,o=[":focus"],r=[":active",":focus"],l=I.matchesSelector||I.mozMatchesSelector||I.webkitMatchesSelector||I.oMatchesSelector||I.msMatchesSelector;lt(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||o.push("\\["+U+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||o.push(":checked")}),lt(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&o.push("[*^$]="+U+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||o.push(":enabled",":disabled")}),o=new RegExp(o.join("|")),g=function(e,i,s,r,l){if(!(r||l||o&&o.test(e))){var c,h,u=!0,p=z,d=i,f=9===i.nodeType&&e;if(1===i.nodeType&&"object"!==i.nodeName.toLowerCase()){for(c=a(e),(u=i.getAttribute("id"))?p=u.replace(n,"\\$&"):i.setAttribute("id",p),p="[id='"+p+"'] ",h=c.length;h--;)c[h]=p+c[h].join("");d=nt.test(e)&&i.parentNode||i,f=c.join(",")}if(f)try{return O.apply(s,R.call(d.querySelectorAll(f),0)),s}catch(g){}finally{u||i.removeAttribute("id")}}return t(e,i,s,r,l)},l&&(lt(function(t){e=l.call(t,"div");try{l.call(t,"[test!='']:sizzle"),r.push("!=",Y)}catch(i){}}),r=new RegExp(r.join("|")),i.matchesSelector=function(t,n){if(n=n.replace(s,"='$1']"),!(x(t)||r.test(n)||o&&o.test(n)))try{var a=l.call(t,n);if(a||e||t.document&&11!==t.document.nodeType)return a}catch(c){}return i(n,null,null,[t]).length>0})}(),y.pseudos.nth=y.pseudos.eq,y.filters=m.prototype=y.pseudos,y.setFilters=new m,i.attr=Q.attr,Q.find=i,Q.expr=i.selectors,Q.expr[":"]=Q.expr.pseudos,Q.unique=i.uniqueSort,Q.text=i.getText,Q.isXMLDoc=i.isXML,Q.contains=i.contains}(e);var At=/Until$/,Lt=/^(?:parents|prev(?:Until|All))/,Ot=/^.[^:#\[\.,]*$/,Rt=Q.expr.match.needsContext,jt={children:!0,contents:!0,next:!0,prev:!0};Q.fn.extend({find:function(e){var t,i,n,s,o,r,a=this;if("string"!=typeof e)return Q(e).filter(function(){for(t=0,i=a.length;i>t;t++)if(Q.contains(a[t],this))return!0});for(r=this.pushStack("","find",e),t=0,i=this.length;i>t;t++)if(n=r.length,Q.find(e,this[t],r),t>0)for(s=n;s<r.length;s++)for(o=0;n>o;o++)if(r[o]===r[s]){r.splice(s--,1);break}return r},has:function(e){var t,i=Q(e,this),n=i.length;return this.filter(function(){for(t=0;n>t;t++)if(Q.contains(this,i[t]))return!0})},not:function(e){return this.pushStack(c(this,e,!1),"not",e)},filter:function(e){return this.pushStack(c(this,e,!0),"filter",e)},is:function(e){return!!e&&("string"==typeof e?Rt.test(e)?Q(e,this.context).index(this[0])>=0:Q.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){for(var i,n=0,s=this.length,o=[],r=Rt.test(e)||"string"!=typeof e?Q(e,t||this.context):0;s>n;n++)for(i=this[n];i&&i.ownerDocument&&i!==t&&11!==i.nodeType;){if(r?r.index(i)>-1:Q.find.matchesSelector(i,e)){o.push(i);break}i=i.parentNode}return o=o.length>1?Q.unique(o):o,this.pushStack(o,"closest",e)},index:function(e){return e?"string"==typeof e?Q.inArray(this[0],Q(e)):Q.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var i="string"==typeof e?Q(e,t):Q.makeArray(e&&e.nodeType?[e]:e),n=Q.merge(this.get(),i);return this.pushStack(a(i[0])||a(n[0])?n:Q.unique(n))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Q.fn.andSelf=Q.fn.addBack,Q.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Q.dir(e,"parentNode")},parentsUntil:function(e,t,i){return Q.dir(e,"parentNode",i)},next:function(e){return l(e,"nextSibling")},prev:function(e){return l(e,"previousSibling")},nextAll:function(e){return Q.dir(e,"nextSibling")},prevAll:function(e){return Q.dir(e,"previousSibling")},nextUntil:function(e,t,i){return Q.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return Q.dir(e,"previousSibling",i)},siblings:function(e){return Q.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return Q.sibling(e.firstChild)},contents:function(e){return Q.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:Q.merge([],e.childNodes)}},function(e,t){Q.fn[e]=function(i,n){var s=Q.map(this,t,i);return At.test(e)||(n=i),n&&"string"==typeof n&&(s=Q.filter(n,s)),s=this.length>1&&!jt[e]?Q.unique(s):s,this.length>1&&Lt.test(e)&&(s=s.reverse()),this.pushStack(s,e,$.call(arguments).join(","))}}),Q.extend({filter:function(e,t,i){return i&&(e=":not("+e+")"),1===t.length?Q.find.matchesSelector(t[0],e)?[t[0]]:[]:Q.find.matches(e,t)},dir:function(e,i,n){for(var s=[],o=e[i];o&&9!==o.nodeType&&(n===t||1!==o.nodeType||!Q(o).is(n));)1===o.nodeType&&s.push(o),o=o[i];return s},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}});var Ht="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",qt=/ jQuery\d+="(?:null|\d+)"/g,Wt=/^\s+/,Bt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ft=/<([\w:]+)/,Ut=/<tbody/i,Gt=/<|&#?\w+;/,Vt=/<(?:script|style|link)/i,$t=/<(?:script|object|embed|option|style)/i,Xt=new RegExp("<(?:"+Ht+")[\\s/>]","i"),Yt=/^(?:checkbox|radio)$/,Kt=/checked\s*(?:[^=]|=\s*.checked.)/i,Zt=/\/(java|ecma)script/i,Qt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Jt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},ei=h(W),ti=ei.appendChild(W.createElement("div"));Jt.optgroup=Jt.option,Jt.tbody=Jt.tfoot=Jt.colgroup=Jt.caption=Jt.thead,Jt.th=Jt.td,Q.support.htmlSerialize||(Jt._default=[1,"X<div>","</div>"]),Q.fn.extend({text:function(e){return Q.access(this,function(e){return e===t?Q.text(this):this.empty().append((this[0]&&this[0].ownerDocument||W).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(Q.isFunction(e))return this.each(function(t){Q(this).wrapAll(e.call(this,t))});if(this[0]){var t=Q(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return Q.isFunction(e)?this.each(function(t){Q(this).wrapInner(e.call(this,t))}):this.each(function(){var t=Q(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=Q.isFunction(e);return this.each(function(i){Q(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){Q.nodeName(this,"body")||Q(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!a(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=Q.clean(arguments);return this.pushStack(Q.merge(e,this),"before",this.selector)}},after:function(){if(!a(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=Q.clean(arguments);return this.pushStack(Q.merge(this,e),"after",this.selector)}},remove:function(e,t){for(var i,n=0;null!=(i=this[n]);n++)(!e||Q.filter(e,[i]).length)&&(t||1!==i.nodeType||(Q.cleanData(i.getElementsByTagName("*")),Q.cleanData([i])),i.parentNode&&i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)for(1===e.nodeType&&Q.cleanData(e.getElementsByTagName("*"));e.firstChild;)e.removeChild(e.firstChild);return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return Q.clone(this,e,t)})},html:function(e){return Q.access(this,function(e){var i=this[0]||{},n=0,s=this.length;if(e===t)return 1===i.nodeType?i.innerHTML.replace(qt,""):t;if(!("string"!=typeof e||Vt.test(e)||!Q.support.htmlSerialize&&Xt.test(e)||!Q.support.leadingWhitespace&&Wt.test(e)||Jt[(Ft.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Bt,"<$1></$2>");try{for(;s>n;n++)i=this[n]||{},1===i.nodeType&&(Q.cleanData(i.getElementsByTagName("*")),i.innerHTML=e);i=0}catch(o){}}i&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return a(this[0])?this.length?this.pushStack(Q(Q.isFunction(e)?e():e),"replaceWith",e):this:Q.isFunction(e)?this.each(function(t){var i=Q(this),n=i.html();i.replaceWith(e.call(this,t,n))}):("string"!=typeof e&&(e=Q(e).detach()),this.each(function(){var t=this.nextSibling,i=this.parentNode;Q(this).remove(),t?Q(t).before(e):Q(i).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,i,n){e=[].concat.apply([],e);var s,o,r,a,l=0,c=e[0],h=[],p=this.length;if(!Q.support.checkClone&&p>1&&"string"==typeof c&&Kt.test(c))return this.each(function(){Q(this).domManip(e,i,n)});if(Q.isFunction(c))return this.each(function(s){var o=Q(this);e[0]=c.call(this,s,i?o.html():t),o.domManip(e,i,n)});if(this[0]){if(s=Q.buildFragment(e,this,h),r=s.fragment,o=r.firstChild,1===r.childNodes.length&&(r=o),o)for(i=i&&Q.nodeName(o,"tr"),a=s.cacheable||p-1;p>l;l++)n.call(i&&Q.nodeName(this[l],"table")?u(this[l],"tbody"):this[l],l===a?r:Q.clone(r,!0,!0));r=o=null,h.length&&Q.each(h,function(e,t){t.src?Q.ajax?Q.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):Q.error("no ajax"):Q.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Qt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),Q.buildFragment=function(e,i,n){var s,o,r,a=e[0];return i=i||W,i=!i.nodeType&&i[0]||i,i=i.ownerDocument||i,!(1===e.length&&"string"==typeof a&&a.length<512&&i===W&&"<"===a.charAt(0))||$t.test(a)||!Q.support.checkClone&&Kt.test(a)||!Q.support.html5Clone&&Xt.test(a)||(o=!0,s=Q.fragments[a],r=s!==t),s||(s=i.createDocumentFragment(),Q.clean(e,i,s,n),o&&(Q.fragments[a]=r&&s)),{fragment:s,cacheable:o}},Q.fragments={},Q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Q.fn[e]=function(i){var n,s=0,o=[],r=Q(i),a=r.length,l=1===this.length&&this[0].parentNode;if((null==l||l&&11===l.nodeType&&1===l.childNodes.length)&&1===a)return r[t](this[0]),this;for(;a>s;s++)n=(s>0?this.clone(!0):this).get(),Q(r[s])[t](n),o=o.concat(n);return this.pushStack(o,e,r.selector)}}),Q.extend({clone:function(e,t,i){var n,s,o,r;if(Q.support.html5Clone||Q.isXMLDoc(e)||!Xt.test("<"+e.nodeName+">")?r=e.cloneNode(!0):(ti.innerHTML=e.outerHTML,ti.removeChild(r=ti.firstChild)),!(Q.support.noCloneEvent&&Q.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Q.isXMLDoc(e)))for(d(e,r),n=f(e),s=f(r),o=0;n[o];++o)s[o]&&d(n[o],s[o]);if(t&&(p(e,r),i))for(n=f(e),s=f(r),o=0;n[o];++o)p(n[o],s[o]);return n=s=null,r},clean:function(e,t,i,n){var s,o,r,a,l,c,u,p,d,f,m,v=t===W&&ei,_=[];for(t&&"undefined"!=typeof t.createDocumentFragment||(t=W),s=0;null!=(r=e[s]);s++)if("number"==typeof r&&(r+=""),r){if("string"==typeof r)if(Gt.test(r)){for(v=v||h(t),u=t.createElement("div"),v.appendChild(u),r=r.replace(Bt,"<$1></$2>"),a=(Ft.exec(r)||["",""])[1].toLowerCase(),l=Jt[a]||Jt._default,c=l[0],u.innerHTML=l[1]+r+l[2];c--;)u=u.lastChild;if(!Q.support.tbody)for(p=Ut.test(r),d="table"!==a||p?"<table>"!==l[1]||p?[]:u.childNodes:u.firstChild&&u.firstChild.childNodes,o=d.length-1;o>=0;--o)Q.nodeName(d[o],"tbody")&&!d[o].childNodes.length&&d[o].parentNode.removeChild(d[o]);!Q.support.leadingWhitespace&&Wt.test(r)&&u.insertBefore(t.createTextNode(Wt.exec(r)[0]),u.firstChild),r=u.childNodes,u.parentNode.removeChild(u)}else r=t.createTextNode(r);r.nodeType?_.push(r):Q.merge(_,r)}if(u&&(r=u=v=null),!Q.support.appendChecked)for(s=0;null!=(r=_[s]);s++)Q.nodeName(r,"input")?g(r):"undefined"!=typeof r.getElementsByTagName&&Q.grep(r.getElementsByTagName("input"),g);if(i)for(f=function(e){return!e.type||Zt.test(e.type)?n?n.push(e.parentNode?e.parentNode.removeChild(e):e):i.appendChild(e):void 0},s=0;null!=(r=_[s]);s++)Q.nodeName(r,"script")&&f(r)||(i.appendChild(r),"undefined"!=typeof r.getElementsByTagName&&(m=Q.grep(Q.merge([],r.getElementsByTagName("script")),f),_.splice.apply(_,[s+1,0].concat(m)),s+=m.length));return _},cleanData:function(e,t){for(var i,n,s,o,r=0,a=Q.expando,l=Q.cache,c=Q.support.deleteExpando,h=Q.event.special;null!=(s=e[r]);r++)if((t||Q.acceptData(s))&&(n=s[a],i=n&&l[n])){if(i.events)for(o in i.events)h[o]?Q.event.remove(s,o):Q.removeEvent(s,o,i.handle);l[n]&&(delete l[n],c?delete s[a]:s.removeAttribute?s.removeAttribute(a):s[a]=null,Q.deletedIds.push(n))}}}),function(){var e,t;Q.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=Q.uaMatch(F.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),Q.browser=t,Q.sub=function(){function e(t,i){return new e.fn.init(t,i)}Q.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(i,n){return n&&n instanceof Q&&!(n instanceof e)&&(n=e(n)),Q.fn.init.call(this,i,n,t)},e.fn.init.prototype=e.fn;var t=e(W);return e}}();var ii,ni,si,oi=/alpha\([^)]*\)/i,ri=/opacity=([^)]*)/,ai=/^(top|right|bottom|left)$/,li=/^(none|table(?!-c[ea]).+)/,ci=/^margin/,hi=new RegExp("^("+J+")(.*)$","i"),ui=new RegExp("^("+J+")(?!px)[a-z%]+$","i"),pi=new RegExp("^([-+])=("+J+")","i"),di={},fi={position:"absolute",visibility:"hidden",display:"block"},gi={letterSpacing:0,fontWeight:400},mi=["Top","Right","Bottom","Left"],vi=["Webkit","O","Moz","ms"],_i=Q.fn.toggle;Q.fn.extend({css:function(e,i){return Q.access(this,function(e,i,n){return n!==t?Q.style(e,i,n):Q.css(e,i)},e,i,arguments.length>1)},show:function(){return _(this,!0)},hide:function(){return _(this)},toggle:function(e,t){var i="boolean"==typeof e;return Q.isFunction(e)&&Q.isFunction(t)?_i.apply(this,arguments):this.each(function(){(i?e:v(this))?Q(this).show():Q(this).hide()})}}),Q.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=ii(e,"opacity");return""===i?"1":i}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":Q.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,i,n,s){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,r,a,l=Q.camelCase(i),c=e.style;if(i=Q.cssProps[l]||(Q.cssProps[l]=m(c,l)),a=Q.cssHooks[i]||Q.cssHooks[l],n===t)return a&&"get"in a&&(o=a.get(e,!1,s))!==t?o:c[i];if(r=typeof n,"string"===r&&(o=pi.exec(n))&&(n=(o[1]+1)*o[2]+parseFloat(Q.css(e,i)),r="number"),!(null==n||"number"===r&&isNaN(n)||("number"!==r||Q.cssNumber[l]||(n+="px"),a&&"set"in a&&(n=a.set(e,n,s))===t)))try{c[i]=n}catch(h){}}},css:function(e,i,n,s){var o,r,a,l=Q.camelCase(i);return i=Q.cssProps[l]||(Q.cssProps[l]=m(e.style,l)),a=Q.cssHooks[i]||Q.cssHooks[l],a&&"get"in a&&(o=a.get(e,!0,s)),o===t&&(o=ii(e,i)),"normal"===o&&i in gi&&(o=gi[i]),n||s!==t?(r=parseFloat(o),n||Q.isNumeric(r)?r||0:o):o},swap:function(e,t,i){var n,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];n=i.call(e);for(s in t)e.style[s]=o[s];return n}}),e.getComputedStyle?ii=function(t,i){var n,s,o,r,a=e.getComputedStyle(t,null),l=t.style;return a&&(n=a[i],""!==n||Q.contains(t.ownerDocument,t)||(n=Q.style(t,i)),ui.test(n)&&ci.test(i)&&(s=l.width,o=l.minWidth,r=l.maxWidth,l.minWidth=l.maxWidth=l.width=n,n=a.width,l.width=s,l.minWidth=o,l.maxWidth=r)),n}:W.documentElement.currentStyle&&(ii=function(e,t){var i,n,s=e.currentStyle&&e.currentStyle[t],o=e.style;return null==s&&o&&o[t]&&(s=o[t]),ui.test(s)&&!ai.test(t)&&(i=o.left,n=e.runtimeStyle&&e.runtimeStyle.left,n&&(e.runtimeStyle.left=e.currentStyle.left),o.left="fontSize"===t?"1em":s,s=o.pixelLeft+"px",o.left=i,n&&(e.runtimeStyle.left=n)),""===s?"auto":s}),Q.each(["height","width"],function(e,t){Q.cssHooks[t]={get:function(e,i,n){return i?0===e.offsetWidth&&li.test(ii(e,"display"))?Q.swap(e,fi,function(){return x(e,t,n)}):x(e,t,n):void 0},set:function(e,i,n){return y(e,i,n?b(e,t,n,Q.support.boxSizing&&"border-box"===Q.css(e,"boxSizing")):0)}}}),Q.support.opacity||(Q.cssHooks.opacity={get:function(e,t){return ri.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,n=e.currentStyle,s=Q.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=n&&n.filter||i.filter||"";i.zoom=1,t>=1&&""===Q.trim(o.replace(oi,""))&&i.removeAttribute&&(i.removeAttribute("filter"),n&&!n.filter)||(i.filter=oi.test(o)?o.replace(oi,s):o+" "+s)}}),Q(function(){Q.support.reliableMarginRight||(Q.cssHooks.marginRight={get:function(e,t){return Q.swap(e,{display:"inline-block"},function(){return t?ii(e,"marginRight"):void 0})}}),!Q.support.pixelPosition&&Q.fn.position&&Q.each(["top","left"],function(e,t){Q.cssHooks[t]={get:function(e,i){if(i){var n=ii(e,t);return ui.test(n)?Q(e).position()[t]+"px":n}}}})}),Q.expr&&Q.expr.filters&&(Q.expr.filters.hidden=function(e){return 0===e.offsetWidth&&0===e.offsetHeight||!Q.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||ii(e,"display"))},Q.expr.filters.visible=function(e){return!Q.expr.filters.hidden(e)}),Q.each({margin:"",padding:"",border:"Width"},function(e,t){Q.cssHooks[e+t]={expand:function(i){var n,s="string"==typeof i?i.split(" "):[i],o={};for(n=0;4>n;n++)o[e+mi[n]+t]=s[n]||s[n-2]||s[0];return o}},ci.test(e)||(Q.cssHooks[e+t].set=y)});var yi=/%20/g,bi=/\[\]$/,xi=/\r?\n/g,wi=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,ki=/^(?:select|textarea)/i;Q.fn.extend({serialize:function(){return Q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?Q.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||ki.test(this.nodeName)||wi.test(this.type))}).map(function(e,t){var i=Q(this).val();return null==i?null:Q.isArray(i)?Q.map(i,function(e){return{name:t.name,value:e.replace(xi,"\r\n")}}):{name:t.name,value:i.replace(xi,"\r\n")}}).get()}}),Q.param=function(e,i){var n,s=[],o=function(e,t){t=Q.isFunction(t)?t():null==t?"":t,s[s.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(i===t&&(i=Q.ajaxSettings&&Q.ajaxSettings.traditional),Q.isArray(e)||e.jquery&&!Q.isPlainObject(e))Q.each(e,function(){o(this.name,this.value)});else for(n in e)k(n,e[n],i,o);return s.join("&").replace(yi,"+")};var Mi,Ti,Ci=/#.*$/,Ei=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Pi=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,zi=/^(?:GET|HEAD)$/,Di=/^\/\//,Si=/\?/,Ii=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Ni=/([?&])_=[^&]*/,Ai=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Li=Q.fn.load,Oi={},Ri={},ji=["*/"]+["*"];try{Ti=B.href}catch(Hi){Ti=W.createElement("a"),Ti.href="",Ti=Ti.href}Mi=Ai.exec(Ti.toLowerCase())||[],Q.fn.load=function(e,i,n){if("string"!=typeof e&&Li)return Li.apply(this,arguments);if(!this.length)return this;var s,o,r,a=this,l=e.indexOf(" ");return l>=0&&(s=e.slice(l,e.length),e=e.slice(0,l)),Q.isFunction(i)?(n=i,i=t):i&&"object"==typeof i&&(o="POST"),Q.ajax({url:e,type:o,dataType:"html",data:i,complete:function(e,t){n&&a.each(n,r||[e.responseText,t,e])}}).done(function(e){r=arguments,a.html(s?Q("<div>").append(e.replace(Ii,"")).find(s):e)}),this},Q.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){Q.fn[t]=function(e){return this.on(t,e)}}),Q.each(["get","post"],function(e,i){Q[i]=function(e,n,s,o){return Q.isFunction(n)&&(o=o||s,s=n,n=t),Q.ajax({type:i,url:e,data:n,success:s,dataType:o})}}),Q.extend({getScript:function(e,i){return Q.get(e,t,i,"script")},getJSON:function(e,t,i){return Q.get(e,t,i,"json")},ajaxSetup:function(e,t){return t?C(e,Q.ajaxSettings):(t=e,e=Q.ajaxSettings),C(e,t),e},ajaxSettings:{url:Ti,isLocal:Pi.test(Mi[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":ji},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":Q.parseJSON,"text xml":Q.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:M(Oi),ajaxTransport:M(Ri),ajax:function(e,i){function n(e,i,n,r){var c,u,_,y,x,k=i;2!==b&&(b=2,l&&clearTimeout(l),a=t,o=r||"",w.readyState=e>0?4:0,n&&(y=E(p,w,n)),e>=200&&300>e||304===e?(p.ifModified&&(x=w.getResponseHeader("Last-Modified"),x&&(Q.lastModified[s]=x),x=w.getResponseHeader("Etag"),x&&(Q.etag[s]=x)),304===e?(k="notmodified",c=!0):(c=P(p,y),k=c.state,u=c.data,_=c.error,c=!_)):(_=k,(!k||e)&&(k="error",0>e&&(e=0))),w.status=e,w.statusText=(i||k)+"",c?g.resolveWith(d,[u,k,w]):g.rejectWith(d,[w,k,_]),w.statusCode(v),v=t,h&&f.trigger("ajax"+(c?"Success":"Error"),[w,p,c?u:_]),m.fireWith(d,[w,k]),h&&(f.trigger("ajaxComplete",[w,p]),--Q.active||Q.event.trigger("ajaxStop")))}"object"==typeof e&&(i=e,e=t),i=i||{};var s,o,r,a,l,c,h,u,p=Q.ajaxSetup({},i),d=p.context||p,f=d!==p&&(d.nodeType||d instanceof Q)?Q(d):Q.event,g=Q.Deferred(),m=Q.Callbacks("once memory"),v=p.statusCode||{},_={},y={},b=0,x="canceled",w={readyState:0,setRequestHeader:function(e,t){if(!b){var i=e.toLowerCase();e=y[i]=y[i]||e,_[e]=t}return this},getAllResponseHeaders:function(){return 2===b?o:null},getResponseHeader:function(e){var i;if(2===b){if(!r)for(r={};i=Ei.exec(o);)r[i[1].toLowerCase()]=i[2];i=r[e.toLowerCase()]}return i===t?null:i
},overrideMimeType:function(e){return b||(p.mimeType=e),this},abort:function(e){return e=e||x,a&&a.abort(e),n(0,e),this}};if(g.promise(w),w.success=w.done,w.error=w.fail,w.complete=m.add,w.statusCode=function(e){if(e){var t;if(2>b)for(t in e)v[t]=[v[t],e[t]];else t=e[w.status],w.always(t)}return this},p.url=((e||p.url)+"").replace(Ci,"").replace(Di,Mi[1]+"//"),p.dataTypes=Q.trim(p.dataType||"*").toLowerCase().split(tt),null==p.crossDomain&&(c=Ai.exec(p.url.toLowerCase())||!1,p.crossDomain=c&&c.join(":")+(c[3]?"":"http:"===c[1]?80:443)!==Mi.join(":")+(Mi[3]?"":"http:"===Mi[1]?80:443)),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=Q.param(p.data,p.traditional)),T(Oi,p,i,w),2===b)return w;if(h=p.global,p.type=p.type.toUpperCase(),p.hasContent=!zi.test(p.type),h&&0===Q.active++&&Q.event.trigger("ajaxStart"),!p.hasContent&&(p.data&&(p.url+=(Si.test(p.url)?"&":"?")+p.data,delete p.data),s=p.url,p.cache===!1)){var k=Q.now(),M=p.url.replace(Ni,"$1_="+k);p.url=M+(M===p.url?(Si.test(p.url)?"&":"?")+"_="+k:"")}(p.data&&p.hasContent&&p.contentType!==!1||i.contentType)&&w.setRequestHeader("Content-Type",p.contentType),p.ifModified&&(s=s||p.url,Q.lastModified[s]&&w.setRequestHeader("If-Modified-Since",Q.lastModified[s]),Q.etag[s]&&w.setRequestHeader("If-None-Match",Q.etag[s])),w.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+ji+"; q=0.01":""):p.accepts["*"]);for(u in p.headers)w.setRequestHeader(u,p.headers[u]);if(p.beforeSend&&(p.beforeSend.call(d,w,p)===!1||2===b))return w.abort();x="abort";for(u in{success:1,error:1,complete:1})w[u](p[u]);if(a=T(Ri,p,i,w)){w.readyState=1,h&&f.trigger("ajaxSend",[w,p]),p.async&&p.timeout>0&&(l=setTimeout(function(){w.abort("timeout")},p.timeout));try{b=1,a.send(_,n)}catch(C){if(!(2>b))throw C;n(-1,C)}}else n(-1,"No Transport");return w},active:0,lastModified:{},etag:{}});var qi=[],Wi=/\?/,Bi=/(=)\?(?=&|$)|\?\?/,Fi=Q.now();Q.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=qi.pop()||Q.expando+"_"+Fi++;return this[e]=!0,e}}),Q.ajaxPrefilter("json jsonp",function(i,n,s){var o,r,a,l=i.data,c=i.url,h=i.jsonp!==!1,u=h&&Bi.test(c),p=h&&!u&&"string"==typeof l&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&Bi.test(l);return"jsonp"===i.dataTypes[0]||u||p?(o=i.jsonpCallback=Q.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,r=e[o],u?i.url=c.replace(Bi,"$1"+o):p?i.data=l.replace(Bi,"$1"+o):h&&(i.url+=(Wi.test(c)?"&":"?")+i.jsonp+"="+o),i.converters["script json"]=function(){return a||Q.error(o+" was not called"),a[0]},i.dataTypes[0]="json",e[o]=function(){a=arguments},s.always(function(){e[o]=r,i[o]&&(i.jsonpCallback=n.jsonpCallback,qi.push(o)),a&&Q.isFunction(r)&&r(a[0]),a=r=t}),"script"):void 0}),Q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return Q.globalEval(e),e}}}),Q.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),Q.ajaxTransport("script",function(e){if(e.crossDomain){var i,n=W.head||W.getElementsByTagName("head")[0]||W.documentElement;return{send:function(s,o){i=W.createElement("script"),i.async="async",e.scriptCharset&&(i.charset=e.scriptCharset),i.src=e.url,i.onload=i.onreadystatechange=function(e,s){(s||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,n&&i.parentNode&&n.removeChild(i),i=t,s||o(200,"success"))},n.insertBefore(i,n.firstChild)},abort:function(){i&&i.onload(0,1)}}}});var Ui,Gi=e.ActiveXObject?function(){for(var e in Ui)Ui[e](0,1)}:!1,Vi=0;Q.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&z()||D()}:z,function(e){Q.extend(Q.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(Q.ajaxSettings.xhr()),Q.support.ajax&&Q.ajaxTransport(function(i){if(!i.crossDomain||Q.support.cors){var n;return{send:function(s,o){var r,a,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields)for(a in i.xhrFields)l[a]=i.xhrFields[a];i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),i.crossDomain||s["X-Requested-With"]||(s["X-Requested-With"]="XMLHttpRequest");try{for(a in s)l.setRequestHeader(a,s[a])}catch(c){}l.send(i.hasContent&&i.data||null),n=function(e,s){var a,c,h,u,p;try{if(n&&(s||4===l.readyState))if(n=t,r&&(l.onreadystatechange=Q.noop,Gi&&delete Ui[r]),s)4!==l.readyState&&l.abort();else{a=l.status,h=l.getAllResponseHeaders(),u={},p=l.responseXML,p&&p.documentElement&&(u.xml=p);try{u.text=l.responseText}catch(e){}try{c=l.statusText}catch(d){c=""}a||!i.isLocal||i.crossDomain?1223===a&&(a=204):a=u.text?200:404}}catch(f){s||o(-1,f)}u&&o(a,c,u,h)},i.async?4===l.readyState?setTimeout(n,0):(r=++Vi,Gi&&(Ui||(Ui={},Q(e).unload(Gi)),Ui[r]=n),l.onreadystatechange=n):n()},abort:function(){n&&n(0,1)}}}});var $i,Xi,Yi=/^(?:toggle|show|hide)$/,Ki=new RegExp("^(?:([-+])=|)("+J+")([a-z%]*)$","i"),Zi=/queueHooks$/,Qi=[L],Ji={"*":[function(e,t){var i,n,s=this.createTween(e,t),o=Ki.exec(t),r=s.cur(),a=+r||0,l=1,c=20;if(o){if(i=+o[2],n=o[3]||(Q.cssNumber[e]?"":"px"),"px"!==n&&a){a=Q.css(s.elem,e,!0)||i||1;do l=l||".5",a/=l,Q.style(s.elem,e,a+n);while(l!==(l=s.cur()/r)&&1!==l&&--c)}s.unit=n,s.start=a,s.end=o[1]?a+(o[1]+1)*i:i}return s}]};Q.Animation=Q.extend(N,{tweener:function(e,t){Q.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,s=e.length;s>n;n++)i=e[n],Ji[i]=Ji[i]||[],Ji[i].unshift(t)},prefilter:function(e,t){t?Qi.unshift(e):Qi.push(e)}}),Q.Tween=O,O.prototype={constructor:O,init:function(e,t,i,n,s,o){this.elem=e,this.prop=i,this.easing=s||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=o||(Q.cssNumber[i]?"":"px")},cur:function(){var e=O.propHooks[this.prop];return e&&e.get?e.get(this):O.propHooks._default.get(this)},run:function(e){var t,i=O.propHooks[this.prop];return this.pos=t=this.options.duration?Q.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):O.propHooks._default.set(this),this}},O.prototype.init.prototype=O.prototype,O.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=Q.css(e.elem,e.prop,!1,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){Q.fx.step[e.prop]?Q.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[Q.cssProps[e.prop]]||Q.cssHooks[e.prop])?Q.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},O.propHooks.scrollTop=O.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Q.each(["toggle","show","hide"],function(e,t){var i=Q.fn[t];Q.fn[t]=function(n,s,o){return null==n||"boolean"==typeof n||!e&&Q.isFunction(n)&&Q.isFunction(s)?i.apply(this,arguments):this.animate(R(t,!0),n,s,o)}}),Q.fn.extend({fadeTo:function(e,t,i,n){return this.filter(v).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var s=Q.isEmptyObject(e),o=Q.speed(t,i,n),r=function(){var t=N(this,Q.extend({},e),o);s&&t.stop(!0)};return s||o.queue===!1?this.each(r):this.queue(o.queue,r)},stop:function(e,i,n){var s=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=i,i=e,e=t),i&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=Q.timers,r=Q._data(this);if(i)r[i]&&r[i].stop&&s(r[i]);else for(i in r)r[i]&&r[i].stop&&Zi.test(i)&&s(r[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));(t||!n)&&Q.dequeue(this,e)})}}),Q.each({slideDown:R("show"),slideUp:R("hide"),slideToggle:R("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Q.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),Q.speed=function(e,t,i){var n=e&&"object"==typeof e?Q.extend({},e):{complete:i||!i&&t||Q.isFunction(e)&&e,duration:e,easing:i&&t||t&&!Q.isFunction(t)&&t};return n.duration=Q.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in Q.fx.speeds?Q.fx.speeds[n.duration]:Q.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){Q.isFunction(n.old)&&n.old.call(this),n.queue&&Q.dequeue(this,n.queue)},n},Q.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},Q.timers=[],Q.fx=O.prototype.init,Q.fx.tick=function(){for(var e,t=Q.timers,i=0;i<t.length;i++)e=t[i],e()||t[i]!==e||t.splice(i--,1);t.length||Q.fx.stop()},Q.fx.timer=function(e){e()&&Q.timers.push(e)&&!Xi&&(Xi=setInterval(Q.fx.tick,Q.fx.interval))},Q.fx.interval=13,Q.fx.stop=function(){clearInterval(Xi),Xi=null},Q.fx.speeds={slow:600,fast:200,_default:400},Q.fx.step={},Q.expr&&Q.expr.filters&&(Q.expr.filters.animated=function(e){return Q.grep(Q.timers,function(t){return e===t.elem}).length});var en=/^(?:body|html)$/i;Q.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){Q.offset.setOffset(this,e,t)});var i,n,s,o,r,a,l,c={top:0,left:0},h=this[0],u=h&&h.ownerDocument;if(u)return(n=u.body)===h?Q.offset.bodyOffset(h):(i=u.documentElement,Q.contains(i,h)?("undefined"!=typeof h.getBoundingClientRect&&(c=h.getBoundingClientRect()),s=j(u),o=i.clientTop||n.clientTop||0,r=i.clientLeft||n.clientLeft||0,a=s.pageYOffset||i.scrollTop,l=s.pageXOffset||i.scrollLeft,{top:c.top+a-o,left:c.left+l-r}):c)},Q.offset={bodyOffset:function(e){var t=e.offsetTop,i=e.offsetLeft;return Q.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(Q.css(e,"marginTop"))||0,i+=parseFloat(Q.css(e,"marginLeft"))||0),{top:t,left:i}},setOffset:function(e,t,i){var n=Q.css(e,"position");"static"===n&&(e.style.position="relative");var s,o,r=Q(e),a=r.offset(),l=Q.css(e,"top"),c=Q.css(e,"left"),h=("absolute"===n||"fixed"===n)&&Q.inArray("auto",[l,c])>-1,u={},p={};h?(p=r.position(),s=p.top,o=p.left):(s=parseFloat(l)||0,o=parseFloat(c)||0),Q.isFunction(t)&&(t=t.call(e,i,a)),null!=t.top&&(u.top=t.top-a.top+s),null!=t.left&&(u.left=t.left-a.left+o),"using"in t?t.using.call(e,u):r.css(u)}},Q.fn.extend({position:function(){if(this[0]){var e=this[0],t=this.offsetParent(),i=this.offset(),n=en.test(t[0].nodeName)?{top:0,left:0}:t.offset();return i.top-=parseFloat(Q.css(e,"marginTop"))||0,i.left-=parseFloat(Q.css(e,"marginLeft"))||0,n.top+=parseFloat(Q.css(t[0],"borderTopWidth"))||0,n.left+=parseFloat(Q.css(t[0],"borderLeftWidth"))||0,{top:i.top-n.top,left:i.left-n.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||W.body;e&&!en.test(e.nodeName)&&"static"===Q.css(e,"position");)e=e.offsetParent;return e||W.body})}}),Q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var n=/Y/.test(i);Q.fn[e]=function(s){return Q.access(this,function(e,s,o){var r=j(e);return o===t?r?i in r?r[i]:r.document.documentElement[s]:e[s]:(r?r.scrollTo(n?Q(r).scrollLeft():o,n?o:Q(r).scrollTop()):e[s]=o,void 0)},e,s,arguments.length,null)}}),Q.each({Height:"height",Width:"width"},function(e,i){Q.each({padding:"inner"+e,content:i,"":"outer"+e},function(n,s){Q.fn[s]=function(s,o){var r=arguments.length&&(n||"boolean"!=typeof s),a=n||(s===!0||o===!0?"margin":"border");return Q.access(this,function(i,n,s){var o;return Q.isWindow(i)?i.document.documentElement["client"+e]:9===i.nodeType?(o=i.documentElement,Math.max(i.body["scroll"+e],o["scroll"+e],i.body["offset"+e],o["offset"+e],o["client"+e])):s===t?Q.css(i,n,s,a):Q.style(i,n,s,a)},i,r?s:t,r,null)}})}),e.jQuery=e.$=Q,"function"==typeof mmf_mapping_api.define&&mmf_mapping_api.define.amd&&mmf_mapping_api.define.amd.jQuery&&mmf_mapping_api.define("jquery",[],function(){return Q})}(window),mmf_mapping_api.define("jquery.nc",["jquery"],function(){return window.jQuery.noConflict(!0)}),mmf_mapping_api.define("libs/polyfill",[],function(){Date.now||(Date.now=function(){return(new Date).valueOf()})}),mmf_mapping_api.define("pubsub",[],function(){var e={};return function(e){e.version="1.0.1";var t={},i=-1,n=function(e,i,n){if(!t.hasOwnProperty(e))return!1;var s=function(){for(var n=t[e],s=function(e){return function(){throw e}},o=0,r=n.length;r>o;o++)try{n[o].func(e,i)}catch(a){setTimeout(s(a),0)}};return n===!0?s():setTimeout(s,0),!0};e.publish=function(e,t){return n(e,t,!1)},e.publishSync=function(e,t){return n(e,t,!0)},e.subscribe=function(e,n){t.hasOwnProperty(e)||(t[e]=[]);var s=(++i).toString();return t[e].push({token:s,func:n}),s},e.unsubscribe=function(e){for(var i in t)if(t.hasOwnProperty(i))for(var n=0,s=t[i].length;s>n;n++)if(t[i][n].token===e)return t[i].splice(n,1),e;return!1}}(e),e}),mmf_mapping_api.define("logger",["dynamic_constants"],function(e){var t=function(){},i=function(){return window.console&&e.debug?window.console:function(){var e,i,n={};for(e=0,i=arguments.length;i>e;e++)arguments.hasOwnProperty(e)&&(n[arguments[e]]=t);return n}("log","debug","info","warn","exception","assert","dir","dirxml","trace","group","groupEnd","groupCollapsed","profile","profileEnd","count","clear","time","timeEnd","timeStamp","table","error","memoryProfile","memoryProfileEnd")}();return i}),mmf_mapping_api.define("constants",["jquery","dynamic_constants","logger"],function(e,t,i){var n={CREATE:"CREATE",EDIT:"EDIT",VIEW:"VIEW"},s={ROAD:"ROAD",HYBRID:"HYBRID",SATELLITE:"SATELLITE",TERRAIN:"TERRAIN",TRAFFIC:"TRAFFIC",USA_TOPO:"USA_TOPO",WORLD_TOPO:"WORLD_TOPO"},o={BICYCLING:"BICYCLING",DIRECT:"DIRECT",DRIVING:"DRIVING",WALKING:"WALKING"},r={IMPERIAL:"IMPERIAL",METRIC:"METRIC"},a={SMALL:"SMALL",LARGE:"LARGE"},l={australia:{type:"Polygon",coordinates:[[[130.078125,-9.362352822055593],[108.896484375,-20.632784250388013],[111.62109375,-36.10237644873643],[146.689453125,-45.151053265563384],[156.62109375,-37.37015718405751],[157.060546875,-24.44714958973082],[144.31640625,-9.88227549342994],[139.833984375,-9.709057068618208],[130.078125,-9.362352822055593]]]},austria:{type:"Polygon",coordinates:[[[9.521026611328125,47.5366741201253],[9.625396728515625,47.404855836246135],[9.518280029296875,47.27317275941787],[9.560165405273438,47.16730970131578],[9.62127685546875,47.12854928541983],[9.59930419921875,47.039246258977784],[9.8602294921875,46.99992422991225],[9.869842529296875,46.92306917905251],[10.107421874999998,46.830133640447386],[10.241317749023438,46.86113003765812],[10.393753051757812,46.982594624734936],[10.472030639648438,46.84140712700584],[10.689697265625,46.81932766316868],[10.740509033203125,46.76902781837645],[11.03851318359375,46.75303484681343],[11.19232177734375,46.95119968771708],[11.764984130859375,46.95682401609411],[12.1893310546875,47.07012182383309],[12.09869384765625,47.00460694243501],[12.139892578125,46.89398546092549],[12.350006103515625,46.71350244599995],[12.56011962890625,46.632464724627475],[14.585723876953123,46.36304070990861],[15.09521484375,46.63057868059483],[15.47698974609375,46.60228013300284],[16.06475830078125,46.64377960861833],[16.173248291015625,46.880845705719125],[16.54266357421875,47.00647991252098],[16.5234375,47.32393057095941],[16.684112548828125,47.4596655525415],[16.732177734375,47.55057928124212],[16.65252685546875,47.64226084847303],[16.461639404296875,47.667237034505156],[16.65390014648437,47.72362073407563],[16.751403808593746,47.65706299337809],[17.1112060546875,47.692201274744136],[17.178497314453125,48.01381248943335],[16.9024658203125,48.36811076994179],[16.97662353515625,48.54297797016485],[16.931304931640625,48.761620642037315],[16.435546875,48.83850916871952],[16.379241943359375,48.77429274267509],[15.049896240234373,49.06306925171648],[14.942779541015627,48.9991410647952],[14.940032958984375,48.84302835299516],[14.749145507812498,48.77248263837077],[14.679107666015623,48.62655511310286],[14.455261230468748,48.66012869453836],[14.23004150390625,48.59840868861914],[13.842773437499998,48.80505453139158],[13.787841796875,48.71361871872025],[13.80775451660156,48.61974693309107],[13.725357055664062,48.55388717497782],[13.42254638671875,48.61112192003074],[13.392333984375,48.39456162202509],[13.02703857421875,48.28502057399577],[12.70294189453125,48.12943437745315],[12.95562744140625,47.857402894658236],[12.88421630859375,47.719001413201916],[13.0572509765625,47.64596177800046],[12.995452880859375,47.517200697839414],[12.751007080078125,47.703292658431074],[12.53265380859375,47.68110753158711],[12.25250244140625,47.76702233051035],[12.052001953125,47.645036570200226],[11.62353515625,47.60338525714934],[11.2664794921875,47.44016355242185],[11.023406982421875,47.42808726171425],[10.908050537109375,47.544090665057986],[10.4315185546875,47.615421267605434],[10.355987548828123,47.385333517742595],[9.812850952148438,47.62328946917188],[9.521026611328125,47.5366741201253]]]},belgium:{type:"Polygon",coordinates:[[[3.9427185058593746,51.230107818179434],[3.2752990722656246,51.39834886240482],[2.509002685546875,51.17503830237217],[2.5982666015625,50.817215413611876],[2.882537841796875,50.6788392166178],[3.1256103515625,50.775550104554206],[3.311004638671875,50.48023052012273],[3.5575103759765625,50.48722109174841],[3.698272705078125,50.29855117371406],[4.1013336181640625,50.30206000758937],[4.1370391845703125,49.94370846987907],[4.453582763671875,49.928240054369226],[4.7083282470703125,49.99670534410904],[4.83123779296875,50.14302605624561],[4.78179931640625,49.960055395800424],[4.842224121093749,49.79146054329162],[5.500030517578124,49.479278572130205],[5.869445800781249,49.54793430984823],[5.9223175048828125,49.666294571030924],[5.7808685302734375,49.85967737389903],[6.0088348388671875,50.15314620005649],[6.139984130859375,50.123219580802434],[6.45721435546875,50.34896578114507],[6.228561401367187,50.71472159831894],[5.69091796875,50.82502352402512],[5.898284912109375,51.15006324988587],[4.961700439453125,51.53266860674158],[4.40277099609375,51.484803739516046],[3.9427185058593746,51.230107818179434]]]},denmark:{type:"Polygon",coordinates:[[[10.65673828125,57.87105329209309],[8.14361572265625,57.16156769167336],[7.921142578125,55.22275708802209],[8.610534667968748,55.015425940562984],[8.602294921875,54.90819859298938],[9.342498779296875,54.78960100515044],[9.438629150390625,54.82917227452137],[9.614410400390625,54.886876752158955],[9.625396728515625,54.841826896550494],[10.031890869140625,54.80701713846256],[11.86798095703125,54.46684525346424],[12.733154296875,54.91924991842267],[15.292968749999998,54.955540054617266],[15.268249511718752,55.36038057233305],[12.6837158203125,55.21022218832888],[12.85400390625,55.72092280778698],[12.6397705078125,55.89148608452775],[12.645263671875,56.05056742320484],[10.65673828125,57.87105329209309]]]},finland:{type:"Polygon",coordinates:[[[21.4068603515625,59.53710304208549],[20.709228515625,60.89705259731161],[20.4345703125,63.15435519659187],[24.093017578125,65.78926365865432],[23.389892578124996,66.45188654545449],[22.950439453125,68.06920186081591],[20.423583984375,69.06856318696033],[21.533203125,69.4421276134176],[22.763671875,68.82386587133152],[25.169677734375,68.92286088652776],[25.42236328125,69.3570863282203],[26.663818359375,70.30393290852346],[29.739990234374996,69.85476220252649],[29.0478515625,69.04500130183706],[28.729248046875,68.44766195833505],[30.278320312499996,67.65938637009882],[29.300537109374996,66.93006025862448],[30.25634765625,65.87472467098549],[30.7177734375,64.19203205665097],[30.41015625,63.636503596184795],[32.025146484375,62.92523566254294],[27.740478515625,60.27251459483244],[21.4068603515625,59.53710304208549]]]},france:{type:"Polygon",coordinates:[[[6.7950439453125,49.39309989350566],[5.064697265625,49.84506757956392],[4.894409179687499,50.25071752130677],[4.50439453125,50.152266272562684],[2.43896484375,51.227527905265006],[-5.899658203125,48.567520373908295],[-1.9555664062500002,43.34914966389313],[-1.329345703125,42.93229601903058],[.2911376953125,42.5733097370664],[1.549072265625,42.581399679665054],[2.098388671875,42.26917949243506],[3.3233642578125,42.374778361114195],[8.690185546875,41.269549502842565],[9.6185302734375,41.347948493443546],[9.6240234375,43.02874525134882],[7.657470703124999,43.723474896114794],[7.8167724609375,44.13885576756881],[7.1356201171875,44.77013681219717],[7.3004150390625,45.61403741135093],[6.85821533203125,46.437856895024204],[6.5753173828125,46.78501604269254],[7.701416015625001,47.59875528481801],[8.316650390625,48.99824008113872],[6.7950439453125,49.39309989350566]]]},germany:{type:"Polygon",coordinates:[[[8.368835449218748,55.07836723201515],[8.2342529296875,54.88924640307589],[7.965087890625,53.86710508973725],[6.5093994140625,53.621837552541365],[7.1466064453125,53.247138717452785],[7.187805175781251,52.980069558305566],[7.05596923828125,52.83927653705786],[7.03125,52.654727851062205],[6.701660156249999,52.66638915420003],[6.653594970703125,52.4752525720828],[6.994171142578125,52.4158226123788],[6.991424560546875,52.24041522350549],[6.639862060546875,52.067688721304194],[6.778564453125,51.96542325321787],[6.101531982421875,51.916320535122736],[5.91888427734375,51.82644216600321],[6.076812744140625,51.302286669881575],[5.8282470703125,51.03275840574761],[6.149597167968749,50.484599748567774],[6.090545654296875,49.95563785488376],[6.387176513671875,49.77594330087988],[6.326751708984375,49.459198634468564],[6.741485595703125,49.14039340493346],[7.915649414062499,48.97300592158682],[7.305908203125,47.52461999690649],[9.90142822265625,47.50050343862717],[10.21453857421875,47.202776377962714],[12.2332763671875,47.5561403129434],[13.24127197265625,47.41879592147274],[12.89520263671875,48.125767833701666],[13.46923828125,48.356249029540734],[13.48846435546875,48.54752375797609],[13.8372802734375,48.472921272487824],[13.89495849609375,48.828565527993234],[12.744140625,49.48240137826932],[12.4859619140625,49.7475560605478],[12.601318359374998,49.93177612998566],[12.2772216796875,50.127621728300475],[14.403076171875,50.878777255570405],[14.823303222656248,50.776418510713604],[15.125427246093748,51.28081671677971],[14.696960449218748,51.817104876426534],[14.80133056640625,52.07106540690666],[14.664001464843752,52.6030475337285],[14.227294921875,52.8823912222619],[14.503326416015625,53.227412682397365],[14.231414794921875,53.85090645475559],[14.2437744140625,54.22108779704994],[13.46923828125,54.97761367069628],[11.788330078125,54.438102809740165],[10.030517578125,54.82759016780595],[8.368835449218748,55.07836723201515]]]},ireland:{type:"Polygon",coordinates:[[[-10.21728515625,55.37911044801047],[-11.25,51.316880504045876],[-6.8115234375,50.83369767098071],[-5.064697265625,54.49556752187406],[-6.163330078125,55.472626905474975],[-10.21728515625,55.37911044801047]]]},liechtenstein:{type:"Polygon",coordinates:[[[9.623336791992188,47.15306970082402],[9.579048156738281,47.1764119638557],[9.587974548339842,47.20814098211431],[9.559822082519531,47.22749569440931],[9.571151733398438,47.246610279847],[9.529953002929688,47.27596803469641],[9.479141235351562,47.18877920473518],[9.512100219726562,47.089994354627954],[9.465236663818358,47.06638028321398],[9.475021362304686,47.04626500255331],[9.540252685546873,47.06076747983352],[9.55810546875,47.04556316974868],[9.609088897705078,47.05983195515023],[9.638099670410156,47.082981366598545],[9.639816284179688,47.12971718068695],[9.623336791992188,47.15306970082402]]]},luxenbourg:{type:"Polygon",coordinates:[[[6.168479919433594,50.01568168937738],[6.129341125488281,50.169202032633315],[5.965232849121094,50.19470431804092],[5.71014404296875,49.908787000867136],[5.805931091308594,49.54102851586054],[5.861549377441406,49.49645154151805],[5.9635162353515625,49.48976149051453],[5.9765625,49.44915557905232],[6.097068786621094,49.44491456001265],[6.197319030761718,49.50291772165853],[6.3775634765625,49.45428895336522],[6.370697021484375,49.53412174576703],[6.52313232421875,49.71870825603935],[6.538925170898437,49.814948620925776],[6.277313232421875,49.89662485669816],[6.168479919433594,50.01568168937738]]]},netherlands:{type:"Polygon",coordinates:[[[6.43798828125,53.608803292930865],[6.854095458984375,53.49049675052435],[7.012023925781249,53.3284125525758],[7.274322509765624,53.2865635206158],[7.1356201171875,52.26311463698562],[6.8280029296875,51.900223473309865],[6.3775634765625,51.795027225829145],[6.075439453125,50.706895056357254],[5.60302734375,50.726024296594694],[5.635986328124999,51.16212186002124],[4.592285156249999,51.40434606342361],[3.9440917968749996,51.18967256411778],[3.39202880859375,51.22924786327828],[3.2464599609375,51.39749205520681],[3.9056396484374996,51.998410382390325],[4.6856689453125,53.39806981341725],[6.43798828125,53.608803292930865]]]},new_zealand:{type:"Polygon",coordinates:[[[172.0458984375,-32.916485347314385],[179.966796875,-37.37015718405751],[170.0244140625,-48.63290858589533],[162.6416015625,-45.85941212790755],[172.0458984375,-32.916485347314385]]]},norway:{type:"Polygon",coordinates:[[[11.0797119140625,58.96771178785986],[11.346130371093748,59.09067695849205],[11.453247070312498,58.87271447569953],[11.67022705078125,58.877683492290046],[11.808929443359373,59.10055160339275],[11.874847412109375,59.27079306340808],[11.71966552734375,59.60109549032134],[11.98883056640625,59.676755268826966],[11.91192626953125,59.85171278693749],[12.19482421875,59.87997934503246],[12.481842041015625,60.013402975695676],[12.583465576171875,60.19752087731289],[12.643890380859375,60.52688764987142],[12.264862060546875,61.00906956605986],[12.738647460937498,61.03568218719177],[12.92816162109375,61.41775026352097],[12.19757080078125,61.75233128411639],[12.34039306640625,62.28197831765088],[12.12615966796875,62.592076543359155],[12.2662353515625,63.00264026703044],[12.06573486328125,63.26947621713553],[12.43377685546875,63.658448979940175],[12.963867187499998,64.03013598382323],[14.14764404296875,63.98800889340481],[14.21356201171875,64.45029596673545],[13.7713623046875,64.58146958015028],[14.65301513671875,65.35767693905089],[14.628295898437498,66.10939434182254],[15.19134521484375,66.14274269640396],[15.595092773437498,66.27569825946966],[15.43853759765625,66.47163034690892],[16.5618896484375,67.09310451852075],[16.171875,67.44649648365615],[16.6278076171875,67.56943027840946],[16.820068359375,67.89828740812499],[17.325439453125,68.04867651098903],[17.918701171875,67.93752374612306],[18.1988525390625,68.1889100101818],[18.17962646484375,68.5222019155703],[19.9566650390625,68.32423359706061],[20.2972412109375,68.49201265997922],[20.38787841796875,68.80699265931747],[20.27801513671875,69.03714171275197],[21.074523925781246,69.01256234859217],[21.37115478515625,69.28142765324579],[22.362670898437496,68.70348876730434],[23.161926269531246,68.60952260774869],[24.04632568359375,68.75430558015785],[24.914245605468746,68.53326119104918],[25.76568603515625,68.90111994948766],[25.94970703125,69.48740998234473],[26.5155029296875,69.8878435403709],[27.22137451171875,69.90766734108514],[27.806396484374996,70.05340748054604],[29.12750244140625,69.49799419286717],[28.685302734375,69.10483819020249],[29.067077636718754,68.99090974637402],[30.006408691406254,69.40254788418564],[30.992431640624996,69.54795793029342],[31.530761718750004,71.28317384014207],[23.18115234375,71.26200981957902],[9.876708984375,67.96227048518728],[9.085693359375,64.32563188307633],[3.878173828125,62.057585678251044],[4.383544921875,59.10266722885383],[7.0751953125,57.55120803456645],[11.0797119140625,58.96771178785986]]]},poland:{type:"Polygon",coordinates:[[[19.7259521484375,54.45407332522336],[18.1494140625,54.92714186454645],[14.128417968749998,54.16484603944897],[14.3206787109375,53.122053572577755],[14.0130615234375,52.8823912222619],[14.56512451171875,52.54128465552713],[14.490966796875,52.35715118125811],[14.677734375000002,52.02376856867204],[14.55413818359375,51.83068574881732],[14.6612548828125,51.52241608253253],[14.974365234375,51.2928411273273],[14.79583740234375,50.85624291019714],[15.95489501953125,50.588468205090265],[16.630554199218746,50.0536119068041],[17.22930908203125,50.28056433749239],[17.852783203125,49.947685259857685],[18.476257324218746,49.85746405258426],[18.96514892578125,49.37164333826142],[19.55841064453125,49.42884000063522],[19.7479248046875,49.163746759588975],[20.0665283203125,49.154766002922],[20.5718994140625,49.34480946815268],[20.9344482421875,49.26063518364424],[21.48101806640625,49.37164333826142],[22.8900146484375,48.94054322456003],[22.9559326171875,49.08466020484928],[22.785644531249996,49.57154029531499],[23.7799072265625,50.327929664466296],[24.1259765625,50.41551870402678],[24.19189453125,50.885708708915175],[23.66455078125,51.64870258356996],[23.7469482421875,52.07950600379697],[23.4063720703125,52.395715477302105],[24.169921875,52.75624323962823],[23.6810302734375,53.64138139745019],[23.4613037109375,54.41253702796794],[19.7259521484375,54.45407332522336]]]},sweden:{type:"Polygon",coordinates:[[[11.1016845703125,58.99884797374721],[10.799560546875,58.9216636365964],[12.48321533203125,56.13636792495876],[12.641143798828125,56.04519854325352],[12.60955810546875,55.971492770905385],[12.84027099609375,55.61403788302196],[12.7166748046875,55.244683663497284],[14.974365234375,55.41030721005218],[20.753173828125,57.74521321629189],[19.01458740234375,60.56402872337604],[20.291748046875,63.203925767041305],[24.158935546875,65.59026062114503],[24.182281494140625,65.87584726543369],[23.92410278320312,66.16994466913111],[23.67279052734375,66.4238894129363],[23.92547607421875,66.58649165389609],[24.020233154296875,66.84164716011712],[23.642578125,67.13582938531948],[23.85406494140625,67.42963546436422],[23.523101806640625,67.48281243935213],[23.675537109375,67.96123989783754],[22.91473388671875,68.39918004344189],[22.093505859375,68.5262240982048],[21.014099121093746,68.92878652100865],[20.7421875,69.07150664285697],[20.02532958984375,69.05089414674441],[20.25604248046875,68.91396945245388],[20.23956298828125,68.74036739342414],[19.9072265625,68.55536346700414],[20.14892578125,68.48294800362784],[19.90447998046875,68.37793656639465],[18.984375,68.53024556319521],[18.64105224609375,68.5211962577671],[18.4130859375,68.59549387924933],[18.094482421875,68.55335506553497],[17.8912353515625,68.00551382415148],[17.27325439453125,68.13169154145562],[16.6937255859375,67.92307595814992],[16.39434814453125,67.55789951540419],[16.100463867187496,67.54006818806145],[16.0345458984375,67.42225501238764],[16.32568359375,67.20190391904293],[16.336669921875,67.09096629343075],[15.2984619140625,66.50888160186885],[15.4193115234375,66.29558128935314],[14.474487304687498,66.13829878264829],[14.5404052734375,65.82978060097157],[14.295959472656248,65.17726545606858],[13.590087890625,64.55552125118271],[14.0625,64.44200262240287],[13.963623046874998,64.05177661560711],[12.9583740234375,64.12259218122024],[12.268981933593748,63.76063664076408],[11.865234375,63.27071158919724],[12.087707519531248,63.05495931065107],[11.986083984375,62.57816583754086],[12.2442626953125,62.27431239193089],[12.0849609375,61.70810250841183],[12.80181884765625,61.34407840195394],[12.6397705078125,61.075559284479844],[12.1728515625,61.03701223240187],[12.54913330078125,60.45992621736877],[12.480468749999998,60.33238607249709],[12.44476318359375,60.06484046010452],[11.81304931640625,59.85033331585688],[11.88446044921875,59.71625259267529],[11.678466796874998,59.62610290569049],[11.74713134765625,59.18155722094256],[11.537017822265625,58.903227163441926],[11.362609863281248,59.12593049491497],[11.1566162109375,59.074448154665866],[11.1016845703125,58.99884797374721]]]},switzerland:{type:"Polygon",coordinates:[[[8.408660888671875,46.437856895024204],[8.4210205078125,46.244451065485094],[8.75335693359375,46.02462129598765],[8.89617919921875,45.829756159282766],[9.043121337890625,45.80199916666152],[9.106292724609375,45.90243298453263],[9.018402099609375,45.96737907991119],[9.152984619140625,46.14178273759234],[9.2559814453125,46.2102496001872],[9.3768310546875,46.45583535762056],[9.578704833984375,46.240651955001695],[9.908294677734375,46.354510837365254],[10.051116943359375,46.20739851617005],[10.21453857421875,46.218801964311396],[10.133514404296875,46.5635815342227],[10.460357666015625,46.514460648524775],[10.53863525390625,46.619261036171515],[10.427398681640625,46.65791988638765],[10.512542724609375,46.948387301863534],[10.380706787109375,47.01490746524705],[10.1019287109375,46.874274621077795],[9.898681640625,47.03269459852135],[9.523773193359375,47.0747983802725],[9.537506103515625,47.2512713278804],[9.7119140625,47.3834738721015],[9.60479736328125,47.50514209901774],[9.5306396484375,47.595977104737685],[8.58856201171875,47.82698618879922],[8.34136962890625,47.71345768748889],[6.94061279296875,47.49493650511712],[6.098785400390625,46.58906908309182],[5.953216552734374,46.22450280046105],[5.938110351562499,46.10561307998295],[6.315765380859374,46.16936992120204],[6.326751708984375,46.38009646028785],[6.714019775390625,46.42933871009928],[6.81427001953125,46.28432584258847],[6.77032470703125,46.159858661486396],[6.85821533203125,46.05417324177816],[7.12188720703125,45.82210043976411],[7.591552734375,45.95401404268097],[7.797546386718749,45.89861025728346],[7.987060546875,45.933960441921585],[8.408660888671875,46.437856895024204]]]},united_kingdom:{type:"Polygon",coordinates:[[[1.329345703125,50.8822431111397],[-6.536865234375,49.360911547126165],[-5.8062744140625,53.89948354993688],[-6.2896728515625,54.11013788749546],[-6.38580322265625,54.05374516606874],[-6.6357421875,54.03277977858892],[-6.68243408203125,54.07389422020433],[-6.65771484375,54.165650031996904],[-6.686553955078124,54.18936078453946],[-6.763458251953125,54.16645400892218],[-7.0250701904296875,54.41173784028463],[-7.169952392578124,54.29729354239265],[-7.1198272705078125,54.226707764386695],[-7.218704223632812,54.20382168527194],[-7.269515991210937,54.10933281663397],[-7.581939697265625,54.120602386175754],[-7.70965576171875,54.19217302263812],[-7.816085815429687,54.19498506941805],[-7.870330810546875,54.21586857094935],[-7.888183593749999,54.286072069512265],[-7.974700927734375,54.303704439898084],[-8.202667236328125,54.46684525346424],[-8.06396484375,54.50035260560782],[-8.0145263671875,54.55374799334928],[-7.8614044189453125,54.54618125397205],[-7.7838134765625,54.599118960884304],[-7.960281372070312,54.67343392473607],[-7.859344482421875,54.753557461315864],[-7.754974365234376,54.71351548400387],[-7.483749389648437,54.83668643482999],[-7.458343505859375,54.944498697428536],[-7.3889923095703125,55.046122177308106],[-7.2310638427734375,55.07561561944124],[-6.854095458984375,55.24820644997961],[-9.865722656249998,58.57398108438837],[-.68115234375,60.994423108456154],[3.01025390625,53.14677033085084],[1.329345703125,50.8822431111397]]]},us_alaska:{type:"Polygon",coordinates:[[[-141.064453125,71.69129271863999],[-157.58789062499997,71.5944122077672],[-167.958984375,68.72044056989829],[-168.75,65.01650627048231],[-168.6181640625,60.75915950226991],[-165.7177734375,54.03358633521085],[-130.2099609375,54.39335222384589],[-129.814453125,55.27911529201561],[-129.990234375,56.072035471800866],[-131.0009765625,56.511017504952136],[-131.748046875,56.80087831233043],[-133.6376953125,58.63121664342478],[-135.4833984375,59.88893689676585],[-136.6259765625,59.7563950493563],[-137.373046875,59.06315402462662],[-138.33984375,59.82273188377389],[-139.04296875,60.1524422143808],[-139.130859375,60.50052541051131],[-140.9326171875,60.4788788301667],[-141.064453125,71.69129271863999]]]},us_continental:{type:"Polygon",coordinates:[[[-117.53173828125,32.34284135639302],[-120.73974609374999,34.397844946449865],[-123.0908203125,37.94419750075404],[-124.51904296875,40.34654412118006],[-124.73876953125,42.827638636242284],[-125.63964843750001,48.879167148960214],[-122.9150390625,49.167338606291075],[-94.89990234375,49.56797785892715],[-92.2412109375,48.61838518688487],[-89.56054687499999,48.21003212234042],[-88.22021484375,48.44377831058805],[-84.462890625,46.89023157359399],[-82.37548828125,45.42929873257377],[-81.7822265625,43.43696596521823],[-81.67236328125,43.24520272203356],[-79.9365234375,43.96119063892024],[-76.728515625,44.37098696297173],[-75.08056640625,45.13555516012536],[-71.87255859375,45.22848059584359],[-71.12548828125,45.583289756006316],[-69.43359375,47.5913464767971],[-68.35693359375,47.56170075451973],[-67.5439453125,46.89023157359399],[-67.4560546875,45.93587062119052],[-66.86279296875,45.213003555993964],[-66.9287109375,44.19795903948531],[-70.24658203125,43.068887774169625],[-69.41162109375,41.393294288784865],[-69.78515625,41.02964338716638],[-73.212890625,40.29628651711716],[-74.33349609375,38.272688535980976],[-75.30029296875,36.96744946416934],[-75.0146484375,35.31736632923788],[-75.6298828125,34.70549341022547],[-79.65087890624999,32.287132632616384],[-80.70556640625,31.391157522824695],[-80.85937499999999,30.221101852485987],[-80.09033203125,28.43971381702788],[-81.40869140625,24.126701958681668],[-83.16650390625,24.26699728841817],[-96.591796875,25.819671943904044],[-97.6025390625,25.819671943904044],[-99.052734375,26.37218544169559],[-99.86572265625,27.508271413876017],[-101.49169921875,29.630771207229024],[-102.32666015625,29.630771207229024],[-103.623046875,28.863918426224537],[-104.69970703125,29.6880527498568],[-105.09521484375,30.4297295750316],[-106.50146484374999,31.57853542647338],[-108.10546875,31.672083485607402],[-108.10546875,31.20340495091737],[-111.15966796875,31.20340495091737],[-114.85107421875,32.39851580247402]]]},us_hawaii:{type:"Polygon",coordinates:[[[-160.916748046875,18.3858049312974],[-160.916748046875,22.50240745949775],[-154.324951171875,22.50240745949775],[-154.324951171875,18.3858049312974],[-160.916748046875,18.3858049312974]]]}},c={isValidApiMode:function(e){return n.hasOwnProperty(e.toUpperCase())
},isValidTravelMode:function(e){return o.hasOwnProperty(e.toUpperCase())},isValidUnitSystem:function(e){return r.hasOwnProperty(e.toUpperCase())},apiAuthString:["consumer_key=",t.consumer_key,"&signed_token=",t.signed_token,"&site=",t.site.toLowerCase()].join(""),api_modes:n,debug:t.debug,google_maps_bicycle_directions_areas:{type:"GeometryCollection",geometries:function(){var e,t=[];for(e in l)l.hasOwnProperty(e)&&t.push(l[e]);return t}()},map_service_api:"google",map_service_apis:{bing:{credentials:"Aqvtg6kruGwyEI-_YXxFGRY7jtHqFBtlxh_p8GeEc8is-TyiGin7I-fk4ggxRhFs"},google:{client:"gme-mapmyfitness"}},map_types:s,max_undo_stack_size:20,namespace:"MMF.Maps",radius_of_earth:6378137,route_optimization_tolerance:5e-5,travel_modes:o,units:r,version:"4.0",zoom_control_styles:a};t.consumer_key||i.error("No consumer key passed."),t.site||i.error("No site ID passed.");var h=e.extend(!0,{},c,t);return h.namespace=h.namespace||c.namespace,h}),mmf_mapping_api.define("namespace",["constants"],function(e){var t,i,n=window,s=e.namespace.split(".");for(s="window"===s[0]?s.slice(1):s,t=0,i=s.length;i>t;t++)n[s[t]]||(n[s[t]]={}),n=n[s[t]];return n}),mmf_mapping_api.define("uris",["require"],function(e){var t=function(e){var t=e.toUrl(".");return t.substr(0,t.length-4)}(e);return{account_settings:"/account/my_profile",ad_icons:t+"/img/ad_icons/",cdn:t,css:t+"/css/",img:t+"/img/",markers:t+"/img/markers/"}}),mmf_mapping_api.define("config/default_options",["uris","constants"],function(e,t,i){return{api_mode:t.api_modes.CREATE,error:{callback:null,outputID:null},geolocation:{position:{latitude:39.73915,longitude:-104.9847}},map:{behavior:{center_on_click:!1,follow_roads:!0,scroll_wheel_zoom:!1},display:{ads:!1,bicycle_paths:!1,distance_markers:!0,distance_marker_interval:1,location_indicator:!0,map_control_toolbar:!0,route_origin_tooltip:{content:null,callback:function(){}},traffic:!1,start_drawing_message:!0},events:{click:function(){}},init:{map_type:t.map_types.ROAD,map_types:[t.map_types.USA_TOPO,t.map_types.WORLD_TOPO],max_zoom:22,min_zoom:4,overview_map_control:!0,overview_map_control_options:{opened:!1},pan_control:!1,position:{address:i,latitude:i,longitude:i},region:"US",street_view_control:!0,zoom:i,zoom_control:!0,zoom_control_options:{style:t.zoom_control_styles.SMALL}},paths:{common:{polylineOptions:{strokeOpacity:.5,strokeWeight:6}},direct:{polylineOptions:{strokeColor:"#FF0000"}},snap_to_roads:{avoid_highways:!0,polylineOptions:{strokeColor:"#0000FF"},travel_mode:t.travel_modes.WALKING}}},save:function(){},sensor:!0,unit:t.units.IMPERIAL,user_interface:{display:{directions:{callback:null,container:null},distance:{callback:null,container:null},elevation:{callback:null,container:null,hide:null,open_by_default:!1,show:null},geolocation:!0}}}}),mmf_mapping_api.define("map_configs",["jquery","pubsub","logger","message_mgr","namespace","constants","config/default_options"],function(e,t,i,n,s,o,r,a){var l={},c=function(e){return null!==e&&e!==a};return{apiMode:function(e){var t=this.get(e).api_mode;return t===o.api_modes.CREATE?"create":t===o.api_modes.EDIT?"edit":t===o.api_modes.VIEW?"view":t},allowFeature:function(e,t){var i={add_map_elements:{create:1,edit:1},manipulate_route:{create:1,edit:1},mouse_events:{create:1,edit:1}};return i.hasOwnProperty(t)?i[t].hasOwnProperty(this.apiMode(e)):!0},avoidHighways:function(e){var t=this.get(e).map.paths.snap_to_roads.avoid_highways;return c(t)?t:r.map.paths.snap_to_roads.avoid_highways},centerOnClick:function(e){var t=this.get(e).map.behavior.center_on_click;return c(t)?t:r.map.behavior.center_on_click},distanceMarkerInterval:function(e){var t=this.get(e).map.display.distance_marker_interval;return c(t)?t:r.map.display.distance_marker_interval},followRoads:function(e){var t=this.get(e).map.behavior.follow_roads;return c(t)?t:r.map.behavior.follow_roads},get:function(e){return l[e]},mapType:function(e){var t=this.get(e).map.init.map_type;return c(t)?t:r.map.init.map_type},scrollWheelZoom:function(e){var t=this.get(e).map.behavior.scroll_wheel_zoom;return c(t)?t:r.map.behavior.scroll_wheel_zoom},set:function(e,t){return i.log("map_configs.set"),l[e]=l[e]||t,l[e]},setAvoidHighways:function(e,t){t!==a&&t!==this.avoidHighways(e)&&(this.get(e).map.paths.snap_to_roads.avoid_highways=t,this.settingChange(e,"avoid_highways",t?"true":"false"))},setBicyclePaths:function(e,i){i!==a&&i!==this.showBicyclePaths(e)&&(this.get(e).map.display.bicycle_paths=i,t.publish(e+".toggled.bicycle_paths",{bool:i}),this.settingChange(e,"show_bicycle_paths",i?"true":"false"))},setCenterOnClick:function(e,t){t!==a&&(this.get(e).map.behavior.center_on_click=t,this.settingChange(e,"center_on_click",t?"true":"false"))},setDistanceMarkerInterval:function(e,i){return isNaN(i)?(n.get(e).error("Interval passed is not a number. Please pass an interval in meters."),void 0):(this.get(e).map.display.distance_marker_interval=i,t.publish(e+".set.distance_marker_interval",{interval:i}),void 0)},setDistanceMarkers:function(e,i){this.get(e).map.display.distance_markers=i,t.publish(e+".toggled.distance_markers"),this.settingChange(e,"distance_markers",i?"true":"false")},setElevation:function(e,t){this.settingChange(e,"show_elevation",t?"true":"false")},setFollowRoads:function(e,t){t!==a&&t!==this.followRoads(e)&&(this.get(e).map.behavior.follow_roads=t),this.settingChange(e,"follow_roads",t?"true":"false")},setMapType:function(e,t){this.get(e).map.init.map_type=t,this.settingChange(e,"map_type",t)},setScrollWheelZoom:function(e,i){i!==a&&i!==this.scrollWheelZoom(e)&&(this.get(e).map.behavior.scroll_wheel_zoom=i),t.publish(e+".set.map_options",{scrollwheel:i}),this.settingChange(e,"scroll_wheel_zoom",i?"true":"false")},settingChange:function(e,t,i){this.get(e).map.settingChange&&this.get(e).map.settingChange instanceof Function&&this.get(e).map.settingChange(t,i)},setTraffic:function(e,i){i!==a&&i!==this.showTraffic(e)&&(this.get(e).map.display.traffic=i,t.publish(e+".toggled.traffic",{bool:i}),this.settingChange(e,"show_traffic",i?"true":"false"))},setTravelMode:function(e,i){if(i&&i!==this.travelMode(e)){if(!o.isValidTravelMode(i))return n.get(e).error('"'+i+'" is not a valid travel mode.'),void 0;this.get(e).map.paths.snap_to_roads.travel_mode=i,this.settingChange(e,"scroll_wheel_zoom",i),t.publish(e+".map_config.set.travel_mode",i)}},setUnit:function(e,i){i&&o.isValidUnitSystem(i)&&(i in o.units?(this.get(e).unit=i,t.publish(e+".map_config.set.unit",i),this.settingChange(e,"unit",i)):n.get(e).error("Unit of measure not recognized. Please use a unit defined in "+s+".UNITS_OF_MEASURE."))},showAds:function(e){return this.get(e).map.display.ads},showBicyclePaths:function(e){var t=this.get(e).map.display.bicycle_paths;return c(t)?t:r.map.display.bicycle_paths},showDistanceMarkers:function(e){var t=this.get(e).map.display.distance_markers;return c(t)?t:r.map.display.distance_markers},showTraffic:function(e){var t=this.get(e).map.display.traffic;return c(t)?t:r.map.display.traffic},travelMode:function(e){var t=this.get(e).map.paths.snap_to_roads.travel_mode;return c(t)?t:r.map.paths.snap_to_roads.travel_mode},unit:function(e){var t=this.get(e).unit;return c(t)?t:r.unit}}}),mmf_mapping_api.define("message_mgr",["jquery","pubsub","logger","map_configs"],function(e,t,i,n){var s={},o=function(i){this.map_config=n.get(i),this.messages=[],this.map_id=i,this.handler=this.map_config.error.callback||e.proxy(function(t){this.map_config.error.outputID&&e("#"+this.map_config.error.outputID).html(t.msg)},this),t.subscribe(this.map_id+".error",e.proxy(function(e,t){this.error(t.message)},this))};return o.prototype={clearHistory:function(){this.messages=[],i.info("Message history cleared for ID: ",this.mapId)},error:function(e,t){this.handle({msg:e,type:"error",fn:t})},getHistory:function(){return this.messages},handle:function(e){this.messages.push(e);var t=e.type||"log",n=e.fn||this.handler;n(e.msg),i[t]("",e.msg)},warning:function(e,t){this.handle({msg:e,type:"warn",fn:t})}},{init:function(e){return s[e]=s[e]||new o(e),s[e]},get:function(e){return s.hasOwnProperty(e)?s[e]:(i.error("A messager does not yet exist for mapId "+e+". Messager.init() hasn't been run for that map_id yet."),void 0)}}}),mmf_mapping_api.define("storage",["logger"],function(e,t){var i,n=[],s=0;return{generateMapId:function(){return e.log("maps.generateMapId"),s++},getApi:function(){return i},getMap:function(e){return e!==t?n[e]:n},setApi:function(e){i=e},setMap:function(e,t){n[e]=t}}}),mmf_mapping_api.define("classes/Class",[],function(){var e=!1,t=/xyz/.test(function(){})?/\b_super\b/:/.*/,i=function(){};return i.extend=function(i){function n(){!e&&this.init&&this.init.apply(this,arguments)}var s=this.prototype;e=!0;var o=new this;e=!1;for(var r in i)o[r]="function"==typeof i[r]&&"function"==typeof s[r]&&t.test(i[r])?function(e,t){return function(){var i=this._super;this._super=s[e];var n=t.apply(this,arguments);return this._super=i,n}}(r,i[r]):i[r];return n.prototype=o,n.prototype.constructor=n,n.extend=arguments.callee,n},i}),mmf_mapping_api.define("simplify",[],function(){var e={};return function(e,t){function i(e,t){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n}function n(e,t,i){var n,s=t.x,o=t.y,r=i.x-s,a=i.y-o;return(0!==r||0!==a)&&(n=((e.x-s)*r+(e.y-o)*a)/(r*r+a*a),n>1?(s=i.x,o=i.y):n>0&&(s+=r*n,o+=a*n)),r=e.x-s,a=e.y-o,r*r+a*a}function s(e,t){var n,s,o=e.length,r=e[0],a=[r];for(n=1;o>n;n++)s=e[n],i(s,r)>t&&(a.push(s),r=s);return r!==s&&a.push(s),a}function o(e,i){var s,o,r,a,l=e.length,c=typeof Uint8Array!=t+""?Uint8Array:Array,h=new c(l),u=0,p=l-1,d=[],f=[],g=[];for(h[u]=h[p]=1;p;){for(o=0,s=u+1;p>s;s++)r=n(e[s],e[u],e[p]),r>o&&(a=s,o=r);o>i&&(h[a]=1,d.push(u),f.push(a),d.push(a),f.push(p)),u=d.pop(),p=f.pop()}for(s=0;l>s;s++)h[s]&&g.push(e[s]);return g}var r=typeof exports!=t+""?exports:e;r.simplify=function(e,i,n){var r=i!==t?i*i:1;return n||(e=s(e,r)),e=o(e,r)}}(e),e.simplify}),mmf_mapping_api.define("utils/geocode",["jquery","storage","constants","uris","logger"],function(e,t,i,n,s){var o,r=function(e){o=o||t.getApi(),o.geocode({address:e.address,callback:function(t,i){s.log("geocode data (map service): ",t),e.callback({error:i,output:t.geometry})}})};return{geocode:r}}),mmf_mapping_api.define("utils/geolocation",["require","jquery","logger","constants","uris"],function(e,t,i){function n(e){e===!0?i.error(o.geoloc_failed):i.error(o.geoloc_no_support)}function s(e){var t=e.success,i=e.error;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){t(e)},function(){n(!0),i(o.geoloc_failed)},{enableHighAccuracy:!0,maximumAge:0,timeout:2e4}):i(o.geoloc_no_support)}var o={geoloc_failed:"Geolocation service failed.",geoloc_no_support:"Your browser does not support geolocation.",ip_failed:"IP-based location could not be determined."};return{locate:function(e){var n,o=t.Deferred();s({success:function(t){o.resolve(),e({location:t.coords})},error:function(e){n=e,i.error(e),o.reject()}}),o.fail(function(){e({error:n})})},locateByW3:s}}),mmf_mapping_api.define("utils/map_helpers",["jquery","logger","message_mgr","utils/geocode","utils/geolocation","uris"],function(e,t,i,n){return{capitalize:function(e){return e.charAt(0).toUpperCase()+e.substring(1)},getInitialPosition:function(i){function s(e,t){e&&e.vertex||e.latitude&&e.longitude?o.resolve(e):t&&t.reject()}var o=i.deferred,r=i.initial_position,a=e.Deferred(),l=e.Deferred();e.Deferred(),s(r,a),a.fail(function(){r&&r.address?n.geocode({address:r.address,callback:function(e){!e.error&&e.output?s(e.output,l):(t.error(e.error),l.reject())}}):l.reject()}),l.fail(function(){o.resolve(null)})},loadCss:function(e){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)},properCase:function(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},toCamelCase:function(e){return e.toLowerCase().replace(/([\-_\s][a-z])/g,function(e){return e.toUpperCase().replace(/[\-_\s]/,"")})},transparentGif:function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},ignoreElevation:function(){var t,i=e("#elevation_content_wrapper"),n=i.length;return n?t="none"===i.css("display"):!1}}}),mmf_mapping_api.define("units",["jquery","constants"],function(e,t){var i=["coarse","medium","fine"],n={};n[t.units.IMPERIAL]={coarse:{abbreviated:"mi",full:"miles"},medium:{abbreviated:"ft",full:"feet"},fine:{abbreviated:"in",full:"inches"}},n[t.units.METRIC]={coarse:{abbreviated:"km",full:"kilometers"},medium:{abbreviated:"m",full:"meters"},fine:{abbreviated:"cm",full:"centimeters"}};var s={getUnit:function(e){return n[e.system in n?e.system:""][isNaN(e.scope)?e.scope:i[e.scope]][e.abbreviated?"abbreviated":"full"]}};return e.extend(!0,{},n,s)}),mmf_mapping_api.define("utils/calculations",["units","constants"],function(e,t){var i={ft:"metersToFeet",mi:"metersToMiles",km:"metersToKilometers"};return{computeDistanceBetweenCoordinates:function(e,i,n,s){var o=Math.PI/180,r=e*o,a=n*o,l=i*o,c=s*o,h=a-r,u=c-l,p=Math.pow(Math.sin(h/2),2)+Math.cos(r)*Math.cos(a)*Math.pow(Math.sin(u/2),2),d=2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p));return d*t.radius_of_earth},displayConversion:function(e,t){return"m"===e?t:this[i[e]](t)},feetToMeters:function(e){return.3048*e},feetToMiles:function(e){return e/5280},getClosestPoint:function(e,t,i,n){var s={x:i.x-e.x,y:i.y-e.y},o={x:t.x-e.x,y:t.y-e.y},r=window.Math.pow(o.x,2)+window.Math.pow(o.y,2),a=s.x*o.x+s.y*o.y,l=a/r;n&&(0>l?l=0:l>1&&(l=1));var c={x:e.x+o.x*l,y:e.y+o.y*l};return c},kilometersToMeters:function(e){return 1e3*e},kilometersToMiles:function(e){return.621371192*e},metersToFeet:function(e){return 3.2808399*e},metersToMiles:function(e){return.000621371192*e},metersToKilometers:function(e){return e/1e3},milesToKilometers:function(e){return 1.609344*e},milesToMeters:function(e){return 1609.344*e}}}),mmf_mapping_api.define("config/marker_def",["jquery","uris","logger"],function(e,t,i){var n=t.cdn+"/img/",s=[{filename:"distance.png",desc:"Distance Indicator",origin:{},anchor:{x:14,y:32},size:{width:27,height:32},internal_use_only:!0},{filename:"sprite-primary.png",desc:"Flag Shadow",origin:{x:0,y:-139},anchor:{x:24,y:32},size:{width:47,height:32},internal_use_only:!0},{filename:"sprite-markers.png",desc:"Square Shadow",origin:{x:-28,y:-300},anchor:{x:15,y:16},size:{width:45,height:29},internal_use_only:!0},{filename:"sprite-primary.png",desc:"Route Start",origin:{x:0,y:-270},anchor:{x:14,y:32},size:{width:27,height:32},internal_use_only:!0},{filename:"sprite-primary.png",desc:"Route End",origin:{x:0,y:-303},anchor:{x:14,y:32},size:{width:27,height:32},internal_use_only:!0},{filename:"sprite-primary.png",desc:"Location",origin:{x:0,y:-229},anchor:{x:13,y:13},size:{width:25,height:25},internal_use_only:!0},{filename:"sprite-primary.png",desc:"Pointer",origin:{x:0,y:-368},anchor:{x:7,y:20},size:{width:12,height:20},internal_use_only:!0},{filename:"sprite-primary.png",desc:"Geolocate",origin:{x:0,y:-193},anchor:{x:10,y:10},size:{width:20,height:20},internal_use_only:!0},{filename:"sprite-primary.png",desc:"Waypoint Active",id:0,origin:{x:0,y:-539},anchor:{x:9,y:9},size:{width:19,height:19},internal_use_only:!0},{filename:"sprite-primary.png",desc:"Waypoint Static",id:1,origin:{x:0,y:-559},anchor:{x:9,y:9},size:{width:19,height:19},internal_use_only:!0},{filename:"sprite-markers.png",desc:"Sprint",id:33,origin:{x:-28,y:-270},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Lap",id:81,origin:{x:0,y:-960},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Aid",id:2,origin:{x:0,y:0},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Water",id:3,origin:{x:-28,y:-480},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Bathroom",id:6,origin:{x:0,y:-270},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Stretch Area",id:7,origin:{x:-28,y:-420},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Parking Area",id:8,origin:{x:-28,y:-90},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Workout Area",id:10,origin:{x:-28,y:-510},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Info",id:16,origin:{x:0,y:-930},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Police",id:17,origin:{x:-28,y:-120},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Feed Zone",id:34,origin:{x:0,y:-870},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Icecream",id:84,origin:{x:0,y:-900},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Scenic",id:9,origin:{x:-28,y:-240},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Cattle Crossing",id:82,origin:{x:0,y:-330},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Rail Road Crossing",id:83,origin:{x:-28,y:-150},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Hazard",id:11,origin:{x:-28,y:-450},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Dog Warning",id:12,origin:{x:0,y:-840},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Road Closed",id:13,origin:{x:-28,y:-210},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Dirt Road",id:14,origin:{x:0,y:-810},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Stream / River",id:15,origin:{x:-28,y:-390},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Climb: General",id:26,origin:{x:0,y:-420},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Climb: Category 1",id:27,origin:{x:0,y:-450},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Climb: Category 2",id:28,origin:{x:0,y:-480},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Climb: Category 3",id:29,origin:{x:0,y:-510},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Climb: Category 4",id:30,origin:{x:0,y:-540},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Climb: Hors Category",id:31,origin:{x:0,y:-360},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"King of the Mtn",id:32,origin:{x:0,y:-390},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Up",id:18,origin:{x:0,y:-180},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Up Right",id:19,origin:{x:0,y:-240},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Right",id:20,origin:{x:0,y:-150},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Down Right",id:21,origin:{x:0,y:-90},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Down",id:22,origin:{x:0,y:-30},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Down Left",id:23,origin:{x:0,y:-60},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Left",id:24,origin:{x:0,y:-120},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Up Left",id:25,origin:{x:0,y:-210},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"North",id:73,origin:{x:0,y:-600},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Northeast",id:74,origin:{x:0,y:-630},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"East",id:75,origin:{x:0,y:-570},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Southeast",id:76,origin:{x:0,y:-720},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"South",id:77,origin:{x:0,y:-690},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Southwest",id:78,origin:{x:0,y:-750},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"West",id:79,origin:{x:0,y:-780},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Northwest",id:80,origin:{x:0,y:-660},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Number 0",id:37,origin:{x:0,y:-1800},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Number 1",id:38,origin:{x:0,y:-1830},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Number 2",id:39,origin:{x:0,y:-1860},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Number 3",id:40,origin:{x:0,y:-1890},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Number 4",id:41,origin:{x:0,y:-1920},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Number 5",id:42,origin:{x:0,y:-1950},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Number 6",id:43,origin:{x:0,y:-1980},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Number 7",id:44,origin:{x:-28,y:0},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Number 8",id:45,origin:{x:-28,y:-30},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Number 9",id:46,origin:{x:-28,y:-60},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter A",id:47,origin:{x:0,y:-990},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter B",id:48,origin:{x:0,y:-1020},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter C",id:49,origin:{x:0,y:-1050},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter D",id:50,origin:{x:0,y:-1080},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter E",id:51,origin:{x:0,y:-1110},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter F",id:52,origin:{x:0,y:-1140},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter G",id:53,origin:{x:0,y:-1170},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter H",id:54,origin:{x:0,y:-1200},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter I",id:55,origin:{x:0,y:-1230},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter J",id:56,origin:{x:0,y:-1260},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter K",id:57,origin:{x:0,y:-1290},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter L",id:58,origin:{x:0,y:-1320},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter M",id:59,origin:{x:0,y:-1350},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter N",id:60,origin:{x:0,y:-1380},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter O",id:61,origin:{x:0,y:-1410},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter P",id:62,origin:{x:0,y:-1440},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter Q",id:63,origin:{x:0,y:-1470},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter R",id:64,origin:{x:0,y:-1500},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter S",id:65,origin:{x:0,y:-1530},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter T",id:66,origin:{x:0,y:-1560},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter U",id:67,origin:{x:0,y:-1590},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter V",id:68,origin:{x:0,y:-1620},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter W",id:69,origin:{x:0,y:-1650},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter X",id:70,origin:{x:0,y:-1680},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter Y",id:72,origin:{x:0,y:-1710},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Letter Z",id:72,origin:{x:0,y:-1740},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Red Checker",id:35,origin:{x:-28,y:-180},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Black Checker",id:36,origin:{x:0,y:-300},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Start",id:4,origin:{x:-28,y:-330},anchor:{x:13,y:15},size:{width:24,height:23}},{filename:"sprite-markers.png",desc:"Stop",id:5,origin:{x:-28,y:-360},anchor:{x:13,y:15},size:{width:24,height:23}}],o={},r={};!function(e,t,i){var s;for(e.reverse();e.length;)s=e.pop(),t[s.id]=s.desc,i[s.desc.toLowerCase()]={desc:s.desc,filename:s.filename,icon:{anchor:s.anchor,origin:s.origin,scaled_size:s.scaled_size,size:s.size,url:n+s.filename},id:s.id,internal_use_only:s.internal_use_only,size:s.size};e=s=null}(s,o,r);var a=function(e){return e?(window.isNaN(e)===!1&&(e=o[parseInt(e,10)]),r[e.toLowerCase()]):(i.error("No marker key passed."),void 0)};return{get:function(t){return e.extend(!0,{},a(t))},getEnd:function(){return this.get("Route End")},getList:function(){var e,t=[];for(e in r)r.hasOwnProperty(e)&&t.push(a(e));return t},getStart:function(){return this.get("Route Start")}}}),mmf_mapping_api.define("globals/hover_markers",["logger"],function(e,t){var i=[];return{get:function(e){return e!==t?i[e]:t},set:function(e,t){i[e]=t}}}),mmf_mapping_api.define("config/map_types",["logger","constants"],function(e,t){var i={google:["mt1","mt2","mt3","mt4"]},n=function(e){return i[e].push(i[e][0]),i[e].shift()},s={USA_TOPO:{data:{getTileUrl:function(e,t){return"http://services.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/"+t+"/"+e.y+"/"+e.x+"?format=png"},tileSize:{width:256,height:256},isPng:!0,alt:"Esri USA Topo Map",name:"USA Topo",maxZoom:15,minZoom:9},id:t.map_types.USA_TOPO},WORLD_TOPO:{data:{getTileUrl:function(e,t){return"http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/"+t+"/"+e.y+"/"+e.x+"?format=png"},tileSize:{width:256,height:256},isPng:!0,alt:"Esri World Topo Map",name:"World Topo",maxZoom:19,minZoom:2},id:t.map_types.WORLD_TOPO},TRAFFIC:{data:{getTileUrl:function(e,t){return"http://"+n("google")+".google.com/mapstt?"+"zoom="+t+"&x="+e.x+"&y="+e.y+"&client=api"},maxZoom:19,tileSize:{width:256,height:256},isPng:!0,alt:"Traffic",name:"Traffic"},id:t.map_types.TRAFFIC}};return s}),mmf_mapping_api.define("config/regexp",{lat_lng:new RegExp(/(-?[0-9]+(?:\.[0-9]+)?),\s*(-?[0-9]+(?:\.[0-9]+)?)/g)}),mmf_mapping_api.define("classes/MapApiAdapter",["jquery","pubsub","logger","message_mgr","utils/map_helpers","classes/Class"],function(e,t,i,n,s,o){var r=" If you didn't explicitly call ._super(), you have forgotten to implement this method in the current maps api adapter implementation.",a=o.extend({init:function(e){i.info("MapApiAdapter.init"),this.map=null,this.map_id=e.map_id,this.unit=e.unit,this.messager=n.get(this.map_id),this.subscribeToTopics()},addEventListener:function(){i.info("MapApiAdapter.addEventListener"),i.warn(r)},callDirectionsService:function(){i.info("MapApiAdapter.callDirectionsService"),i.warn(r)},clearEventListeners:function(){i.info("MapApiAdapter.clearEventListeners"),i.warn(r)},computePolylineLength:function(){i.info("MapApiAdapter.computePolylineLength"),i.warn(r)},createMap:function(){i.info("MapApiAdapter.createMap"),i.warn(r)},createMarker:function(){i.info("MapApiAdapter.createMarker"),i.warn(r)},createDirectionsPolyline:function(){i.info("MapApiAdapter.createDirectionsPolyline"),i.warn(r)},createPolyline:function(){i.info("MapApiAdapter.createPolyline"),i.warn(r)},extendPointObject:function(){},_getMapType:function(){i.info("MapApiAdapter._getMapType"),i.warn(r)},_getTravelMode:function(){i.info("MapApiAdapter._getTravelMode"),i.warn(r)},_getUnitSystem:function(){i.info("MapApiAdapter._getUnitSystem"),i.warn(r)},setUnitSystem:function(e){this.unit=e},subscribeToTopics:function(){t.subscribe(this.map_id+".updated.unit.system",e.proxy(function(){this.setUnitSystem()},this))}});return a}),mmf_mapping_api.define("classes/QuotaManager",["logger","classes/Class"],function(e,t){var i=function(){var t=this;return this instanceof n?(this.interval||(this.interval=window.setInterval(function(){t.bucket===t.max_quota?(window.clearInterval(t.interval),t.interval=null):t.bucket++},this.rate/this.max_quota)),void 0):(e.error("Context of 'replenish' is not an instance of QuotaManager"),void 0)},n=t.extend({init:function(e,t){this.max_quota=e,this.rate=t,this.bucket=e},count:function(){return this.bucket},pop:function(t){return t=t||1,this.test(t)?(this.bucket=this.bucket-t,i.call(this),this.bucket):(e.warn("Called pop() on an insufficient quota bucket."),!1)},test:function(e){return this.bucket>(e||1)}});return n}),mmf_mapping_api.define("google_maps_api",[["async!https://maps.google.com/maps/api/js","?v=3.29","&client=gme-mapmyfitness","&libraries=geometry","&channel="+window.location.host].join("")],function(){return window.google.maps}),mmf_mapping_api.define("libs/google/Adapter",["jquery","pubsub","constants","logger","message_mgr","utils/map_helpers","utils/calculations","classes/MapApiAdapter","classes/QuotaManager","google_maps_api"],function(e,t,i,n,s,o,r,a,l,c,h){var u=25,p=a.extend({init:function(){this.api=c,this._super.apply(this,arguments),this.DirectionsService=new this.api.DirectionsService,this.directions_service_interval_id=null,this.render_queue=[],this.directions_service_processing_ctr=0,this.directions_service_processed_ctr=0,this.directions_service_quota_manager=new l(10,1e3),this.ElevationService=new this.api.ElevationService,this.Geocoder=new this.api.Geocoder,this.extendLatLngObject(),this.extendMapObject(),this.extendMarkerObject(),this.extendPointObject(),this.extendPolylineObject()},activateBicyclingLayer:function(){this.bicycle_layer=this.bicycle_layer||new this.api.BicyclingLayer,this.bicycle_layer.setMap(this.map)},activateTrafficLayer:function(){this.traffic_layer=this.traffic_layer||new this.api.TrafficLayer,this.traffic_layer.setMap(this.map)},activateInfoWindow:function(e){var t=e.info_window;e.content&&t.setContent(e.content),t.open(this.map,e.marker)},addEventListener:function(t){var i=e.proxy(function(e){var i,n={point:{click:1,dblclick:1,rightclick:1,mouseover:1,mousemove:1,mouseout:1,mousedown:1,mouseup:1,drag:1,dragstart:1,dragend:1},none:{maptypeid_changed:1,bounds_changed:1,closeclick:1,content_changed:1,directions_changed:1,domready:1,idle:1,position_changed:1,zindex_changed:1,zoom_changed:1}};n.point.hasOwnProperty(t.event)?i=e.latLng:n.none.hasOwnProperty(t.event)||this.messager.error("Unrecognized event type: "+t.event),t.callback(i)},this);this.api.event.addListener(t.obj,t.event,i)},addMapType:function(t){var i=new this.api.ImageMapType(e.extend(!0,t.data,{tileSize:new this.api.Size(t.data.tileSize.width,t.data.tileSize.height)}));this.map.mapTypes.set(t.id,i)},callDirectionsService:function(){0===this.render_queue.length&&this.directions_service_quota_manager.test(1)?f.apply(this,arguments):(this.render_queue.push(arguments),this.directions_service_processing_ctr++,this.directions_service_interval_id||(t.publish("start.processing",{text:"Calculating route..."}),this.directions_service_interval_id=window.setInterval(e.proxy(function(){if(this.directions_service_quota_manager.test(1)){var e=this.render_queue[0];
this.render_queue=this.render_queue.slice(1),this.directions_service_processed_ctr++,f.apply(this,e),0===this.render_queue.length&&(this.directions_service_processing_total=0,t.publish("end.processing"),n.log("Shutting down the render interval"),window.clearInterval(this.directions_service_interval_id),this.directions_service_interval_id=null)}},this),this.directions_service_quota_manager.rate)))},clearEventListeners:function(e){e.event?this.api.event.clearListeners(e.obj,e.event):this.api.event.clearInstanceListeners(e.obj)},computeDistanceBetweenPoints:function(e){var t=e.points[0],i=e.points[1];return r.computeDistanceBetweenCoordinates(t.lat(),t.lng(),i.lat(),i.lng())},convertPointToCoordinates:function(e){return{latitude:e.lat(),longitude:e.lng()}},createDirectionsPolyline:function(e){return new this.api.DirectionsRenderer(e)},createInfoWindow:function(t){return new this.api.InfoWindow(e.extend(!0,{position:t.point||new this.api.LatLng(t.latitude,t.longitude)},t))},createKmlLayer:function(e){return new this.api.KmlLayer(e.url,e)},createLatLngBounds:function(){return new this.api.LatLngBounds},createMap:function(t){var i={};e.each(t,function(e,t){i[o.toCamelCase(e)]=t});var n=e.extend(!0,i,{center:t.position.vertex?t.position.vertex:this.createPoint(t.position),draggableCursor:t.draggable_cursor,mapTypeId:this.denormalizeMapType(t.map_type),mapTypeControlOptions:{mapTypeIds:[].concat(t.map_type_control_options.map_type_ids,e.map(this.api.MapTypeId,function(e){return e})),style:this.api.MapTypeControlStyle.HORIZONTAL_BAR},maxZoom:t.max_zoom,minZoom:t.min_zoom,overviewMapControl:t.overview_map_control,overviewMapControlOptions:{opened:t.overview_map_control_options?t.overview_map_control_options:h},panControl:t.pan_control,scrollwheel:t.scrollwheel,streetViewControl:t.street_view_control,zoom:t.zoom,zoomControl:t.zoom_control,zoomControlOptions:{style:t.zoom_control_options?this.denormalizeZoomControlStyle(t.zoom_control_options.style):h}});return delete n.position,this.map=new this.api.Map(t.container,n),this.map},createMarker:function(e){e.marker_options.icon&&e.marker_options.icon.uri&&(e.marker_options.icon.url=e.marker_options.icon.uri),e.marker_options.shadow&&e.marker_options.shadow.uri&&(e.marker_options.shadow.url=e.marker_options.shadow.uri),e.marker_options.animation&&(e.marker_options.animation=this.denormalizeAnimationType(e.marker_options.animation));var t=e.marker_options,i=t.icon;t.icon=new this.api.MarkerImage(i.url,i.size?new this.api.Size(i.size.width,i.size.height,"px","px"):null,i.origin?new this.api.Point(Math.abs(i.origin.x),Math.abs(i.origin.y)):null,i.anchor?new this.api.Point(i.anchor.x,i.anchor.y):null,i.scaled_size?new this.api.Size(i.scaled_size.width,i.scaled_size.height,"px","px"):null);var n=t.shadow;return n&&(t.shadow=new this.api.MarkerImage(n.url,n.size?new this.api.Size(n.size.width,n.size.height):null,n.origin?new this.api.Point(Math.abs(n.origin.x),Math.abs(n.origin.y)):null,n.anchor?new this.api.Point(n.anchor.x,n.anchor.y):null,n.scaled_size?new this.api.Size(n.scaled_size.width,n.scaled_size.height):null)),t.position=e.point,new this.api.Marker(t)},createPoint:function(e){return new this.api.LatLng(e.latitude,e.longitude)},createPolyline:function(e){return new this.api.Polyline(e)},deactivateBicyclingLayer:function(){this.bicycle_layer&&this.bicycle_layer.setMap(null)},deactivateTrafficLayer:function(){this.traffic_layer&&this.traffic_layer.setMap(null)},deactivateInfoWindow:function(e){e.info_window.close()},denormalizeAnimationType:function(e){e=e?e.toUpperCase():e;var t={BOUNCE:"BOUNCE",DROP:"DROP"};return e in t?e=this.api.Animation[t[e]]:(this.messager.warning("Animation type not recognized. No animation applied: "+e),e=h),e},denormalizeMapType:function(t){var s="ROAD";t=t?t.toUpperCase():t;var o={};return o[i.map_types.ROAD]=this.api.MapTypeId.ROADMAP,o[i.map_types.HYBRID]=this.api.MapTypeId.HYBRID,o[i.map_types.SATELLITE]=this.api.MapTypeId.SATELLITE,o[i.map_types.TERRAIN]=this.api.MapTypeId.TERRAIN,o[i.map_types.USA_TOPO]=i.map_types.USA_TOPO,o[i.map_types.WORLD_TOPO]=i.map_types.WORLD_TOPO,o.hasOwnProperty(t)?t=o[t]:this.map&&e.inArray(t,this.map.mapTypeControlOptions.mapTypeIds)>-1||(n.warn("Map type "+t+" not recognized. Using default: "+s),t=o[s]),t},denormalizeTravelMode:function(e){var t="WALKING";e=e?e.toUpperCase():e;var i={BICYCLING:this.api.TravelMode.BICYCLING,DRIVING:this.api.TravelMode.DRIVING,WALKING:this.api.TravelMode.WALKING};return i.hasOwnProperty(e)?e=i[e]:(this.messager.warning("Travel mode not recognized. Using default: "+t),e=i[t]),e},denormalizeUnitSystem:function(e){var t="IMPERIAL";e=e?e.toUpperCase():e;var i={IMPERIAL:this.api.UnitSystem.IMPERIAL,METRIC:this.api.UnitSystem.METRIC};return i.hasOwnProperty(e)?e=i[e]:(this.messager.warning("Unit of measure not recognized. Using default: "+t),e=i[t]),e},denormalizeZoomControlStyle:function(e){var t="DEFAULT";e=e?e.toUpperCase():e;var i={DEFAULT:this.api.ZoomControlStyle.DEFAULT,SMALL:this.api.ZoomControlStyle.SMALL,LARGE:this.api.ZoomControlStyle.LARGE};return i.hasOwnProperty(e)?e=i[e]:(this.messager.warning("Zoom control style not recognized. Using default: "+i[t]),e=i[t]),e},extendLatLngObject:function(){this.api.LatLng.prototype.latitude=this.api.LatLng.prototype.latitude||function(){return this.lat()},this.api.LatLng.prototype.longitude=this.api.LatLng.prototype.longitude||function(){return this.lng()}},extendMapObject:function(){var e=this.api,t=this.api.Map.prototype.setCenter;this.api.Map.prototype.setCenter=function(i){i instanceof e.LatLng?t.call(this,i):t.call(this,new e.LatLng(i.latitude,i.longitude))}},extendMarkerObject:function(){var t=this.api.Marker.prototype.setOptions;this.api.Marker.prototype.setOptions=function(i){i=i||{},t.call(this,e.extend(!0,{position:i.point},i))}},extendPointObject:function(){this.api.LatLng.isValid,this.api.LatLng.prototype.isValid=function(){return!window.isNaN(this.lat())||!window.isNaN(this.lng())}},extendPolylineObject:function(){var e=this.api,t=this;this.api.Polyline.prototype.disableMouseEvents=function(){this.setOptions({clickable:!1})},this.api.Polyline.prototype.enableMouseEvents=function(){this.setOptions({clickable:!0})},this.api.Polyline.prototype.computeDistance=function(){var e,t,i,n,s=0,o=this.getPath().getArray();for(e=0,t=o.length-1;t>e;e++)i=o[e],n=o[e+1],s+=r.computeDistanceBetweenCoordinates(i.lat(),i.lng(),n.lat(),n.lng());return s},this.api.Polyline.prototype.getPoints=function(){return this.getPath().getArray()},this.api.Polyline.prototype.getPointAtDistance=function(i){var n;if(0>=i)n=this.getPath().getAt(0);else{for(var s,o,r=this.getPoints(),a=0,l=0,c=1,h=r.length;h>c&&i>a;c++)l=a,s=r[c-1],o=r[c],a+=t.computeDistanceBetweenPoints({points:[o,s]});if(i>a)return null;var u=(i-l)/(a-l);n=e.geometry.spherical.interpolate(s,o,u)}return n},this.api.Polyline.prototype.getPointsAtDistance=function(i){var n=i,s=[];if(0>=i)s=[this.getPath().getAt(0)];else for(var o,r,a,l=0,c=0,h=this.getPath().getArray(),u=1,p=h.length;p>u;u++)for(c=l,o=h[u-1],r=h[u],l+=t.computeDistanceBetweenPoints({points:[r,o]});l>n;)a=(n-c)/(l-c),s.push(e.geometry.spherical.interpolate(o,r,a)),n+=i;return s}},geocode:function(e){var t,i=this,n=e.callback;delete e.callback,this.Geocoder.geocode(e,function(e,s){t=e[0]||{},s===i.api.GeocoderStatus.OK&&(s=""),n({address_components:t.address_components,formatted_address:t.formatted_address,geometry:t.geometry?{bounds:t.geometry.bounds,latitude:t.geometry.location.lat(),longitude:t.geometry.location.lng(),type:t.geometry.location_type,vertex:t.geometry.location,viewport_bounds:t.geometry.viewport}:{},types:t.types},s)})},getElevationForLocation:function(t){this.ElevationService.getElevationForLocations({locations:[t.point]},e.proxy(function(e,i){i===this.api.ElevationStatus.OK?t.callback(e[0]):this.messager.error("There was a problem retrieving location elevation data: "+i)},this))},getElevationsForPath:function(t){if(!t.polyline&&!t.path)return this.messager.error("You must provide a polyline or a path."),void 0;if(t.polyline&&t.path)return this.messager.error("You may only pass one: a polyline or a path."),void 0;var i=t.points||[],s=2,o=1e3,r=164;i=d.call(this,t.polyline||i,r),i.length>0?this.ElevationService.getElevationAlongPath({path:i,samples:t.samples?function(e){return e=s>e?s:e,e=e>o?o:e}(t.samples):o},e.proxy(function(e,i){i===this.api.ElevationStatus.OK?t.callback(e):this.messager.error("There was a problem retrieving path elevation data: "+i)},this)):(n.warn("Path is empty. Skipping call to elevation api."),t.callback([]))},getMapType:function(){return this.normalizeMapType(this.map.getMapTypeId())},normalizeMapType:function(e){this.api.MapTypeId.ROADMAP;var t={};return t[this.api.MapTypeId.ROADMAP]=i.map_types.ROAD,t[this.api.MapTypeId.HYBRID]=this.api.MapTypeId.HYBRID,t[this.api.MapTypeId.SATELLITE]=this.api.MapTypeId.SATELLITE,t[this.api.MapTypeId.TERRAIN]=this.api.MapTypeId.TERRAIN,t[i.map_types.USA_TOPO]=i.map_types.USA_TOPO,t[i.map_types.WORLD_TOPO]=i.map_types.WORLD_TOPO,t.hasOwnProperty(e)?e=t[e]:n.warn("Map type "+e+" not recognized."),e},resizeMap:function(){this.api.event.trigger(this.map,"resize")},setMapOptions:function(e){this.map.setOptions(e)},setMapType:function(e){this.map.setMapTypeId(this.denormalizeMapType(e))},setUnitSystem:function(){this._super()}}),d=function(e,t){var i,s,o,r,a=100;if(t||(n.warn("No limit was set. Using default of "+a),t=a),e instanceof Array)i=e,s=this.createPolyline({path:i,geodesic:!0});else{if(!(e instanceof this.api.Polyline))return n.error("Either a polyline or points must be passed for reduction"),void 0;s=e,i=s.getPoints()}return t-=2,i.length&&i.length>t&&(o=s.computeDistance(),r=o/t,i=[i[0]].concat(s.getPointsAtDistance(r),i.slice(-1))),i},f=function(t,i){var s={avoidHighways:t.avoid_highways,avoidTolls:t.avoid_tolls,destination:t.destination,optimizeWaypoints:t.optimize_waypoints,origin:t.origin,travelMode:this.denormalizeTravelMode(t.travel_mode),unitSystem:this.denormalizeUnitSystem(t.unit||this.unit),waypoints:t.waypoints};if(s.waypoints&&s.waypoints.length>u-2){var o=d.call(this,[s.origin].concat(e.map(s.waypoints,function(e){return e.location}),s.destination),u);s.waypoints=e.map(o.slice(1,-1),function(e){return{location:e,stopover:!1}})}this.directions_service_quota_manager.pop(),this.DirectionsService.route(s,e.proxy(function(e,s){return s!==this.api.DirectionsStatus.OK?(n.error("DirectionsService error - status:",s),n.error("DirectionsService error - parms:",t),i(null,s)):(n.log("DirectionsService response:",e),i({directions:function(e){for(var t,i,n,s=[],o=e.routes[0].legs,r=0,a=o.length;a>r;r++){t=o[r].steps;for(var l=0,c=t.length;c>l;l++)i=t[l],n=i.instructions,s.push({distance:i.distance.value,duration:i.duration.value,text:n,point:i.start_point})}return s}(e),distance:e.routes[0].legs[0].distance.value,path:e.routes[0].overview_path,raw_response:e},s),void 0)},this))};return p}),mmf_mapping_api.define("utils/array",{remove:function(e,t,i){return e.splice(t,!i||1+i-t+(!(0>i^t>=0)&&(0>i||-1)*e.length)),e}}),mmf_mapping_api.define("classes/Collection",["jquery","pubsub","namespace","map_configs","logger","message_mgr","utils/array","classes/Class"],function(e,t,i,n,s,o,r,a,l){var c=a.extend({init:function(e){this.map_id=e.map_id,this.messager=o.get(this.map_id),this.collection=[],this.item=this.name||e.name,this.items=this.item+"s"},clear:function(){this.collection.length=0,t.publish(this.map_id+".cleared."+this.item,{})},dequeue:function(){var e=this.get(0);return this.collection=this.collection.slice(1),t.publish(this.map_id+".removed."+this.item,{index:0,obj:e}),e},enqueue:function(e){return this.collection=[e].concat(this.collection),t.publish(this.map_id+".added."+this.item,{index:0,obj:e}),this.collection},get:function(e){return e===l?this.collection.slice():e<this.length()?this.collection[e]:l},getIndex:function(t){return e.inArray(t,this.collection)},getLast:function(){return this.collection.slice(-1)[0]},insert:function(e,i){return 0===i?this.enqueue(e):i>=this.length()?this.push(e):(this.collection.splice(i,0,e),t.publish(this.map_id+".added."+this.item,{index:i,obj:e}),this.collection)},isEmpty:function(){return!this.length()},isLast:function(){return(isNaN(arguments[0])?this.getIndex(arguments[0]):arguments[0])===this.lastIndex()},lastIndex:function(){return this.length()-1},length:function(){return this.collection.length},pop:function(){var e=this.collection.pop();return t.publish(this.map_id+".removed."+this.item,{index:this.length()+1,obj:e}),e},push:function(e){return this.collection.push(e),t.publish(this.map_id+".added."+this.item,{index:this.length()-1,obj:e}),this.collection},remove:function(){return isNaN(arguments[0])?this.removeObject.apply(this,arguments):isNaN(arguments[1])?this.removeIndex.apply(this,arguments):this.removeRange.apply(this,arguments)},removeIndex:function(e){if(0>e)return s.error("Collection.removeIndex: received an index < 0"),void 0;var i=this.collection[e],n=r.remove(this.collection,e);return t.publish(this.map_id+".removed."+this.item,{index:e,obj:i}),n},removeRange:function(e,i){var n=this.collection.slice(e,i),s=r.remove(this.collection,e,i);return t.publish(this.map_id+".removed."+this.items,{from:e,to:i,obj:n}),s},removeObject:function(e){return this.removeIndex(this.getIndex(e))},reverse:function(){this.collection.reverse()},set:function(e,t){t!==l?this.collection[t]=e:this.collection=e.slice(0)},slice:function(e,t){return this.collection.slice(e,t)}});return c}),function(e,t){function i(t,i){var s,o,r,a=t.nodeName.toLowerCase();return"area"===a?(s=t.parentNode,o=s.name,t.href&&o&&"map"===s.nodeName.toLowerCase()?(r=e("img[usemap=#"+o+"]")[0],!!r&&n(r)):!1):(/input|select|textarea|button|object/.test(a)?!t.disabled:"a"===a?t.href||i:i)&&n(t)}function n(t){return!e(t).parents().andSelf().filter(function(){return"hidden"===e.css(this,"visibility")||e.expr.filters.hidden(this)}).length}var s=0,o=/^ui-id-\d+$/;e.ui=e.ui||{},e.ui.version||(e.extend(e.ui,{version:"1.9.0",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({_focus:e.fn.focus,focus:function(t,i){return"number"==typeof t?this.each(function(){var n=this;setTimeout(function(){e(n).focus(),i&&i.call(n)},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;return t=e.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(i){if(i!==t)return this.css("zIndex",i);if(this.length)for(var n,s,o=e(this[0]);o.length&&o[0]!==document;){if(n=o.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(s=parseInt(o.css("zIndex"),10),!isNaN(s)&&0!==s))return s;o=o.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++s)})},removeUniqueId:function(){return this.each(function(){o.test(this.id)&&e(this).removeAttr("id")})}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(i,n){function s(t,i,n,s){return e.each(o,function(){i-=parseFloat(e.css(t,"padding"+this))||0,n&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var o="Width"===n?["Left","Right"]:["Top","Bottom"],r=n.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+n]=function(i){return i===t?a["inner"+n].call(this):this.each(function(){e(this).css(r,s(this,i)+"px")})},e.fn["outer"+n]=function(t,i){return"number"!=typeof t?a["outer"+n].call(this,t):this.each(function(){e(this).css(r,s(this,t,!0,i)+"px")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,n){return!!e.data(t,n[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var n=e.attr(t,"tabindex"),s=isNaN(n);return(s||n>=0)&&i(t,!s)}}),e(function(){var t=document.body,i=t.appendChild(i=document.createElement("div"));i.offsetHeight,e.extend(i.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),e.support.minHeight=100===i.offsetHeight,e.support.selectstart="onselectstart"in i,t.removeChild(i).style.display="none"}),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,i,n){var s,o=e.ui[t].prototype;for(s in n)o.plugins[s]=o.plugins[s]||[],o.plugins[s].push([i,n[s]])},call:function(e,t,i){var n,s=e.plugins[t];if(s&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(n=0;n<s.length;n++)e.options[s[n][0]]&&s[n][1].apply(e.element,i)}},contains:e.contains,hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var n=i&&"left"===i?"scrollLeft":"scrollTop",s=!1;return t[n]>0?!0:(t[n]=1,s=t[n]>0,t[n]=0,s)},isOverAxis:function(e,t,i){return e>t&&t+i>e},isOver:function(t,i,n,s,o,r){return e.ui.isOverAxis(t,n,o)&&e.ui.isOverAxis(i,s,r)}}))}(jQuery),function(e,t){var i=0,n=Array.prototype.slice,s=e.cleanData;e.cleanData=function(t){for(var i,n=0;null!=(i=t[n]);n++)try{e(i).triggerHandler("remove")}catch(o){}s(t)},e.widget=function(t,i,n){var s,o,r,a,l=t.split(".")[0];t=t.split(".")[1],s=l+"-"+t,n||(n=i,i=e.Widget),e.expr[":"][s.toLowerCase()]=function(t){return!!e.data(t,s)},e[l]=e[l]||{},o=e[l][t],r=e[l][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new r(e,t)},e.extend(r,o,{version:n.version,_proto:e.extend({},n),_childConstructors:[]}),a=new i,a.options=e.widget.extend({},a.options),e.each(n,function(t,s){e.isFunction(s)&&(n[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,o=this._superApply;return this._super=e,this._superApply=n,t=s.apply(this,arguments),this._super=i,this._superApply=o,t}}())}),r.prototype=e.widget.extend(a,{widgetEventPrefix:t},n,{constructor:r,namespace:l,widgetName:t,widgetBaseClass:s,widgetFullName:s}),o?(e.each(o._childConstructors,function(t,i){var n=i.prototype;e.widget(n.namespace+"."+n.widgetName,r,i._proto)}),delete o._childConstructors):i._childConstructors.push(r),e.widget.bridge(t,r)},e.widget.extend=function(i){for(var s,o,r=n.call(arguments,1),a=0,l=r.length;l>a;a++)for(s in r[a])o=r[a][s],r[a].hasOwnProperty(s)&&o!==t&&(i[s]=e.isPlainObject(o)?e.widget.extend({},i[s],o):o);return i},e.widget.bridge=function(i,s){var o=s.prototype.widgetFullName;e.fn[i]=function(r){var a="string"==typeof r,l=n.call(arguments,1),c=this;return r=!a&&l.length?e.widget.extend.apply(null,[r].concat(l)):r,a?this.each(function(){var n,s=e.data(this,o);return s?e.isFunction(s[r])&&"_"!==r.charAt(0)?(n=s[r].apply(s,l),n!==s&&n!==t?(c=n&&n.jquery?c.pushStack(n.get()):n,!1):void 0):e.error("no such method '"+r+"' for "+i+" widget instance"):e.error("cannot call methods on "+i+" prior to initialization; "+"attempted to call method '"+r+"'")}):this.each(function(){var t=e.data(this,o);t?t.option(r||{})._init():new s(r,this)}),c}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),n!==this&&(e.data(n,this.widgetName,this),e.data(n,this.widgetFullName,this),this._on({remove:"destroy"}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(i,n){var s,o,r,a=i;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof i)if(a={},s=i.split("."),i=s.shift(),s.length){for(o=a[i]=e.widget.extend({},this.options[i]),r=0;r<s.length-1;r++)o[s[r]]=o[s[r]]||{},o=o[s[r]];if(i=s.pop(),n===t)return o[i]===t?null:o[i];o[i]=n}else{if(n===t)return this.options[i]===t?null:this.options[i];a[i]=n}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,i){i?(t=e(t),this.bindings=this.bindings.add(t)):(i=t,t=this.element);var n=this;e.each(i,function(i,s){function o(){return n.options.disabled===!0||e(this).hasClass("ui-state-disabled")?void 0:("string"==typeof s?n[s]:s).apply(n,arguments)}"string"!=typeof s&&(o.guid=s.guid=s.guid||o.guid||e.guid++);var r=i.match(/^(\w+)\s*(.*)$/),a=r[1]+n.eventNamespace,l=r[2];l?n.widget().delegate(l,a,o):t.bind(a,o)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return("string"==typeof e?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,n){var s,o,r=this.options[t];if(n=n||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(s in o)s in i||(i[s]=o[s]);return this.element.trigger(i,n),!(e.isFunction(r)&&r.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(n,s,o){"string"==typeof s&&(s={effect:s});var r,a=s?s===!0||"number"==typeof s?i:s.effect||i:t;s=s||{},"number"==typeof s&&(s={duration:s}),r=!e.isEmptyObject(s),s.complete=o,s.delay&&n.delay(s.delay),r&&e.effects&&(e.effects.effect[a]||e.uiBackCompat!==!1&&e.effects[a])?n[t](s):a!==t&&n[a]?n[a](s.duration,s.easing,o):n.queue(function(i){e(this)[t](),o&&o.call(n[0]),i()})}}),e.uiBackCompat!==!1&&(e.Widget.prototype._getCreateOptions=function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]})}(jQuery),function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.9.0",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!t){this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var n=this,s=1===i.which,o="string"==typeof this.options.cancel&&i.target.nodeName?e(i.target).closest(this.options.cancel).length:!1;return s&&!o&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===e.data(i.target,this.widgetName+".preventClickEvent")&&e.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return n._mouseMove(e)},this._mouseUpDelegate=function(e){return n._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return!e.browser.msie||document.documentMode>=9||t.button?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e,t){function i(e,t,i){return[parseInt(e[0],10)*(p.test(e[0])?t/100:1),parseInt(e[1],10)*(p.test(e[1])?i/100:1)]}function n(t,i){return parseInt(e.css(t,i),10)||0}e.ui=e.ui||{};var s,o=Math.max,r=Math.abs,a=Math.round,l=/left|center|right/,c=/top|center|bottom/,h=/[\+\-]\d+%?/,u=/^\w+/,p=/%$/,d=e.fn.position;e.position={scrollbarWidth:function(){if(s!==t)return s;var i,n,o=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),r=o.children()[0];return e("body").append(o),i=r.offsetWidth,o.css("overflow","scroll"),n=r.offsetWidth,i===n&&(n=o[0].clientWidth),o.remove(),s=i-n},getScrollInfo:function(t){var i=t.isWindow?"":t.element.css("overflow-x"),n=t.isWindow?"":t.element.css("overflow-y"),s="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,o="scroll"===n||"auto"===n&&t.height<t.element[0].scrollHeight;return{width:s?e.position.scrollbarWidth():0,height:o?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),n=e.isWindow(i[0]);return{element:i,isWindow:n,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:n?i.width():i.outerWidth(),height:n?i.height():i.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return d.apply(this,arguments);t=e.extend({},t);var s,p,f,g,m,v=e(t.of),_=e.position.getWithinInfo(t.within),y=e.position.getScrollInfo(_),b=v[0],x=(t.collision||"flip").split(" "),w={};return 9===b.nodeType?(p=v.width(),f=v.height(),g={top:0,left:0}):e.isWindow(b)?(p=v.width(),f=v.height(),g={top:v.scrollTop(),left:v.scrollLeft()}):b.preventDefault?(t.at="left top",p=f=0,g={top:b.pageY,left:b.pageX}):(p=v.outerWidth(),f=v.outerHeight(),g=v.offset()),m=e.extend({},g),e.each(["my","at"],function(){var e,i,n=(t[this]||"").split(" ");1===n.length&&(n=l.test(n[0])?n.concat(["center"]):c.test(n[0])?["center"].concat(n):["center","center"]),n[0]=l.test(n[0])?n[0]:"center",n[1]=c.test(n[1])?n[1]:"center",e=h.exec(n[0]),i=h.exec(n[1]),w[this]=[e?e[0]:0,i?i[0]:0],t[this]=[u.exec(n[0])[0],u.exec(n[1])[0]]}),1===x.length&&(x[1]=x[0]),"right"===t.at[0]?m.left+=p:"center"===t.at[0]&&(m.left+=p/2),"bottom"===t.at[1]?m.top+=f:"center"===t.at[1]&&(m.top+=f/2),s=i(w.at,p,f),m.left+=s[0],m.top+=s[1],this.each(function(){var l,c,h=e(this),u=h.outerWidth(),d=h.outerHeight(),b=n(this,"marginLeft"),k=n(this,"marginTop"),M=u+b+n(this,"marginRight")+y.width,T=d+k+n(this,"marginBottom")+y.height,C=e.extend({},m),E=i(w.my,h.outerWidth(),h.outerHeight());"right"===t.my[0]?C.left-=u:"center"===t.my[0]&&(C.left-=u/2),"bottom"===t.my[1]?C.top-=d:"center"===t.my[1]&&(C.top-=d/2),C.left+=E[0],C.top+=E[1],e.support.offsetFractions||(C.left=a(C.left),C.top=a(C.top)),l={marginLeft:b,marginTop:k},e.each(["left","top"],function(i,n){e.ui.position[x[i]]&&e.ui.position[x[i]][n](C,{targetWidth:p,targetHeight:f,elemWidth:u,elemHeight:d,collisionPosition:l,collisionWidth:M,collisionHeight:T,offset:[s[0]+E[0],s[1]+E[1]],my:t.my,at:t.at,within:_,elem:h})}),e.fn.bgiframe&&h.bgiframe(),t.using&&(c=function(e){var i=g.left-C.left,n=i+p-u,s=g.top-C.top,a=s+f-d,l={target:{element:v,left:g.left,top:g.top,width:p,height:f},element:{element:h,left:C.left,top:C.top,width:u,height:d},horizontal:0>n?"left":i>0?"right":"center",vertical:0>a?"top":s>0?"bottom":"middle"};u>p&&r(i+n)<p&&(l.horizontal="center"),d>f&&r(s+a)<f&&(l.vertical="middle"),l.important=o(r(i),r(n))>o(r(s),r(a))?"horizontal":"vertical",t.using.call(this,e,l)}),h.offset(e.extend(C,{using:c}))})},e.ui.position={fit:{left:function(e,t){var i,n=t.within,s=n.isWindow?n.scrollLeft:n.offset.left,r=n.width,a=e.left-t.collisionPosition.marginLeft,l=s-a,c=a+t.collisionWidth-r-s;t.collisionWidth>r?l>0&&0>=c?(i=e.left+l+t.collisionWidth-r-s,e.left+=l-i):e.left=c>0&&0>=l?s:l>c?s+r-t.collisionWidth:s:l>0?e.left+=l:c>0?e.left-=c:e.left=o(e.left-a,e.left)},top:function(e,t){var i,n=t.within,s=n.isWindow?n.scrollTop:n.offset.top,r=t.within.height,a=e.top-t.collisionPosition.marginTop,l=s-a,c=a+t.collisionHeight-r-s;t.collisionHeight>r?l>0&&0>=c?(i=e.top+l+t.collisionHeight-r-s,e.top+=l-i):e.top=c>0&&0>=l?s:l>c?s+r-t.collisionHeight:s:l>0?e.top+=l:c>0?e.top-=c:e.top=o(e.top-a,e.top)}},flip:{left:function(e,t){var i,n,s=t.within,o=s.offset.left+s.scrollLeft,a=s.width,l=s.isWindow?s.scrollLeft:s.offset.left,c=e.left-t.collisionPosition.marginLeft,h=c-l,u=c+t.collisionWidth-a-l,p="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,d="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>h?(i=e.left+p+d+f+t.collisionWidth-a-o,(0>i||i<r(h))&&(e.left+=p+d+f)):u>0&&(n=e.left-t.collisionPosition.marginLeft+p+d+f-l,(n>0||r(n)<u)&&(e.left+=p+d+f))},top:function(e,t){var i,n,s=t.within,o=s.offset.top+s.scrollTop,a=s.height,l=s.isWindow?s.scrollTop:s.offset.top,c=e.top-t.collisionPosition.marginTop,h=c-l,u=c+t.collisionHeight-a-l,p="top"===t.my[1],d=p?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,g=-2*t.offset[1];0>h?(n=e.top+d+f+g+t.collisionHeight-a-o,e.top+d+f+g>h&&(0>n||n<r(h))&&(e.top+=d+f+g)):u>0&&(i=e.top-t.collisionPosition.marginTop+d+f+g-l,e.top+d+f+g>u&&(i>0||r(i)<u)&&(e.top+=d+f+g))
}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,n,s,o,r=document.getElementsByTagName("body")[0],a=document.createElement("div");t=document.createElement(r?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},r&&e.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in n)t.style[o]=n[o];t.appendChild(a),i=r||document.documentElement,i.insertBefore(t,i.firstChild),a.style.cssText="position: absolute; left: 10.7432222px;",s=e(a).offset().left,e.support.offsetFractions=s>10&&11>s,t.innerHTML="",i.removeChild(t)}(),e.uiBackCompat!==!1&&!function(e){var i=e.fn.position;e.fn.position=function(n){if(!n||!n.offset)return i.call(this,n);var s=n.offset.split(" "),o=n.at.split(" ");return 1===s.length&&(s[1]=s[0]),/^\d/.test(s[0])&&(s[0]="+"+s[0]),/^\d/.test(s[1])&&(s[1]="+"+s[1]),1===o.length&&(/left|center|right/.test(o[0])?o[1]="center":(o[1]=o[0],o[0]="center")),i.call(this,e.extend(n,{at:o[0]+s[0]+" "+o[1]+s[1],offset:t}))}}(jQuery)}(jQuery),function(e){e.widget("ui.draggable",e.ui.mouse,{version:"1.9.0",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"!=this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var i=this.options;return this.helper||i.disabled||e(t.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(t),this.handle?(e(i.iframeFix===!0?"iframe":i.iframeFix).each(function(){e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),i.containment&&this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,i){if(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(this._trigger("drag",t,n)===!1)return this._mouseUp({}),!1;this.position=n.position}return this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=!1;e.ui.ddmanager&&!this.options.dropBehaviour&&(i=e.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1);for(var n=this.element[0],s=!1;n&&(n=n.parentNode);)n==document&&(s=!0);if(!s&&"original"===this.options.helper)return!1;if("invalid"==this.options.revert&&!i||"valid"==this.options.revert&&i||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)){var o=this;e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){o._trigger("stop",t)!==!1&&o._clear()})}else this._trigger("stop",t)!==!1&&this._clear();return!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){var i=this.options.handle&&e(this.options.handle,this.element).length?!1:!0;return e(this.options.handle,this.element).find("*").andSelf().each(function(){this==t.target&&(i=!0)}),i},_createHelper:function(t){var i=this.options,n=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t])):"clone"==i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"==i.appendTo?this.element[0].parentNode:i.appendTo),n[0]==this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&e.browser.msie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;if("parent"==t.containment&&(t.containment=this.helper[0].parentNode),("document"==t.containment||"window"==t.containment)&&(this.containment=["document"==t.containment?0:e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"==t.containment?0:e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==t.containment?0:e(window).scrollLeft())+e("document"==t.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"==t.containment?0:e(window).scrollTop())+(e("document"==t.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(t.containment)||t.containment.constructor==Array)t.containment.constructor==Array&&(this.containment=t.containment);else{var i=e(t.containment),n=i[0];if(!n)return;i.offset();var s="hidden"!=e(n).css("overflow");this.containment=[(parseInt(e(n).css("borderLeftWidth"),10)||0)+(parseInt(e(n).css("paddingLeft"),10)||0),(parseInt(e(n).css("borderTopWidth"),10)||0)+(parseInt(e(n).css("paddingTop"),10)||0),(s?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(e(n).css("borderLeftWidth"),10)||0)-(parseInt(e(n).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(s?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(e(n).css("borderTopWidth"),10)||0)-(parseInt(e(n).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=i}},_convertPositionTo:function(t,i){i||(i=this.position);var n="absolute"==t?1:-1,s=(this.options,"absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent),o=/(html|body)/i.test(s[0].tagName);return{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():o?0:s.scrollTop())*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():o?0:s.scrollLeft())*n}},_generatePosition:function(t){var i=this.options,n="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(n[0].tagName),o=t.pageX,r=t.pageY;if(this.originalPosition){var a;if(this.containment){if(this.relative_container){var l=this.relative_container.offset();a=[this.containment[0]+l.left,this.containment[1]+l.top,this.containment[2]+l.left,this.containment[3]+l.top]}else a=this.containment;t.pageX-this.offset.click.left<a[0]&&(o=a[0]+this.offset.click.left),t.pageY-this.offset.click.top<a[1]&&(r=a[1]+this.offset.click.top),t.pageX-this.offset.click.left>a[2]&&(o=a[2]+this.offset.click.left),t.pageY-this.offset.click.top>a[3]&&(r=a[3]+this.offset.click.top)}if(i.grid){var c=i.grid[1]?this.originalPageY+Math.round((r-this.originalPageY)/i.grid[1])*i.grid[1]:this.originalPageY;r=a?c-this.offset.click.top<a[1]||c-this.offset.click.top>a[3]?c-this.offset.click.top<a[1]?c+i.grid[1]:c-i.grid[1]:c:c;var h=i.grid[0]?this.originalPageX+Math.round((o-this.originalPageX)/i.grid[0])*i.grid[0]:this.originalPageX;o=a?h-this.offset.click.left<a[0]||h-this.offset.click.left>a[2]?h-this.offset.click.left<a[0]?h+i.grid[0]:h-i.grid[0]:h:h}}return{top:r-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():s?0:n.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():s?0:n.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]==this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,i,n){return n=n||this._uiHash(),e.ui.plugin.call(this,t,[i,n]),"drag"==t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i){var n=e(this).data("draggable"),s=n.options,o=e.extend({},i,{item:n.element});n.sortables=[],e(s.connectToSortable).each(function(){var i=e.data(this,"sortable");i&&!i.options.disabled&&(n.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",t,o))})},stop:function(t,i){var n=e(this).data("draggable"),s=e.extend({},i,{item:n.element});e.each(n.sortables,function(){this.instance.isOver?(this.instance.isOver=0,n.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"==n.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,s))})},drag:function(t,i){var n=e(this).data("draggable"),s=this;e.each(n.sortables,function(){this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(s).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=n.offset.click.top,this.instance.offset.click.left=n.offset.click.left,this.instance.offset.parent.left-=n.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=n.offset.parent.top-this.instance.offset.parent.top,n._trigger("toSortable",t),n.dropped=this.instance.element,n.currentItem=n.element,this.instance.fromOutside=n),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),n._trigger("fromSortable",t),n.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),i=e(this).data("draggable").options;t.css("cursor")&&(i._cursor=t.css("cursor")),t.css("cursor",i.cursor)},stop:function(){var t=e(this).data("draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i){var n=e(i.helper),s=e(this).data("draggable").options;n.css("opacity")&&(s._opacity=n.css("opacity")),n.css("opacity",s.opacity)},stop:function(t,i){var n=e(this).data("draggable").options;n._opacity&&e(i.helper).css("opacity",n._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("draggable");t.scrollParent[0]!=document&&"HTML"!=t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var i=e(this).data("draggable"),n=i.options,s=!1;i.scrollParent[0]!=document&&"HTML"!=i.scrollParent[0].tagName?(n.axis&&"x"==n.axis||(i.overflowOffset.top+i.scrollParent[0].offsetHeight-t.pageY<n.scrollSensitivity?i.scrollParent[0].scrollTop=s=i.scrollParent[0].scrollTop+n.scrollSpeed:t.pageY-i.overflowOffset.top<n.scrollSensitivity&&(i.scrollParent[0].scrollTop=s=i.scrollParent[0].scrollTop-n.scrollSpeed)),n.axis&&"y"==n.axis||(i.overflowOffset.left+i.scrollParent[0].offsetWidth-t.pageX<n.scrollSensitivity?i.scrollParent[0].scrollLeft=s=i.scrollParent[0].scrollLeft+n.scrollSpeed:t.pageX-i.overflowOffset.left<n.scrollSensitivity&&(i.scrollParent[0].scrollLeft=s=i.scrollParent[0].scrollLeft-n.scrollSpeed))):(n.axis&&"x"==n.axis||(t.pageY-e(document).scrollTop()<n.scrollSensitivity?s=e(document).scrollTop(e(document).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<n.scrollSensitivity&&(s=e(document).scrollTop(e(document).scrollTop()+n.scrollSpeed))),n.axis&&"y"==n.axis||(t.pageX-e(document).scrollLeft()<n.scrollSensitivity?s=e(document).scrollLeft(e(document).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<n.scrollSensitivity&&(s=e(document).scrollLeft(e(document).scrollLeft()+n.scrollSpeed)))),s!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(i,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("draggable"),i=t.options;t.snapElements=[],e(i.snap.constructor!=String?i.snap.items||":data(draggable)":i.snap).each(function(){var i=e(this),n=i.offset();this!=t.element[0]&&t.snapElements.push({item:this,width:i.outerWidth(),height:i.outerHeight(),top:n.top,left:n.left})})},drag:function(t,i){for(var n=e(this).data("draggable"),s=n.options,o=s.snapTolerance,r=i.offset.left,a=r+n.helperProportions.width,l=i.offset.top,c=l+n.helperProportions.height,h=n.snapElements.length-1;h>=0;h--){var u=n.snapElements[h].left,p=u+n.snapElements[h].width,d=n.snapElements[h].top,f=d+n.snapElements[h].height;if(r>u-o&&p+o>r&&l>d-o&&f+o>l||r>u-o&&p+o>r&&c>d-o&&f+o>c||a>u-o&&p+o>a&&l>d-o&&f+o>l||a>u-o&&p+o>a&&c>d-o&&f+o>c){if("inner"!=s.snapMode){var g=Math.abs(d-c)<=o,m=Math.abs(f-l)<=o,v=Math.abs(u-a)<=o,_=Math.abs(p-r)<=o;g&&(i.position.top=n._convertPositionTo("relative",{top:d-n.helperProportions.height,left:0}).top-n.margins.top),m&&(i.position.top=n._convertPositionTo("relative",{top:f,left:0}).top-n.margins.top),v&&(i.position.left=n._convertPositionTo("relative",{top:0,left:u-n.helperProportions.width}).left-n.margins.left),_&&(i.position.left=n._convertPositionTo("relative",{top:0,left:p}).left-n.margins.left)}var y=g||m||v||_;if("outer"!=s.snapMode){var g=Math.abs(d-l)<=o,m=Math.abs(f-c)<=o,v=Math.abs(u-r)<=o,_=Math.abs(p-a)<=o;g&&(i.position.top=n._convertPositionTo("relative",{top:d,left:0}).top-n.margins.top),m&&(i.position.top=n._convertPositionTo("relative",{top:f-n.helperProportions.height,left:0}).top-n.margins.top),v&&(i.position.left=n._convertPositionTo("relative",{top:0,left:u}).left-n.margins.left),_&&(i.position.left=n._convertPositionTo("relative",{top:0,left:p-n.helperProportions.width}).left-n.margins.left)}!n.snapElements[h].snapping&&(g||m||v||_||y)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,t,e.extend(n._uiHash(),{snapItem:n.snapElements[h].item})),n.snapElements[h].snapping=g||m||v||_||y}else n.snapElements[h].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,t,e.extend(n._uiHash(),{snapItem:n.snapElements[h].item})),n.snapElements[h].snapping=!1}}}),e.ui.plugin.add("draggable","stack",{start:function(){var t=e(this).data("draggable").options,i=e.makeArray(e(t.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});if(i.length){var n=parseInt(i[0].style.zIndex)||0;e(i).each(function(e){this.style.zIndex=n+e}),this[0].style.zIndex=n+i.length}}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i){var n=e(i.helper),s=e(this).data("draggable").options;n.css("zIndex")&&(s._zIndex=n.css("zIndex")),n.css("zIndex",s.zIndex)},stop:function(t,i){var n=e(this).data("draggable").options;n._zIndex&&e(i.helper).css("zIndex",n._zIndex)}})}(jQuery),function(e){e.widget("ui.resizable",e.ui.mouse,{version:"1.9.0",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1e3},_create:function(){var t=this,i=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!i.aspectRatio,aspectRatio:i.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:i.helper||i.ghost||i.animate?i.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=i.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor==String){"all"==this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");var n=this.handles.split(",");this.handles={};for(var s=0;s<n.length;s++){var o=e.trim(n[s]),r="ui-resizable-"+o,a=e('<div class="ui-resizable-handle '+r+'"></div>');a.css({zIndex:i.zIndex}),"se"==o&&a.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[o]=".ui-resizable-"+o,this.element.append(a)}}this._renderAxis=function(t){t=t||this.element;for(var i in this.handles){if(this.handles[i].constructor==String&&(this.handles[i]=e(this.handles[i],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var n=e(this.handles[i],this.element),s=0;s=/sw|ne|nw|se|n|s/.test(i)?n.outerHeight():n.outerWidth();var o=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join("");t.css(o,s),this._proportionallyResize()}e(this.handles[i]).length}},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){if(!t.resizing){if(this.className)var e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);t.axis=e&&e[1]?e[1]:"se"}}),i.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){i.disabled||(e(this).removeClass("ui-resizable-autohide"),t._handles.show())}).mouseleave(function(){i.disabled||t.resizing||(e(this).addClass("ui-resizable-autohide"),t._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){t(this.element);var i=this.element;i.after(this.originalElement.css({position:i.css("position"),width:i.outerWidth(),height:i.outerHeight(),top:i.css("top"),left:i.css("left")})).remove()}return this.originalElement.css("resize",this.originalResizeStyle),t(this.originalElement),this},_mouseCapture:function(t){var i=!1;for(var n in this.handles)e(this.handles[n])[0]==t.target&&(i=!0);return!this.options.disabled&&i},_mouseStart:function(i){var n=this.options,s=this.element.position(),o=this.element;this.resizing=!0,this.documentScroll={top:e(document).scrollTop(),left:e(document).scrollLeft()},(o.is(".ui-draggable")||/absolute/.test(o.css("position")))&&o.css({position:"absolute",top:s.top,left:s.left}),this._renderProxy();var r=t(this.helper.css("left")),a=t(this.helper.css("top"));n.containment&&(r+=e(n.containment).scrollLeft()||0,a+=e(n.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:r,top:a},this.size=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.originalPosition={left:r,top:a},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalMousePosition={left:i.pageX,top:i.pageY},this.aspectRatio="number"==typeof n.aspectRatio?n.aspectRatio:this.originalSize.width/this.originalSize.height||1;var l=e(".ui-resizable-"+this.axis).css("cursor");return e("body").css("cursor","auto"==l?this.axis+"-resize":l),o.addClass("ui-resizable-resizing"),this._propagate("start",i),!0},_mouseDrag:function(e){var t=this.helper,i=(this.options,this.originalMousePosition),n=this.axis,s=e.pageX-i.left||0,o=e.pageY-i.top||0,r=this._change[n];if(!r)return!1;var a=r.apply(this,[e,s,o]);return this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(a=this._updateRatio(a,e)),a=this._respectSize(a,e),this._propagate("resize",e),t.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(a),this._trigger("resize",e,this.ui()),!1},_mouseStop:function(t){this.resizing=!1;var i=this.options,n=this;if(this._helper){var s=this._proportionallyResizeElements,o=s.length&&/textarea/i.test(s[0].nodeName),r=o&&e.ui.hasScroll(s[0],"left")?0:n.sizeDiff.height,a=o?0:n.sizeDiff.width,l={width:n.helper.width()-a,height:n.helper.height()-r},c=parseInt(n.element.css("left"),10)+(n.position.left-n.originalPosition.left)||null,h=parseInt(n.element.css("top"),10)+(n.position.top-n.originalPosition.top)||null;i.animate||this.element.css(e.extend(l,{top:h,left:c})),n.helper.height(n.size.height),n.helper.width(n.size.width),this._helper&&!i.animate&&this._proportionallyResize()}return e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,n,s,o,r,a=this.options;r={minWidth:i(a.minWidth)?a.minWidth:0,maxWidth:i(a.maxWidth)?a.maxWidth:1/0,minHeight:i(a.minHeight)?a.minHeight:0,maxHeight:i(a.maxHeight)?a.maxHeight:1/0},(this._aspectRatio||e)&&(t=r.minHeight*this.aspectRatio,s=r.minWidth/this.aspectRatio,n=r.maxHeight*this.aspectRatio,o=r.maxWidth/this.aspectRatio,t>r.minWidth&&(r.minWidth=t),s>r.minHeight&&(r.minHeight=s),n<r.maxWidth&&(r.maxWidth=n),o<r.maxHeight&&(r.maxHeight=o)),this._vBoundaries=r},_updateCache:function(e){this.options,this.offset=this.helper.offset(),i(e.left)&&(this.position.left=e.left),i(e.top)&&(this.position.top=e.top),i(e.height)&&(this.size.height=e.height),i(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=(this.options,this.position),n=this.size,s=this.axis;return i(e.height)?e.width=e.height*this.aspectRatio:i(e.width)&&(e.height=e.width/this.aspectRatio),"sw"==s&&(e.left=t.left+(n.width-e.width),e.top=null),"nw"==s&&(e.top=t.top+(n.height-e.height),e.left=t.left+(n.width-e.width)),e},_respectSize:function(e,t){var n=(this.helper,this._vBoundaries),s=(this._aspectRatio||t.shiftKey,this.axis),o=i(e.width)&&n.maxWidth&&n.maxWidth<e.width,r=i(e.height)&&n.maxHeight&&n.maxHeight<e.height,a=i(e.width)&&n.minWidth&&n.minWidth>e.width,l=i(e.height)&&n.minHeight&&n.minHeight>e.height;a&&(e.width=n.minWidth),l&&(e.height=n.minHeight),o&&(e.width=n.maxWidth),r&&(e.height=n.maxHeight);var c=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,u=/sw|nw|w/.test(s),p=/nw|ne|n/.test(s);a&&u&&(e.left=c-n.minWidth),o&&u&&(e.left=c-n.maxWidth),l&&p&&(e.top=h-n.minHeight),r&&p&&(e.top=h-n.maxHeight);var d=!e.width&&!e.height;return d&&!e.left&&e.top?e.top=null:d&&!e.top&&e.left&&(e.left=null),e},_proportionallyResize:function(){if(this.options,this._proportionallyResizeElements.length)for(var t=this.helper||this.element,i=0;i<this._proportionallyResizeElements.length;i++){var n=this._proportionallyResizeElements[i];if(!this.borderDif){var s=[n.css("borderTopWidth"),n.css("borderRightWidth"),n.css("borderBottomWidth"),n.css("borderLeftWidth")],o=[n.css("paddingTop"),n.css("paddingRight"),n.css("paddingBottom"),n.css("paddingLeft")];this.borderDif=e.map(s,function(e,t){var i=parseInt(e,10)||0,n=parseInt(o[t],10)||0;return i+n})}n.css({height:t.height()-this.borderDif[0]-this.borderDif[2]||0,width:t.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var t=this.element,i=this.options;if(this.elementOffset=t.offset(),this._helper){this.helper=this.helper||e('<div style="overflow:hidden;"></div>');var n=e.browser.msie&&e.browser.version<7,s=n?1:0,o=n?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+o,height:this.element.outerHeight()+o,position:"absolute",left:this.elementOffset.left-s+"px",top:this.elementOffset.top-s+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=(this.options,this.originalSize),n=this.originalPosition;return{left:n.left+t,width:i.width-t}},n:function(e,t,i){var n=(this.options,this.originalSize),s=this.originalPosition;return{top:s.top+i,height:n.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,n){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,n]))},sw:function(t,i,n){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,n]))},ne:function(t,i,n){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,n]))},nw:function(t,i,n){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,n]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),"resize"!=t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).data("resizable"),i=t.options,n=function(t){e(t).each(function(){var t=e(this);t.data("resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof i.alsoResize||i.alsoResize.parentNode?n(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],n(i.alsoResize)):e.each(i.alsoResize,function(e){n(e)})},resize:function(t,i){var n=e(this).data("resizable"),s=n.options,o=n.originalSize,r=n.originalPosition,a={height:n.size.height-o.height||0,width:n.size.width-o.width||0,top:n.position.top-r.top||0,left:n.position.left-r.left||0},l=function(t,n){e(t).each(function(){var t=e(this),s=e(this).data("resizable-alsoresize"),o={},r=n&&n.length?n:t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(r,function(e,t){var i=(s[t]||0)+(a[t]||0);i&&i>=0&&(o[t]=i||null)}),t.css(o)})};"object"!=typeof s.alsoResize||s.alsoResize.nodeType?l(s.alsoResize):e.each(s.alsoResize,function(e,t){l(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).data("resizable"),n=i.options,s=i._proportionallyResizeElements,o=s.length&&/textarea/i.test(s[0].nodeName),r=o&&e.ui.hasScroll(s[0],"left")?0:i.sizeDiff.height,a=o?0:i.sizeDiff.width,l={width:i.size.width-a,height:i.size.height-r},c=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,h=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(l,h&&c?{top:h,left:c}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var n={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};s&&s.length&&e(s[0]).css({width:n.width,height:n.height}),i._updateCache(n),i._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var i=e(this).data("resizable"),n=i.options,s=i.element,o=n.containment,r=o instanceof e?o.get(0):/parent/.test(o)?s.parent().get(0):o;
if(r)if(i.containerElement=e(r),/document/.test(o)||o==document)i.containerOffset={left:0,top:0},i.containerPosition={left:0,top:0},i.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight};else{var a=e(r),l=[];e(["Top","Right","Left","Bottom"]).each(function(e,i){l[e]=t(a.css("padding"+i))}),i.containerOffset=a.offset(),i.containerPosition=a.position(),i.containerSize={height:a.innerHeight()-l[3],width:a.innerWidth()-l[1]};var c=i.containerOffset,h=i.containerSize.height,u=i.containerSize.width,p=e.ui.hasScroll(r,"left")?r.scrollWidth:u,d=e.ui.hasScroll(r)?r.scrollHeight:h;i.parentData={element:r,left:c.left,top:c.top,width:p,height:d}}},resize:function(t){var i=e(this).data("resizable"),n=i.options,s=(i.containerSize,i.containerOffset),o=(i.size,i.position),r=i._aspectRatio||t.shiftKey,a={top:0,left:0},l=i.containerElement;l[0]!=document&&/static/.test(l.css("position"))&&(a=s),o.left<(i._helper?s.left:0)&&(i.size.width=i.size.width+(i._helper?i.position.left-s.left:i.position.left-a.left),r&&(i.size.height=i.size.width/i.aspectRatio),i.position.left=n.helper?s.left:0),o.top<(i._helper?s.top:0)&&(i.size.height=i.size.height+(i._helper?i.position.top-s.top:i.position.top),r&&(i.size.width=i.size.height*i.aspectRatio),i.position.top=i._helper?s.top:0),i.offset.left=i.parentData.left+i.position.left,i.offset.top=i.parentData.top+i.position.top;var c=Math.abs((i._helper?i.offset.left-a.left:i.offset.left-a.left)+i.sizeDiff.width),h=Math.abs((i._helper?i.offset.top-a.top:i.offset.top-s.top)+i.sizeDiff.height),u=i.containerElement.get(0)==i.element.parent().get(0),p=/relative|absolute/.test(i.containerElement.css("position"));u&&p&&(c-=i.parentData.left),c+i.size.width>=i.parentData.width&&(i.size.width=i.parentData.width-c,r&&(i.size.height=i.size.width/i.aspectRatio)),h+i.size.height>=i.parentData.height&&(i.size.height=i.parentData.height-h,r&&(i.size.width=i.size.height*i.aspectRatio))},stop:function(){var t=e(this).data("resizable"),i=t.options,n=(t.position,t.containerOffset),s=t.containerPosition,o=t.containerElement,r=e(t.helper),a=r.offset(),l=r.outerWidth()-t.sizeDiff.width,c=r.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(o.css("position"))&&e(this).css({left:a.left-s.left-n.left,width:l,height:c}),t._helper&&!i.animate&&/static/.test(o.css("position"))&&e(this).css({left:a.left-s.left-n.left,width:l,height:c})}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).data("resizable"),i=t.options,n=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:n.height,width:n.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).data("resizable");t.options,t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).data("resizable");t.options,t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(t){var i=e(this).data("resizable"),n=i.options,s=i.size,o=i.originalSize,r=i.originalPosition,a=i.axis;n._aspectRatio||t.shiftKey,n.grid="number"==typeof n.grid?[n.grid,n.grid]:n.grid;var l=Math.round((s.width-o.width)/(n.grid[0]||1))*(n.grid[0]||1),c=Math.round((s.height-o.height)/(n.grid[1]||1))*(n.grid[1]||1);/^(se|s|e)$/.test(a)?(i.size.width=o.width+l,i.size.height=o.height+c):/^(ne)$/.test(a)?(i.size.width=o.width+l,i.size.height=o.height+c,i.position.top=r.top-c):/^(sw)$/.test(a)?(i.size.width=o.width+l,i.size.height=o.height+c,i.position.left=r.left-l):(i.size.width=o.width+l,i.size.height=o.height+c,i.position.top=r.top-c,i.position.left=r.left-l)}});var t=function(e){return parseInt(e,10)||0},i=function(e){return!isNaN(parseInt(e,10))}}(jQuery),function(e){var t,i,n,s,o="ui-button ui-widget ui-state-default ui-corner-all",r="ui-state-hover ui-state-active ",a="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",l=function(){var t=e(this).find(":ui-button");setTimeout(function(){t.button("refresh")},1)},c=function(t){var i=t.name,n=t.form,s=e([]);return i&&(s=n?e(n).find("[name='"+i+"']"):e("[name='"+i+"']",t.ownerDocument).filter(function(){return!this.form})),s};e.widget("ui.button",{version:"1.9.0",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,l),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var r=this,a=this.options,h="checkbox"===this.type||"radio"===this.type,u="ui-state-hover"+(h?"":" ui-state-active"),p="ui-state-focus";null===a.label&&(a.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this.buttonElement.addClass(o).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){a.disabled||(e(this).addClass("ui-state-hover"),this===t&&e(this).addClass("ui-state-active"))}).bind("mouseleave"+this.eventNamespace,function(){a.disabled||e(this).removeClass(u)}).bind("click"+this.eventNamespace,function(e){a.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){r.buttonElement.addClass(p)}).bind("blur"+this.eventNamespace,function(){r.buttonElement.removeClass(p)}),h&&(this.element.bind("change"+this.eventNamespace,function(){s||r.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(e){a.disabled||(s=!1,i=e.pageX,n=e.pageY)}).bind("mouseup"+this.eventNamespace,function(e){a.disabled||(i!==e.pageX||n!==e.pageY)&&(s=!0)})),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return a.disabled||s?!1:(e(this).toggleClass("ui-state-active"),r.buttonElement.attr("aria-pressed",r.element[0].checked),void 0)}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(a.disabled||s)return!1;e(this).addClass("ui-state-active"),r.buttonElement.attr("aria-pressed","true");var t=r.element[0];c(t).not(t).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return a.disabled?!1:(e(this).addClass("ui-state-active"),t=this,r.document.one("mouseup",function(){t=null}),void 0)}).bind("mouseup"+this.eventNamespace,function(){return a.disabled?!1:(e(this).removeClass("ui-state-active"),void 0)}).bind("keydown"+this.eventNamespace,function(t){return a.disabled?!1:((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"),void 0)}).bind("keyup"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",a.disabled),this._resetButton()},_determineButtonType:function(){var e,t,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(o+" "+r+" "+a).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(t?this.element.prop("disabled",!0):this.element.prop("disabled",!1),void 0):(this._resetButton(),void 0)},refresh:function(){var t=this.element.is(":disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?c(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return this.options.label&&this.element.val(this.options.label),void 0;var t=this.buttonElement.removeClass(a),i=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),n=this.options.icons,s=n.primary&&n.secondary,o=[];n.primary||n.secondary?(this.options.text&&o.push("ui-button-text-icon"+(s?"s":n.primary?"-primary":"-secondary")),n.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+n.primary+"'></span>"),n.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+n.secondary+"'></span>"),this.options.text||(o.push(s?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(i)))):o.push("ui-button-text-only"),t.addClass(o.join(" "))}}),e.widget("ui.buttonset",{version:"1.9.0",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function(e,t){var i="ui-dialog ui-widget ui-widget-content ui-corner-all ",n={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},s={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};e.widget("ui.dialog",{version:"1.9.0",options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var i=e(this).css(t).offset().top;0>i&&e(this).css("top",t.top-i)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1e3},_create:function(){this.originalTitle=this.element.attr("title"),"string"!=typeof this.originalTitle&&(this.originalTitle=""),this.oldPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.options.title=this.options.title||this.originalTitle;var t=this,n=this.options,s=n.title||"&#160;",o=(this.uiDialog=e("<div>")).addClass(i+n.dialogClass).css({display:"none",outline:0,zIndex:n.zIndex}).attr("tabIndex",-1).keydown(function(i){n.closeOnEscape&&!i.isDefaultPrevented()&&i.keyCode&&i.keyCode===e.ui.keyCode.ESCAPE&&(t.close(i),i.preventDefault())}).mousedown(function(e){t.moveToTop(!1,e)}).appendTo("body"),r=(this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(o),(this.uiDialogTitlebar=e("<div>")).addClass("ui-dialog-titlebar  ui-widget-header  ui-corner-all  ui-helper-clearfix").prependTo(o)),a=e("<a href='#'></a>").addClass("ui-dialog-titlebar-close  ui-corner-all").attr("role","button").click(function(e){e.preventDefault(),t.close(e)}).appendTo(r),l=((this.uiDialogTitlebarCloseText=e("<span>")).addClass("ui-icon ui-icon-closethick").text(n.closeText).appendTo(a),e("<span>").uniqueId().addClass("ui-dialog-title").html(s).prependTo(r)),c=(this.uiDialogButtonPane=e("<div>")).addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");(this.uiButtonSet=e("<div>")).addClass("ui-dialog-buttonset").appendTo(c),o.attr({role:"dialog","aria-labelledby":l.attr("id")}),r.find("*").add(r).disableSelection(),this._hoverable(a),this._focusable(a),n.draggable&&e.fn.draggable&&this._makeDraggable(),n.resizable&&e.fn.resizable&&this._makeResizable(),this._createButtons(n.buttons),this._isOpen=!1,e.fn.bgiframe&&o.bgiframe(),this._on(o,{keydown:function(t){if(n.modal&&t.keyCode===e.ui.keyCode.TAB){var i=e(":tabbable",o),s=i.filter(":first"),r=i.filter(":last");return t.target!==r[0]||t.shiftKey?t.target===s[0]&&t.shiftKey?(r.focus(1),!1):void 0:(s.focus(1),!1)}}})},_init:function(){this.options.autoOpen&&this.open()},_destroy:function(){var e,t=this.oldPosition;this.overlay&&this.overlay.destroy(),this.uiDialog.hide(),this.element.removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},close:function(t){var i,n,s=this;if(this._isOpen&&!1!==this._trigger("beforeClose",t))return this._isOpen=!1,this.overlay&&this.overlay.destroy(),this.options.hide?this.uiDialog.hide(this.options.hide,function(){s._trigger("close",t)}):(this.uiDialog.hide(),this._trigger("close",t)),e.ui.dialog.overlay.resize(),this.options.modal&&(i=0,e(".ui-dialog").each(function(){this!==s.uiDialog[0]&&(n=e(this).css("z-index"),isNaN(n)||(i=Math.max(i,n)))}),e.ui.dialog.maxZ=i),this},isOpen:function(){return this._isOpen},moveToTop:function(t,i){var n,s=this.options;return s.modal&&!t||!s.stack&&!s.modal?this._trigger("focus",i):(s.zIndex>e.ui.dialog.maxZ&&(e.ui.dialog.maxZ=s.zIndex),this.overlay&&(e.ui.dialog.maxZ+=1,e.ui.dialog.overlay.maxZ=e.ui.dialog.maxZ,this.overlay.$el.css("z-index",e.ui.dialog.overlay.maxZ)),n={scrollTop:this.element.scrollTop(),scrollLeft:this.element.scrollLeft()},e.ui.dialog.maxZ+=1,this.uiDialog.css("z-index",e.ui.dialog.maxZ),this.element.attr(n),this._trigger("focus",i),this)},open:function(){if(!this._isOpen){var t,i=this.options,n=this.uiDialog;return this._size(),this._position(i.position),n.show(i.show),this.overlay=i.modal?new e.ui.dialog.overlay(this):null,this.moveToTop(!0),t=this.element.find(":tabbable"),t.length||(t=this.uiDialogButtonPane.find(":tabbable"),t.length||(t=n)),t.eq(0).focus(),this._isOpen=!0,this._trigger("open"),this}},_createButtons:function(t){var i=this,n=!1;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),"object"==typeof t&&null!==t&&e.each(t,function(){return!(n=!0)}),n?(e.each(t,function(t,n){n=e.isFunction(n)?{click:n,text:t}:n;var s=e("<button type='button'>").attr(n,!0).unbind("click").click(function(){n.click.apply(i.element[0],arguments)}).appendTo(i.uiButtonSet);e.fn.button&&s.button()}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)):this.uiDialog.removeClass("ui-dialog-buttons")},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var i=this,n=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,s){e(this).addClass("ui-dialog-dragging"),i._trigger("dragStart",n,t(s))},drag:function(e,n){i._trigger("drag",e,t(n))},stop:function(s,o){n.position=[o.position.left-i.document.scrollLeft(),o.position.top-i.document.scrollTop()],e(this).removeClass("ui-dialog-dragging"),i._trigger("dragStop",s,t(o)),e.ui.dialog.overlay.resize()}})},_makeResizable:function(i){function n(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}i=i===t?this.options.resizable:i;var s=this,o=this.options,r=this.uiDialog.css("position"),a="string"==typeof i?i:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:o.maxWidth,maxHeight:o.maxHeight,minWidth:o.minWidth,minHeight:this._minHeight(),handles:a,start:function(t,i){e(this).addClass("ui-dialog-resizing"),s._trigger("resizeStart",t,n(i))},resize:function(e,t){s._trigger("resize",e,n(t))},stop:function(t,i){e(this).removeClass("ui-dialog-resizing"),o.height=e(this).height(),o.width=e(this).width(),s._trigger("resizeStop",t,n(i)),e.ui.dialog.overlay.resize()}}).css("position",r).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(t){var i,n=[],s=[0,0];t?(("string"==typeof t||"object"==typeof t&&"0"in t)&&(n=t.split?t.split(" "):[t[0],t[1]],1===n.length&&(n[1]=n[0]),e.each(["left","top"],function(e,t){+n[e]===n[e]&&(s[e]=n[e],n[e]=t)}),t={my:n.join(" "),at:n.join(" "),offset:s.join(" ")}),t=e.extend({},e.ui.dialog.prototype.options.position,t)):t=e.ui.dialog.prototype.options.position,i=this.uiDialog.is(":visible"),i||this.uiDialog.show(),this.uiDialog.position(t),i||this.uiDialog.hide()},_setOptions:function(t){var i=this,o={},r=!1;e.each(t,function(e,t){i._setOption(e,t),e in n&&(r=!0),e in s&&(o[e]=t)}),r&&this._size(),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",o)},_setOption:function(t,n){var s,o,r=this.uiDialog;switch(t){case"buttons":this._createButtons(n);break;case"closeText":this.uiDialogTitlebarCloseText.text(""+n);break;case"dialogClass":r.removeClass(this.options.dialogClass).addClass(i+n);break;case"disabled":n?r.addClass("ui-dialog-disabled"):r.removeClass("ui-dialog-disabled");break;case"draggable":s=r.is(":data(draggable)"),s&&!n&&r.draggable("destroy"),!s&&n&&this._makeDraggable();break;case"position":this._position(n);break;case"resizable":o=r.is(":data(resizable)"),o&&!n&&r.resizable("destroy"),o&&"string"==typeof n&&r.resizable("option","handles",n),o||n===!1||this._makeResizable(n);break;case"title":e(".ui-dialog-title",this.uiDialogTitlebar).html(""+(n||"&#160;"))}this._super(t,n)},_size:function(){var t,i,n,s=this.options,o=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0}),s.minWidth>s.width&&(s.width=s.minWidth),t=this.uiDialog.css({height:"auto",width:s.width}).outerHeight(),i=Math.max(0,s.minHeight-t),"auto"===s.height?e.support.minHeight?this.element.css({minHeight:i,height:"auto"}):(this.uiDialog.show(),n=this.element.css("height","auto").height(),o||this.uiDialog.hide(),this.element.height(Math.max(n,i))):this.element.height(Math.max(s.height-t,0)),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}}),e.extend(e.ui.dialog,{uuid:0,maxZ:0,getTitleId:function(e){var t=e.attr("id");return t||(this.uuid+=1,t=this.uuid),"ui-dialog-title-"+t},overlay:function(t){this.$el=e.ui.dialog.overlay.create(t)}}),e.extend(e.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:e.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(e){return e+".dialog-overlay"}).join(" "),create:function(t){0===this.instances.length&&(setTimeout(function(){e.ui.dialog.overlay.instances.length&&e(document).bind(e.ui.dialog.overlay.events,function(t){return e(t.target).zIndex()<e.ui.dialog.overlay.maxZ?!1:void 0})},1),e(window).bind("resize.dialog-overlay",e.ui.dialog.overlay.resize));var i=this.oldInstances.pop()||e("<div>").addClass("ui-widget-overlay");return e(document).bind("keydown.dialog-overlay",function(n){var s=e.ui.dialog.overlay.instances;0!==s.length&&s[s.length-1]===i&&t.options.closeOnEscape&&!n.isDefaultPrevented()&&n.keyCode&&n.keyCode===e.ui.keyCode.ESCAPE&&(t.close(n),n.preventDefault())}),i.appendTo(document.body).css({width:this.width(),height:this.height()}),e.fn.bgiframe&&i.bgiframe(),this.instances.push(i),i},destroy:function(t){var i=e.inArray(t,this.instances),n=0;-1!==i&&this.oldInstances.push(this.instances.splice(i,1)[0]),0===this.instances.length&&e([document,window]).unbind(".dialog-overlay"),t.height(0).width(0).remove(),e.each(this.instances,function(){n=Math.max(n,this.css("z-index"))}),this.maxZ=n},height:function(){var t,i;return e.browser.msie?(t=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),i=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),i>t?e(window).height()+"px":t+"px"):e(document).height()+"px"},width:function(){var t,i;return e.browser.msie?(t=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),i=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),i>t?e(window).width()+"px":t+"px"):e(document).width()+"px"},resize:function(){var t=e([]);e.each(e.ui.dialog.overlay.instances,function(){t=t.add(this)}),t.css({width:0,height:0}).css({width:e.ui.dialog.overlay.width(),height:e.ui.dialog.overlay.height()})}}),e.extend(e.ui.dialog.overlay.prototype,{destroy:function(){e.ui.dialog.overlay.destroy(this.$el)}})}(jQuery),function(e){var t=5;e.widget("ui.slider",e.ui.mouse,{version:"1.9.0",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var i,n=this.options,s=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),o="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",r=n.values&&n.values.length||1,a=[];for(this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"+(n.disabled?" ui-slider-disabled ui-disabled":"")),this.range=e([]),n.range&&(n.range===!0&&(n.values||(n.values=[this._valueMin(),this._valueMin()]),n.values.length&&2!==n.values.length&&(n.values=[n.values[0],n.values[0]])),this.range=e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===n.range||"max"===n.range?" ui-slider-range-"+n.range:""))),i=s.length;r>i;i++)a.push(o);this.handles=s.add(e(a.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(e){e.preventDefault()}).mouseenter(function(){n.disabled||e(this).addClass("ui-state-hover")}).mouseleave(function(){e(this).removeClass("ui-state-hover")}).focus(function(){n.disabled?e(this).blur():(e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),e(this).addClass("ui-state-focus"))}).blur(function(){e(this).removeClass("ui-state-focus")}),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)}),this._on(this.handles,{keydown:function(i){var n,s,o,r,a=e(i.target).data("ui-slider-handle-index");switch(i.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(i.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(i.target).addClass("ui-state-active"),n=this._start(i,a),n===!1))return}switch(r=this.options.step,s=o=this.options.values&&this.options.values.length?this.values(a):this.value(),i.keyCode){case e.ui.keyCode.HOME:o=this._valueMin();break;case e.ui.keyCode.END:o=this._valueMax();break;case e.ui.keyCode.PAGE_UP:o=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.PAGE_DOWN:o=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(s===this._valueMax())return;o=this._trimAlignValue(s+r);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(s===this._valueMin())return;o=this._trimAlignValue(s-r)}this._slide(i,a,o)},keyup:function(t){var i=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,i),this._change(t,i),e(t.target).removeClass("ui-state-active"))}}),this._refreshValue(),this._animateOff=!1},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var i,n,s,o,r,a,l,c,h=this,u=this.options;return u.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:t.pageX,y:t.pageY},n=this._normValueFromMouse(i),s=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var i=Math.abs(n-h.values(t));s>i&&(s=i,o=e(this),r=t)}),u.range===!0&&this.values(1)===u.min&&(r+=1,o=e(this.handles[r])),a=this._start(t,r),a===!1?!1:(this._mouseSliding=!0,this._handleIndex=r,o.addClass("ui-state-active").focus(),l=o.offset(),c=!e(t.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=c?{left:0,top:0}:{left:t.pageX-l.left-o.width()/2,top:t.pageY-l.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,r,n),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,i),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,n,s,o;return"horizontal"===this.orientation?(t=this.elementSize.width,i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),n=i/t,n>1&&(n=1),0>n&&(n=0),"vertical"===this.orientation&&(n=1-n),s=this._valueMax()-this._valueMin(),o=this._valueMin()+n*s,this._trimAlignValue(o)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("start",e,i)},_slide:function(e,t,i){var n,s,o;this.options.values&&this.options.values.length?(n=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&i>n||1===t&&n>i)&&(i=n),i!==this.values(t)&&(s=this.values(),s[t]=i,o=this._trigger("slide",e,{handle:this.handles[t],value:i,values:s}),n=this.values(t?0:1),o!==!1&&this.values(t,i,!0))):i!==this.value()&&(o=this._trigger("slide",e,{handle:this.handles[t],value:i}),o!==!1&&this.value(i))},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("stop",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("change",e,i)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(t,i){var n,s,o;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(i),this._refreshValue(),this._change(null,t),void 0;if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(n=this.options.values,s=arguments[0],o=0;o<n.length;o+=1)n[o]=this._trimAlignValue(s[o]),this._change(null,o);this._refreshValue()},_setOption:function(t,i){var n,s=0;switch(e.isArray(this.options.values)&&(s=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments),t){case"disabled":i?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",!1),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),n=0;s>n;n+=1)this._change(null,n);this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,i,n;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);for(i=this.options.values.slice(),n=0;n<i.length;n+=1)i[n]=this._trimAlignValue(i[n]);return i},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,n=e-i;return 2*Math.abs(i)>=t&&(n+=i>0?t:-t),parseFloat(n.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,i,n,s,o,r=this.options.range,a=this.options,l=this,c=this._animateOff?!1:a.animate,h={};this.options.values&&this.options.values.length?this.handles.each(function(n){i=100*((l.values(n)-l._valueMin())/(l._valueMax()-l._valueMin())),h["horizontal"===l.orientation?"left":"bottom"]=i+"%",e(this).stop(1,1)[c?"animate":"css"](h,a.animate),l.options.range===!0&&("horizontal"===l.orientation?(0===n&&l.range.stop(1,1)[c?"animate":"css"]({left:i+"%"},a.animate),1===n&&l.range[c?"animate":"css"]({width:i-t+"%"},{queue:!1,duration:a.animate})):(0===n&&l.range.stop(1,1)[c?"animate":"css"]({bottom:i+"%"},a.animate),1===n&&l.range[c?"animate":"css"]({height:i-t+"%"},{queue:!1,duration:a.animate}))),t=i}):(n=this.value(),s=this._valueMin(),o=this._valueMax(),i=o!==s?100*((n-s)/(o-s)):0,h["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[c?"animate":"css"](h,a.animate),"min"===r&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:i+"%"},a.animate),"max"===r&&"horizontal"===this.orientation&&this.range[c?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:a.animate}),"min"===r&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:i+"%"},a.animate),"max"===r&&"vertical"===this.orientation&&this.range[c?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:a.animate}))}})}(jQuery),mmf_mapping_api.define("jquery_ui",["jquery"],function(){}),mmf_mapping_api.define("utils/processing",["jquery","pubsub","uris","jquery_ui"],function(e,t,i){var n=e("<div>").css({textAlign:"center"}),s=e("<p>"),o=e("<img>").attr({src:i.img+"loading.gif"}),r=0;n.append(s,o).dialog({autoOpen:!1,closeOnEscape:!1,draggable:!1,modal:!0,open:function(){e(this.parentNode).find(".ui-dialog-titlebar-close").hide()},resizable:!1}),t.subscribe("start.processing",function(e,t){r++,r>1||(s.text(t.text),n.dialog("open"))
}),t.subscribe("end.processing",function(){r--,0===r&&n.dialog("close")})}),mmf_mapping_api.define("utils/gtm",[],function(){var e;return window.dataLayer?e=window.dataLayer:(e=[],window.dataLayer=e),e}),mmf_mapping_api.define("classes/UserInterface",["jquery","pubsub","logger","message_mgr","utils/calculations","utils/map_helpers","utils/processing","map_configs","constants","config/marker_def","units","uris","storage","classes/Class","utils/gtm","jquery_ui"],function(e,t,i,n,s,o,r,a,l,c,h,u,p,d,f,g,m){window.mmf;var v=d.extend({init:function(t){this.map_id=t.map_id,this.map=t.map,this.Map=t.Map,this.map_config=a.get(this.map_id),this.container=e(t.container),this.travel_modes_switcher=null,this.bicycling_directions_unverified=null,this.map_control_toolbar=null;var i=this;o.loadCss(u.css+"mapping-api.css");var n={cue_notes:this.map_config.user_interface.display.directions,distance:this.map_config.user_interface.display.distance,elevation:this.map_config.user_interface.display.elevation};for(var s in n)n.hasOwnProperty(s)&&this.initDisplayElement(s,n[s]);this.map_config.map.display.map_control_toolbar!==!1&&this.initMapControls(),e("#elevation_expand").on("click",function(){i.Map.updateRouteElevations()}),e("#show_elevation").length&&e("#elevation").hide(),this.subscribeToTopics()},initMapControls:function(){var i=this,n=this.map_id,s=e('<div id="mmf_map_control_toolbar" class="mmf_mapping_api map_controls"></div>');this.map_control_toolbar=s;var r=e("<div>"),c=e("<h2>"+this.formatMeasurement({value:0,to_string:!0})+"</h2>");t.subscribe(n+".updated.route.distance",e.proxy(function(e,t){c.text(this.formatMeasurement({value:t,to_string:!0}))},this));var u,p,d,g,m,v,_,y,b,x,w,k,M,T,C,E,P,z,D,S,I,N,A,L,O,R,j,H,q,W,B,F,U,G=r.clone().addClass("map_controls_tabs");d=e('<a href="#center" class="mmf_button last center" title="Center on Route"><img src="'+o.transparentGif()+'" class="map-sprite-primary" alt="Four arrows converging on a point"/></a>').on("click",function(e){e.preventDefault(),f.push({event:"Map Controls",mapControlType:"center on route"}),i.Map.centerMapOnRoute()}),a.allowFeature(n,"manipulate_route")&&(u=e('<a href="#undo" class="mmf_button undo" title="Undo"><img src="'+o.transparentGif()+'" class="map-sprite-primary" alt="Return arrow" /></a>').on("click",function(e){e.preventDefault(),f.push({event:"Map Controls",mapControlType:"undo"}),i.Map.undo()}),p=e('<a href="#clear" class="mmf_button clear_map" title="Clear the map"><img src="'+o.transparentGif()+'" class="map-sprite-primary" alt="Red X" /></a>').on("click",function(e){e.preventDefault(),window.confirm("Are you sure you want to clear the map?")&&(e.preventDefault(),f.push({event:"Map Controls",mapControlType:"clear map"}),t.publishSync(n+".begin.altering.map"),i.Map.clearMap())}),g=e('<a href="#doubleback" class="mmf_button outback" title="Out &amp; Back"><img src="'+o.transparentGif()+'" class="map-sprite-primary" alt="Looping arrow" /></a>').on("click",function(e){e.preventDefault(),f.push({event:"Map Controls",mapControlType:"double back"}),t.publishSync(n+".begin.altering.map"),i.Map.doubleBack()}),m=e('<a href="#reverse" class="mmf_button reverse" title="Reverse"><img src="'+o.transparentGif()+'" class="map-sprite-primary" alt="Back & forth arrows" /></a>').on("click",function(e){e.preventDefault(),f.push({event:"Map Controls",mapControlType:"reverse route"}),window.confirm("Are you sure you want to reverse this route?")&&(t.publishSync(n+".begin.altering.map"),i.Map.reverseRoute())}),v=e('<a href="#return" class="mmf_button last return" title="Return to Start"><img src="'+o.transparentGif()+'" class="map-sprite-primary" alt="Two arrows chasing each other" /></a>').on("click",function(e){e.preventDefault(),f.push({event:"Map Controls",mapControlType:"return to start"}),t.publishSync(n+".begin.altering.map"),i.Map.loopToRouteOrigin()}),y=e('<label for="mmf_follow_roads">Auto Follow Roads</label>'),_=e('<input id="mmf_follow_roads" type="checkbox" />').attr("checked",a.followRoads(n)).on("click",function(){f.push({event:"Map Controls",mapControlType:"toggle follow roads"}),U=e(this).is(":checked"),a.setFollowRoads(n,U),U?C.add(w).removeClass("hidden"):C.add(w).addClass("hidden")}),b=e('<input id="mmf_avoid_highways" data-label="Avoid Highways" type="checkbox"/>').attr("checked",a.avoidHighways(n)),x=e('<label for="mmf_avoid_highways">Avoid Highways</label>'),w=r.clone().attr({"class":a.followRoads(n)?"":"hidden",id:"mmf_avoid_highways_container"}).append(b,x),T=e('<select id="travel-mode-select" style="margin-left: 10px; width: 140px; margin-bottom: 5px;">').append(e('<option value="'+l.travel_modes.WALKING+'">Walk/Run</option>')).append(e('<option id="travel-mode-select-bicycling" value="'+l.travel_modes.BICYCLING+'">Bicycle</option>')).append(e('<option value="'+l.travel_modes.DRIVING+'">Drive</option>')),T.val(a.travelMode(n)),C=r.clone().attr("id","travel-mode-switcher").addClass("mmf_button_group three").addClass(a.followRoads(n)?"":" hidden").append('<a href="#walking" data-mode="'+l.travel_modes.WALKING+'" data-label="" class="mmf_button first walking'+(a.travelMode(n)===l.travel_modes.WALKING?" active":"")+'" title="Use Walking Directions"><img src="'+o.transparentGif()+'" class="map-sprite-primary" alt="Person walking" title="Use Walking Directions" /></a>').append('<a href="#bicycling" data-mode="'+l.travel_modes.BICYCLING+'" data-label="" class="mmf_button bicycling'+(a.travelMode(n)===l.travel_modes.BICYCLING?" active":"")+'" title="Use Bicycling Directions"><img src="'+o.transparentGif()+'" class="map-sprite-primary" alt="Bicycle" title="Use Bicycling Directions" /></a>').append('<a href="#driving" data-mode="'+l.travel_modes.DRIVING+'" data-label="" class="mmf_button last driving'+(a.travelMode(n)===l.travel_modes.DRIVING?" active":"")+'" title="Use Driving Directions"><img src="'+o.transparentGif()+'" class="map-sprite-primary" alt="Car" title="Use Driving Directions" /></a>'),this.travel_modes_switcher=C,E=e('<p id="mmf_bicycle_directions_unverified">Bicycling directions may not be available in this location.</p>'),this.bicycling_directions_unverified=E,C.on("click","a",function(t){t.preventDefault();var i=e(this);i.addClass("active").siblings("a").removeClass("active"),T.val(i.data("mode")).trigger("change")}),t.subscribe(n+".map_config.set.travel_mode",e.proxy(function(e,t){T.val(t);var i=T.find(":selected").index(),n=C.children().eq(i);n.addClass("active").siblings().removeClass("active")},this))),D=e('<input id="show_bicycle_paths" type="checkbox" />').attr("checked",a.showBicyclePaths(n)),S=e('<label for="show_bicycle_paths">Bicycle Paths</label>'),I=e('<input id="show_traffic" type="checkbox" />').attr("checked",a.showTraffic(n)),N=e('<label for="show_traffic">Traffic</label>'),this.elevation_handler&&this.map_config.user_interface.display.elevation.show&&this.map_config.user_interface.display.elevation.hide&&(A=e('<input id="show_elevation" type="checkbox"/>').attr("checked",!1).on("change",e.proxy(function(){var t=e("#show_elevation").is(":checked"),s=e("#elevation_content_wrapper"),o=e("#elevation"),r=t?"show":"hide",l="elevation ("+r+")";f.push({event:"Map Controls",mapControlType:l}),t?(this.map_config.user_interface.display.elevation.show(),o.show(),s.show(),i.Map.updateRouteElevations()):(this.map_config.user_interface.display.elevation.hide(),o.hide(),s.hide()),a.setElevation(n,t)},this)),L=e('<label for="show_elevation">Elevation</label>')),a.allowFeature(n,"manipulate_route")&&(O=e('<button type="button" class="snap-to-roads">Snap Route to Roads</button>').hide().on("click",function(t){t.preventDefault(),i.Map.snapRouteToRoads(),e(this).slideUp("slow")}),t.subscribe(n+".enable.snap_to_roads",function(){O.slideDown("slow")})),R=e('<input id="show_distance_markers" type="checkbox" />').attr("checked",a.showDistanceMarkers(n)),j=e('<label for="show_distance_markers">Distance Markers</label>'),H=r.clone().attr("id","distance_marker_interval"),q=r.clone().attr("id","distance_marker_slider"),W=e("<span>1</span>"),B=e("<span>"+h.getUnit({system:a.unit(n),scope:0,abbreviated:!0})+"</span>"),H.append(q,e('<span id="distance_marker_label"></span>').append(W," ",B)).css({display:a.showDistanceMarkers(n)?"block":"none"}),q.slider({min:1,max:20,step:1,slide:e.proxy(function(e,t){W.text(t.value)},this),change:e.proxy(function(e,t){f.push({event:"Map Controls",mapControlType:"distance marker slider"}),W.text(t.value),a.setDistanceMarkerInterval(n,t.value)},this)}),t.subscribe(n+".map_config.set.unit",e.proxy(function(e,t){B.text(h.getUnit({system:t,scope:0,abbreviated:!0}))},this)),a.allowFeature(n,"mouse_events")&&(k=e('<input id="center_on_click" type="checkbox"/>').attr("checked",a.centerOnClick(n)),M=e('<label for="center_on_click">Center on Click</label>')),P=e('<input id="scroll_wheel_zoom" type="checkbox"/>').attr("checked",a.scrollWheelZoom(n)),z=e('<label for="scroll_wheel_zoom">Scroll to Zoom</label>'),F="<label>Units</label>";var V;for(V in l.units)l.units.hasOwnProperty(V)&&(F+=["<div>",'<input type="radio" id="mmf_unit_',V,'" name="mmf_unit"  value="',V,'"/>','<label for="mmf_unit_',V,'">',o.properCase(V),"</label>","</div>"].join(""));F=e(F),F.find("[value="+a.unit(n)+"]").attr("checked",!0),F.on("click",e.proxy(function(){f.push({event:"Map Controls",mapControlType:"set unit"}),a.setUnit(n,F.find("input:checked").val())},this));var $=r.clone().addClass("tab_content"),X=r.clone().addClass("section shaded"),Y=r.clone().addClass("section-content"),K=r.clone().addClass("mmf_button_row"),Z=$.clone().addClass("active").attr("id","mmf_map_controls_tools_content").data("tab","tools"),Q=X.clone(),J=Y.clone(),et=K.clone();O&&J.append(O),u&&et.append(u),p&&et.append(p),d&&et.append(d),et.children().length>0&&J.append(et),et=K.clone().addClass("last"),g&&et.append(g),m&&et.append(m),v&&et.append(v),et.children().length>0&&J.append(et),J.children().length>0&&Q.append(J),Q.children().length>0&&Z.append(Q),Q=X.clone(),J=Y.clone(),_&&J.append(_,y,"<br>"),w&&J.append(w),T&&J.append(T,C,E),J.children().length>0&&Q.append(J),Q.children().length>0&&Z.append(Q);var tt=e('<div class="mmf_visible" />').append("");A&&tt.append(A,L),Q=X.clone(),J=Y.clone().attr("id","mmf_distance_markers"),R&&(J.append(R,j,H),Q.append(J),Z.append(Q)),J=Y.clone().attr("id","mmf_unit"),F&&(J.append(F),Q.append(J)),Z.append(X.clone().addClass("last mmf_map_layers").append(Y.clone().append(e("<div />").append(e('<div class="toggle_control" />').append(A,L),e('<div class="toggle_control" />').append(I,N),e('<div class="toggle_control" />').append(D,S))))),Q=X.clone(),J=Y.clone(),k&&J.append(e('<div class="toggle_control" />').append(k,M)),P&&J.append(e('<div class="toggle_control" />').append(P,z)),J.children().length>0&&(Q.append(J),Z.append(Q));var it=$.clone().attr("id","mmf_map_controls_markers_content").data("tab","markers");Q=X.clone().addClass("markers"),J=Y.clone().attr("id","tab_markers").data("loaded",!1),Q.append(J),it.append(Q),b&&b.on("click",function(){f.push({event:"Map Controls",mapControlType:"avoid highways"}),U=e(this).is(":checked"),a.setAvoidHighways(n,U)}),T&&T.change(function(){f.push({event:"Map Controls",mapControlType:"set travel mode"}),a.setTravelMode(n,e(this).val())}),k&&k.on("click",function(){f.push({event:"Map Controls",mapControlType:"toggle center on click"}),U=e(this).is(":checked"),a.setCenterOnClick(n,U)}),P&&P.on("click",function(){f.push({event:"Map Controls",mapControlType:"toggle scroll wheel zoom"}),U=e(this).is(":checked"),a.setScrollWheelZoom(n,U)}),D&&D.on("click",function(){f.push({event:"Map Controls",mapControlType:"toggle bicycle paths"}),U=e(this).is(":checked"),a.setBicyclePaths(n,U)}),R&&R.on("click",function(){f.push({event:"Map Controls",mapControlType:"toggle distance markers"}),U=e(this).is(":checked"),a.setDistanceMarkers(n,U),H[U?"show":"hide"]()}),I&&I.on("click",function(){f.push({event:"Map Controls",mapControlType:"toggle traffic"}),U=e(this).is(":checked"),a.setTraffic(n,U)}),G.append('<a id="mmf_map_controls_tools_tab" href="#tools" data-tab="tools" class="tab active" title="Tools"><img src="'+o.transparentGif()+'" class="map-sprite-primary tools" /></a>'),a.allowFeature(n,"add_map_elements")&&G.append('<a id="mmf_map_controls_markers_tab" href="#markers" data-tab="markers" class="tab last" title="Markers"><img src="'+o.transparentGif()+'" class="map-sprite-primary markers" /></a>'),s.append(e('<div class="top" />').append(e('<div id="distance_elevation" />').append(e('<div class="distance" />').append("<label>Distance</label>",c),e('<div class="elevation" />'),e('<div class="clear" />'))),e('<div class="collapse expanded" />').append(e('<a href="#expand-collapse" class="expanded" title="Toggle Map Tools"></a>').append('<span class="expanded">&#9660;</span><span class="collapsed">&#9658;</span>').on("click",function(t){t.preventDefault();var i=e(this);i.toggleClass("expanded collapsed");var n=i.hasClass("expanded");e(".mmf_mapping_api.map_controls .map_controls_tabs, .mmf_mapping_api.map_controls .tabs_content")[n?"show":"hide"]()})),G,e('<div class="tabs_content" />').append(Z,it));var nt,st,ot=G.find("a.tab");ot.on("click",function(t){t.preventDefault(),nt=e(this),f.push({event:"Select Toolbar Tab",tabName:nt.data("tab")}),st=e(".tab_content").eq(ot.index(nt)),nt.addClass("active").siblings("a.tab").removeClass("active"),e(".tab_content").not(st).removeClass("active"),st.addClass("active").trigger("activate.mmf")}),it.one("activate.mmf",function(){e("#tab_markers").html(i.generateMarkerListHtml())});var rt=this.container;rt.append(s)},convertToDomElement:function(e){return this.convertToJqueryObject(e).get(0)},convertToJqueryObject:function(t){var i=e(t);return 0===i.length&&"string"==typeof t&&t.match(/^[a-zA-Z]/)&&(i=e("#"+t)),i},formatMeasurement:function(e){var t=e.unit||h.getUnit({system:a.unit(this.map_id),scope:e.scope||0,abbreviated:!0}),i=e.sig_digits||2,n=_(s.displayConversion(t,e.value),i);return e.to_string&&(n+=" "+t),n},generateGeolocationControl:function(){var t=e("<div>");t.css({paddingLeft:"15px"});var i=e("<div>");i.css({cursor:"pointer"}).attr({title:"Click to center the map on your location."}),t.append(i);var n=e("<img>"),s=c.get("geolocate");return n.attr({height:s.size.height,src:o.transparentGif(),title:"Center map on my location.",width:s.size.width}).css({backgroundImage:"url("+s.icon.url+")",backgroundRepeat:"no-repeat",backgroundPosition:s.icon.origin.x+"px "+s.icon.origin.y+"px",height:s.size.height+"px",width:s.size.width+"px"}),i.append(n),t},generateMarkerDialogContent:function(t){var i=e('<div class="mmf_mapping_api mmf_marker_dialog"></div>'),n=t.marker&&t.marker.desc;f.push({event:"Route Marker Actions",routeMarkerEvent:"select route marker",markerDesc:n});var s=e("<ul>");t.remove_point_callback&&s.append(e("<li><").append(e('<a href="#"></a>').text("delete this "+(t.floating_marker?"marker":"point")).on("click",function(e){f.push({event:"Delete Marker",markerTypeName:n}),t.remove_point_callback(e)}))),t.remove_points_before_callback&&s.append(e('<li><a href="#">delete all points before</a></li>').on("click",function(e){f.push({event:"Route Marker Actions",routeMarkerEvent:"remove all points before"}),t.remove_points_before_callback(e)})),t.remove_points_after_callback&&s.append(e('<li><a href="#">delete all points after</a></li>').on("click",function(e){f.push({event:"Route Marker Actions",routeMarkerEvent:"remove all points"}),t.remove_points_after_callback(e)})),s.children().length>0&&i.append(s);var o=e("<ul>");t.loop_to_point_callback&&o.append(e('<li><a href="#">loop route to this point</a></li>').on("click",function(e){f.push({event:"Route Marker Actions",routeMarkerEvent:"loop to point"}),t.loop_to_point_callback(e)})),t.subdivide_segment_callback&&o.append(e('<li><a href="#">split following segment</a></li>').on("click",function(e){f.push({event:"Route Marker Actions",routeMarkerEvent:"subdivide segment"}),t.subdivide_segment_callback(e)})),o.children().length>0&&i.append(o);var r=e('<div class="collapsible collapsed">'),a=e("<dl>").css({display:"none"});r.append('<p class="toggle">Detailed Info</p>',a).on("click",function(){e(this).toggleClass("collapsed"),a.slideToggle(),f.push({event:"Route Marker Actions",routeMarkerEvent:"detailed point info toggle"})}),t.distance&&a.append("<dt>distance</dt>","<dd>"+this.formatMeasurement({value:t.distance,to_string:!0})+"</dd>"),t.elevation!==m&&a.append("<dt>elevation</dt><dd>"+this.formatMeasurement({scope:1,value:t.elevation,to_string:!0})+"</dd>"),t.latitude&&t.longitude&&a.append("<dt>latitude</dt><dd>"+_(t.latitude,5)+"</dd>"+"<dt>longitude</dt><dd>"+_(t.longitude,5)+"</dd>"),t.notes&&a.append(e("<p>"+(t.notes||"")+"</p>")),a.children().length>1&&i.append(r);var l=e("<div></div>"),c=e('<div class="mmf_mapping_api mmf_marker_dialog_tip_container"></div>');return c.append(e('<div class="mmf_marker_dialog_tip"></div>')),l.append(i).append(c),l.get(0)},generateMarkerListHtml:function(){for(var i,n=this,s=c.getList(),r=e('<div><h5 id="mmf_marker_tab_header">Click a marker to add it to your map.</h5></div>'),a=function(e,i,s){s.mouseover(function(e){e.preventDefault(),s.css("cursor","pointer")}),s.on("click",function(e){e.preventDefault(),f.push({event:"Drop Marker",markerTypeName:i.desc}),t.publish(n.map_id+".add.floating_marker",i)})},l=0,h=s.length;h>l;l++){var u=s[l];u.internal_use_only||(i=e("<img />"),i.attr({alt:u.desc,height:u.size.height,src:o.transparentGif(),title:u.desc,width:u.size.width}).css({backgroundImage:"url("+u.icon.url+")",backgroundRepeat:"no-repeat",backgroundPosition:u.icon.origin.x+"px "+u.icon.origin.y+"px",height:u.size.height+"px",width:u.size.width+"px"}),a(this.map_id,u,i),r.append(i))}return r.get(0)},getUnitOfMeasure:function(){var t=a.unit(this.map_id);return e.extend(!0,{},h[t],{system:t})},initCueNotesCommon:function(){var i;t.subscribe(this.map_id+".updated.route.cue_notes",e.proxy(function(t,n){e.each(n,e.proxy(function(e){n[e].distance=this.formatMeasurement({to_string:!0,value:n[e].distance}),n[e].duration=function(){return i=_(n[e].duration/60,2),i=60>i?i+" min":_(n[e].duration/60,2)+" hours"}()},this)),this.cue_notes_handler(n)},this))},initCueNotesStandard:function(t){this.cue_notes_display=this.convertToJqueryObject(t),this.cue_notes_handler=this.cue_notes_display?function(t){for(var i=e("<ol></ol>"),n=0,s=t.length;s>n;n++)i.append('<li class="route_direction">'+t[n].text+"</li>");this.cue_notes_display.html(i)}:function(){i.warn("Cue Notes display not defined in settings.")}},initDisplayElement:function(e,t){var i=o.capitalize(o.toCamelCase(e));t&&(t.callback?this.initDisplayElementCustom(e,t.callback):t.container?this["init"+i+"Standard"](t):this.initDisplayElementCustom(e,function(){}),this["init"+i+"Common"]())},initDisplayElementCustom:function(e,t){this[e+"_display"]=m,this[e+"_handler"]=t},initDistanceCommon:function(){t.subscribe(this.map_id+".updated.route.distance",e.proxy(function(e,t){this.distance_handler({converted:this.formatMeasurement({value:t}),display:this.formatMeasurement({value:t,to_string:!0}),unit:this.getUnitOfMeasure().coarse,value:t})},this))},initDistanceStandard:function(n){this.distance_display=this.convertToJqueryObject(n),this.distance_display?(this.distance_handler=function(e){this.distance_display.text(this.formatMeasurement({value:e,to_string:!0}))},this.distance_display.css("cursor","pointer"),this.distance_display.on("click",e.proxy(function(){t.publish(this.map_id+".toggle.unit")},this)),this.distance_handler(0)):this.distance_handler=function(){i.warn("Distance display not defined in settings.")}},initElevationCommon:function(){var i,n,s,o=0,r=1;t.subscribe(this.map_id+".updated.route.elevations",e.proxy(function(t,l){n=a.unit(this.map_id),s=l.data.slice(0),i={actions:l.actions,data:[],meta:{distance:this.formatMeasurement({scope:o,value:l.meta.distance}),unit:{distance:{abbreviated:h.getUnit({system:n,scope:o,abbreviated:!0}),full:h.getUnit({system:n,scope:o})},elevation:{abbreviated:h.getUnit({system:n,scope:r,abbreviated:!0}),full:h.getUnit({system:n,scope:r})}}}};for(var c=0,u=s.length;u>c;c++)i.data.push(e.extend(!0,{},s[c],{elevation:this.formatMeasurement({scope:r,value:s[c].elevation})}));this.elevation_handler(i)},this))},initElevationStandard:function(t){this.elevation_display=this.convertToJqueryObject(t),this.elevation_handler=function(t){this.elevation_display.text(e.map(t,function(e){return e.elevation}).toString()),i.log("Elevation data:",t)}},setBicyclingDirectionsAvailable:function(e){if(this.travel_modes_switcher){var t=this.travel_modes_switcher.find("a.bicycling");e?(t.removeClass("unverified"),this.bicycling_directions_unverified.hide()):(t.addClass("unverified"),this.bicycling_directions_unverified.show())}},subscribeToTopics:function(){}}),_=function(e,t){var i=Math.pow(10,t);return Math.round(e*i)/i};return v}),mmf_mapping_api.define("classes/Segments",["jquery","namespace","map_configs","logger","message_mgr","utils/array","classes/Collection"],function(e,t,i,n,s,o,r){var a=r.extend({init:function(e){this._super(e),this.item="segment",this.items=this.item+"s"},dequeue:function(){var e=this._super.call(this,arguments);return this.reindex(),e},insert:function(e,t){var i=this._super.apply(this,arguments);return this.reindex(t+1),i},reindex:function(e){for(var t=e||0,i=this.length();i>t;t++)this.get(t).index=t},removeIndex:function(e){var t=this._super.apply(this,arguments);return this.reindex(e),t},reverse:function(){var e=this._super.call(this,arguments);return this.reindex(),e}});return a}),mmf_mapping_api.define("classes/Marker",["jquery","pubsub","logger","message_mgr","constants","map_configs","config/marker_def","uris","namespace","classes/Class"],function(e,t,i,n,s,o,r,a,l,c,h){var u=c.extend({init:function(e){this.uid="marker_"+Date.now(),this.map_id=e.map_id,this.Map=e.Map,this.map=e.map,this.api=e.api,this.map_config=o.get(this.map_id),this.messager=n.get(this.map_id),this.marker=null,this.index=null,this.point=e.point?e.point:e.latitude&&e.longitude?this.api.createPoint({latitude:e.latitude,longitude:e.longitude}):h,this.icon_id=e.icon_id,this.dragging=!1,this.hovering=!1,this.initMarker(e),o.allowFeature(this.map_id,"mouse_events")&&this.initMarkerEvents(),this.render()},createMarker:function(e){return this.api.createMarker(e)},destroy:function(){this.setMap(null),this.marker_dialog&&this.marker_dialog.close()},getCoordinates:function(){return this.api.convertPointToCoordinates(this.getPoint())},getIconId:function(){return this.icon_id},getIndex:function(){return this.index},getMarker:function(){return this.marker},getPoint:function(){return this.point},initMarker:function(t){this.icon_id=t.icon_id||this.icon_id,this.icon=t.marker_options&&t.marker_options.icon?t.marker_options.icon:r.get(this.icon_id);var i=e.extend(!0,{},this.icon,p(this.map_id),t.marker_options);this.marker=this.createMarker({point:this.point,marker_options:i})},initMarkerEvents:function(){},render:function(){this.setMap(this.map)},setIcon:function(){},setMap:function(e){this.marker.getMap()!==e&&this.marker.setMap(e)},setPosition:function(e){e.point?(this.point=e.point,this.marker.setPosition(this.point)):e.latitude&&e.longitude?(this.point=this.api.createPoint(e.latitude,e.longitude),this.marker.setPosition(this.point)):this.messager.error("Marker.setPosition: must pass a point or a lat/long.")},setVisible:function(e){this.marker&&this.marker.setVisible(e)},toggleDrag:function(e){this.dragging=e},toggleHover:function(e){this.hovering=e},toJSON:function(){return{geometry:{type:"Point",coordinates:[this.point.lng(),this.point.lat()]},properties:{iconId:this.getIconId()}}}}),p=function(e){return{clickable:o.allowFeature(e,"manipulate_route")&&!0,draggable:o.allowFeature(e,"manipulate_route")&&!0,crossOnDrag:!1,visible:!0}};return u}),mmf_mapping_api.define("classes/SegmentOriginMarker",["jquery","logger","config/marker_def","classes/Marker"],function(e,t,i,n){var s=n.extend({initMarker:function(t){var i=e.extend(!0,{icon_id:"Waypoint Static",point:this.point,marker_options:{visible:!0,zIndex:1e3}},t);this._super(i)},initMarkerEvents:function(){}});return s}),mmf_mapping_api.define("classes/SegmentDestinationMarker",["jquery","config/marker_def","classes/Marker"],function(e,t,i){var n=i.extend({initMarker:function(i){var n=t.getEnd();i.icon_id=n.desc,i.point=this.point,i.marker_options=e.extend(!0,{clickable:!1,draggable:!1,visible:!1,zIndex:1e3},n),this._super(i)},initMarkerEvents:function(){}});return n}),mmf_mapping_api.define("classes/RouteOriginMarker",["jquery","map_configs","config/marker_def","uris","logger","classes/Marker"],function(e,t,i,n,s,o){var r=o.extend({init:function(e){this._super(e)},initMarker:function(n){var s=i.getStart();n.icon_id=s.desc,n.point=this.point,n.marker_options=e.extend(!0,{zIndex:1e3},s),this._super(n),t.allowFeature(this.map_id,"manipulate_route")&&this.initTooltip()},destroy:function(e){this._super(e),this.tooltip&&this.tooltip.close()},initTooltip:function(){var t={content:this.map_config.map.display.route_origin_tooltip.content,callback:this.map_config.map.display.route_origin_tooltip.callback};if(t.content){this.map_config.map.display.route_origin_tooltip={};var i=function(t){return"string"==typeof t?e("<div>"+t+"</div>"):"object"==typeof t?e(t):(s.error("Did not recognize tooltip content type."),void 0)}(t.content);mmf_mapping_api.require(["InfoBox"],e.proxy(function(s){var o={content:function(t){var i=e("<div>"),n=e("<div>").addClass("mmf_mapping_api mmf_marker_dialog");n.append(t);var s=e("<div>").addClass("mmf_mapping_api mmf_marker_dialog_tip_container");return s.append(e("<div>").addClass("mmf_marker_dialog_tip")),i.append(n,s),i.get(0)}(i,t),disableAutoPan:!0,enableEventPropagation:!0,position:this.point,alignBottom:!0,pixelOffset:{height:-8,width:-85},closeBoxURL:n.img+"info_close.png",closeBoxCallback:t.callback};this.tooltip=new s(o),this.tooltip.open(this.map)},this))}}});return r}),mmf_mapping_api.define("classes/RouteDestinationMarker",["jquery","config/marker_def","classes/Marker"],function(e,t,i){var n=i.extend({initMarker:function(i){var n=t.getEnd();i.icon_id=n.desc,i.point=this.point,i.marker_options=e.extend(!0,{zIndex:1e3},n),this._super(i)},initMarkerEvents:function(){}});return n}),mmf_mapping_api.define("classes/Segment",["jquery","pubsub","logger","message_mgr","utils/array","utils/gtm","constants","map_configs","globals/hover_markers","config/marker_def","classes/Class","classes/SegmentOriginMarker","classes/SegmentDestinationMarker","classes/RouteOriginMarker","classes/RouteDestinationMarker"],function(e,t,i,n,s,o,r,a,l,c,h,u,p,d,f,g){var m=null,v=h.extend({init:function(t){return this.map_id=t.map_id,this.Map=t.Map,this.map=t.map,this.api=t.api,this.map_config=a.get(t.map_id),this.messager=n.get(this.map_id),this.segments=t.segments,m=m||this.api.directions_service_quota_manager,this.points=t.points?t.points.slice():[],this.Map.loading||(this.most_recent=!0),this.travel_mode=t.travel_mode,this.index=t.index,this.index===g?(i.error("Segment must be instantiated with an index. Halting instantiation."),void 0):(this.notes=t.notes&&t.notes.length>0?t.notes:this.notes||[],this.polyline=null,this.markers=[],this.associated_markers={},this.distance=0,this.distance_to_here=0,this.elevations=[],this.status={error:!1,initialized:!1},this.dragging=!1,this.pubsub_tokens=[],this.init_deferred=e.Deferred(),this.removal_deferred=e.Deferred(),this.initPolyline(t),this.initPolylineEvents(),a.allowFeature(this.map_id,"manipulate_route")&&this.subscribeToTopics(),void 0)},clearNotes:function(){this.setNotes()},createMarkers:function(){var t={api:this.api,Map:this.Map,map:this.map,map_id:this.map_id};t.point=this.points[0],this.markers[0]=0===this.getIndex()?new d(t):new u(e.extend(!0,t,{marker_options:{visible:this.most_recent?!0:!1}})),t.point=this.points.slice(-1)[0],this.markers[1]=this.segments.isLast(this.getIndex())?new f(t):new p(t),a.allowFeature(this.map_id,"mouse_events")&&(this.initMarkerEvents(this.markers[0]),this.initMarkerEvents(this.markers[1])),this.markers[0].index=0,this.markers[1].index=1},deassociateFloatingMarkers:function(){this.associated_markers={}},decrementIndex:function(e){this.setIndex(this.getIndex()-(e||1))},destroy:function(i){i=i?i:{};var n=i.marker_index!==g?this.points[0===i.marker_index?this.points.length-1:0]:g;this.destroyMarkers(),this.destroyPolyline(),this.unsubscribeFromTopics(),this.removal_deferred.done(e.proxy(function(){if((0===this.getIndex()||this.getIndex()===this.segments.length())&&(this.updateMetaData(),this.clearNotes()),!i.mute){for(var e=this.segments,s={index:this.getIndex(),point:n,segment:this},o=0,r=e.length();r>o;o++)e.get(o).handleDestroyedSegment(s);this.deassociateFloatingMarkers(),this.updateAssociatedMarkers(),t.publish(this.map_id+".destroyed.segment",{index:this.getIndex(),point:n,segment:this})}},this))},destroyMarkers:function(){this.markers.length&&(this.markers[0].destroy(),this.markers[1].destroy(),this.markers.length=0)},destroyPolyline:function(){this.polyline.setMap(null),this.polyline=null},disable:function(){this.polyline.disableMouseEvents()},enable:function(){this.polyline.enableMouseEvents()},getIndex:function(){return this.index},getMedianPoint:function(){return this.polyline.getPointAtDistance(this.distance/2)},getNextSegment:function(){return this.segments.get(this.getIndex()+1)},getCueNotes:function(){var t,i,n,s,o,r=this.associated_markers,a=this.notes.slice(),l=[];for(t in r)r.hasOwnProperty(t)&&(i=r[t],n=i.getNotes(),n=e.extend(!0,n,{distance:this.distance_to_here+i.distance,duration:0,point:i.associated_vertex,icon:c.get(i.icon_id).icon}),l.push(n));if(a.length>0){var h=this.distance_to_here,u=0,p=0;for(s=0,o=a.length;o>s;s++)n=e.extend(!0,{},a[s]),n.order=s,n.parent=this,u=h+p,p=n.distance,n.distance=u,h=u,l.push(n)}return l.sort(function(e,t){return e.distance<t.distance?-1:1}),l},getNotes:function(){return this.notes},getPoints:function(){return this.polyline.getPoints()},getPreviousSegment:function(){return this.getIndex()>0?this.segments.get(this.getIndex()-1):null},getTravelMode:function(){return this.travel_mode},handleDestroyedSegment:function(e){var t=e.index,i=t===this.getIndex()+1,n=t===this.getIndex();i?e.point&&!e.point.equals(this.points.slice(-1)[0])?this.setPoints({points:[this.points[0],e.point]}):this.refreshMarkers():n&&0===e.index&&this.refreshMarkers()},incrementIndex:function(e){this.setIndex(this.getIndex()+(e||1))},initMarkerEvents:function(n){var s,o,r,a,c=n.getMarker();l.get(this.map_id);var h,u=c.getPosition(),p=null,d=e.proxy(function(){var e=(this.is_directions_based?1:0)+(s&&s.is_directions_based?1:0);return i.log("render availability check count:",e),m.test(e)},this);this.api.addEventListener({obj:c,event:"mouseover",callback:e.proxy(function(){n.toggleHover(!0),s=this.getPreviousSegment(),o=this.getNextSegment()},this)}),this.api.addEventListener({obj:c,event:"mousedown",callback:e.proxy(function(){n.mousedown=!0},this)}),this.api.addEventListener({obj:c,event:"mouseup",callback:e.proxy(function(){n.mousedown=!1},this)}),this.api.addEventListener({obj:c,event:"mouseout",callback:e.proxy(function(){n.mousedown||(n.toggleHover(!1),this.dragging||(this.toggleMarkerState(!1),o&&o.toggleMarkerState(!1),s&&0===n.getIndex()&&s.toggleMarkerState(!1)))},this)}),this.api.addEventListener({obj:c,event:"dragstart",callback:e.proxy(function(){return n.hovering?(s=this.getPreviousSegment(),this.disable(),s&&s.disable(),n.toggleDrag(!0),this.toggleDrag(!0),a=0===n.getIndex()&&s?s.markers[1]:g,a&&(a.toggleDrag(!0),s.toggleDrag(!0)),t.publishSync(this.map_id+".begin.altering.map"),void 0):(n.setPosition(u),void 0)},this)}),this.api.addEventListener({obj:c,event:"drag",callback:e.proxy(function(t){return n.hovering?(window.clearInterval(p),p=window.setTimeout(e.proxy(function(){d()&&(window.clearInterval(p),h=t,this.setPoints({points:0===n.getIndex()?[t,this.points.slice(-1)[0]]:[this.points[0],t]}),a&&s.setPoints({points:[s.points[0],t]}))
},this),500),void 0):(n.setPosition(u),void 0)},this)}),this.api.addEventListener({obj:c,event:"dragend",callback:e.proxy(function(t){return n.hovering?(u=t,n.toggleDrag(!1),this.toggleDrag(!1),a&&(a.toggleDrag(!1),s.toggleDrag(!1)),window.clearInterval(p),p=window.setTimeout(e.proxy(function(){d()&&(window.clearInterval(p),this.setPoints({points:0===n.getIndex()?[t,this.points.slice(-1)[0]]:[this.points[0],t]}),a&&s.setPoints({points:[s.points[0],t]}),this.enable(),a&&s.enable())},this),500),void 0):(n.setPosition(u),void 0)},this)}),this.api.addEventListener({obj:c,event:"click",callback:e.proxy(function(){s=this.getPreviousSegment(),r=e.extend(!0,{marker_index:n.getIndex(),Marker:n,marker:c,point:n.getPoint(),segment:this},n.getCoordinates());var i=e.Deferred();this.api.getElevationForLocation({callback:function(e){r.elevation=e.elevation,i.resolve()},point:n.getPoint()}),this.distance_to_here&&(r.distance=this.distance_to_here,1===n.getIndex()&&(r.distance+=this.distance)),i.done(e.proxy(function(){t.publish(this.map_id+".activated.route.marker",r)},this))},this)})},initPolyline:function(t){this.render(t),this.init_deferred.done(e.proxy(function(){var e=this.getPreviousSegment();e&&e.refreshMarkers()},this))},initPolylineEvents:function(){if(a.allowFeature(this.map_id,"manipulate_route")){var t,n=l.get(this.map_id);this.api.addEventListener({obj:this.polyline,event:"click",callback:e.proxy(function(e){o.push({event:"Route Manipulation",action:"extend route along itself"}),this.Map.handleMapClick(e)},this)}),this.api.addEventListener({obj:this.polyline,event:"mouseover",callback:e.proxy(function(){t=this.getNextSegment(),this.dragging&&n.dragging||(i.group("this.polyline mouseover"),this.markers?this.markers[0]||i.warn("this.markers[0] is undefined"):i.warn("this.markers is undefined"),t&&(t.markers?t.markers[0]||i.warn("next_segment.markers[0] is undefined"):i.warn("next_segment.markers is undefined")),this.toggleMarkerState(!0),t&&t.toggleMarkerState(!0),i.groupEnd())},this)}),this.api.addEventListener({obj:this.polyline,event:"mousemove",callback:e.proxy(function(){this.dragging||(this.toggleMarkerState(!0),t&&t.toggleMarkerState(!0))},this)}),this.api.addEventListener({obj:this.polyline,event:"mouseout",callback:e.proxy(function(){this.dragging||n.dragging||(this.markers[0]&&!this.markers[0].hovering&&this.toggleMarkerState(!1),t&&t.markers[0]&&!t.markers[0].hovering&&t.toggleMarkerState(!1))},this)})}},toggleMarkerState:function(e){0!==this.index&&(this.most_recent||this.dragging||this.markers[0]&&this.markers[0].setVisible(e),e||(this.markers[0]&&(this.markers[0].toggleHover(!1),this.markers[0].toggleDrag(!1)),this.markers[1]&&(this.markers[1].toggleHover(!1),this.markers[1].toggleDrag(!1))))},render:function(){this.status.initialized||(this.status.error||(this.status.initialized=!0),this.init_deferred.resolve()),this.dragging||this.rendering||this.Map.loading||(window.clearTimeout(this.associated_marker_update_timeout),this.associated_marker_update_timeout=window.setTimeout(e.proxy(function(){this.updateAssociatedMarkers()},this),1e3))},renderInProgress:function(e){return e!==g&&(e===!0?(this.rendering=!0,this.Map.renderInProgress()):e===!1?(this.rendering=!1,this.Map.renderComplete()):i.error("Segment render: Something other than a Boolean was passed.")),this.rendering?!0:!1},refreshMarkers:function(){this.destroyMarkers(),this.createMarkers(),this.renderMarkers()},renderMarkers:function(){this.markers[0].render(),this.markers[1].render()},reversePoints:function(){this.points.reverse(),this.render()},setIndex:function(e){this.index=e},setNote:function(e){e.note?this.note[e.index]=e.note:e.text&&(this.notes[e.index].text=e.text),e.suppress_publish||t.publish(this.map_id+".updated.cue_notes")},setNotes:function(e){e=e||{},this.notes=e.notes||[],e.suppress_publish||t.publish(this.map_id+".updated.cue_notes")},setPoint:function(e){e.index>0?this.points[this.points.length-1]=e.point:this.points[0]=e.point,e.skip_render?this.refreshMarkers():this.render()},setPoints:function(e){this.points=e.points,e.skip_render?this.refreshMarkers():this.render()},subdivide:function(t){t=t?t:this.getMedianPoint();var i=this.Map.addSegment({index:this.getIndex()+1,points:[t,this.points.slice(-1)[0]],travel_mode:this.getTravelMode()});"direct"===this.getTravelMode()?this.setPoints({points:[this.points[0],t],force_render:!0}):i.init_deferred.done(e.proxy(function(){this.setPoints({points:[this.points[0],t],force_render:!0})},this))},subscribeToTopics:function(){var i=t.subscribe(this.map_id+".removed.segment",e.proxy(function(e,n){n.obj===this&&(this.removal_deferred.resolve(),setTimeout(function(){t.unsubscribe(i)},1e3))},this));if(!this.Map.loading&&this.most_recent)var n=t.subscribe(this.map_id+".begin.altering.map",e.proxy(function(){0===this.getIndex()||this.dragging||(this.most_recent=null,this.markers[0]&&this.markers[0].setVisible(!1),setTimeout(function(){t.unsubscribe(n)},1e3))},this))},toggleDrag:function(e){this.dragging=e},toJSON:function(){var t;i.log("this.markers:",this.markers);var n={geometry:{type:"LineString",coordinates:e.map(this.getPoints(),e.proxy(function(e){return t=this.api.convertPointToCoordinates(e),[[t.longitude,t.latitude]]},this))},properties:{notes:e.map(this.getNotes(),e.proxy(function(e){return t=this.api.convertPointToCoordinates(e.point),{distance:e.distance,duration:e.duration,geometry:{type:"Point",coordinates:[t.longitude,t.latitude]},text:e.text}},this)),iconIds:[this.markers[0].getIconId(),this.markers[1].getIconId()],travelMode:this.getTravelMode()}};return n},unsubscribeFromTopics:function(){for(;this.pubsub_tokens.length;)t.unsubscribe(this.pubsub_tokens.pop())},updateAssociatedMarkers:function(){var t,i,n,s=this.associated_markers,o=e.proxy(function(e,t){this.Map.updateFloatingMarkerPosition(e,t)},this),r=[];for(t in s)s.hasOwnProperty(t)&&r.push(s[t]);if(n=r.length,n>0){for(i=0;n-1>i;i++)o(r[i],!0);o(r[n-1])}},updateDistance:function(){var e=this.getNextSegment();this.distance=this.polyline?this.polyline.computeDistance():0,this.polyline||i.warn("There is no polyline for segment",this.getIndex()),e&&e.updateDistanceToHere(),t.publish(this.map_id+".updated.segment.distance")},updateDistanceToHere:function(){var e,t=this.getNextSegment();0===this.getIndex()?this.distance_to_here=0:(e=this.getPreviousSegment(),e&&(this.distance_to_here=e.distance_to_here+e.distance)),t&&t.updateDistanceToHere()},updateMetaData:function(){this.updateDistance(),this.updateDistanceToHere(),this.Map.loading===!1&&t.publish(this.map_id+".updated.route")}});return v}),mmf_mapping_api.define("classes/ManualSegment",["jquery","pubsub","logger","message_mgr","constants","map_configs","config/marker_def","globals/hover_markers","units","classes/Marker","classes/Segment"],function(e,t,i,n,s,o,r,a,l,c,h){var u=h.extend({init:function(e){this.travel_mode=s.travel_modes.DIRECT,this.notes=e.notes||[{distance:0,point:null,text:"Direct/offroad route segment"}],this._super(e)},initPolyline:function(t){var i=i,n=e.extend(!0,{},i,this.map_config.map.paths.common.polylineOptions,this.map_config.map.paths.direct.polylineOptions,p(this.map_id));this.polyline=this.api.createPolyline(n),this._super(t)},render:function(){this.renderInProgress(!0),this.dragging||this.polyline.setMap(null),this.polyline.setPath(this.points),"view"!==o.apiMode(this.map_id)&&this.polyline.setMap(this.map),this.renderInProgress(!1),this.dragging?this.updateDistance():(this.refreshMarkers(),this.updateMetaData(),this.updateNoteLocation()),this._super()},setDirections:function(){},setPoint:function(e){this._super(e)},setPoints:function(e){this._super(e)},updateNoteLocation:function(){this.notes[0].point=this.points[0],t.publish(this.map_id+".updated.cue_notes")}}),p=function(e){var t=o.allowFeature(e,"manipulate_route");return{clickable:t&&!0,editable:t&&!1,geodesic:!0,strokeOpacity:t?void 0:1,visible:t&&!0}};return u}),mmf_mapping_api.define("classes/AutoSegment",["jquery","pubsub","logger","message_mgr","namespace","map_configs","classes/Segment"],function(e,t,i,n,s,o,r){var a=r.extend({init:function(e){this.is_directions_based=!0,this.init_origin_address=e.init_origin_address,this.init_destination_address=e.init_destination_address,this._super(e)},initPolyline:function(t){var i=t.polyline_options,n=e.extend(!0,{},i,this.map_config.map.paths.common.polylineOptions,this.map_config.map.paths.snap_to_roads.polylineOptions,l(this.map_id));this.polyline=this.api.createPolyline(n),this._super(t)},render:function(t){t=t||{};var n,s;this.renderInProgress(!0),n=this.points[0]||this.init_origin_address,s=this.points.slice(-1)[0]||this.init_destination_address,this.dragging||this.polyline.setMap(null),t.render_static_data?u.call(this,{path:this.points,directions:this.notes}):this.api.callDirectionsService({origin:n,destination:s,waypoints:e.map(this.points.slice(1,-1),function(e){return{location:e,stopover:!1}}),travel_mode:this.getTravelMode(),optimize_waypoints:!1,avoid_highways:o.avoidHighways(this.map_id),avoid_tolls:!1},e.proxy(function(e,t){i.info("Render DirectionsService error: ",t),i.info("Render DirectionsService result: ",e),u.apply(this,arguments)},this))},syncConnectingSegments:function(){var e=this.getPreviousSegment(),t=this.getNextSegment();e&&"direct"===e.getTravelMode()&&e.points.slice(-1)[0]!==this.points[0]&&e.setPoint({index:1,point:this.points[0]}),t&&"direct"===t.getTravelMode()&&t.points[0]!==this.points.slice(-1)[0]&&t.setPoint({index:0,point:this.points.slice(-1)[0]})}}),l=function(e){var t=o.allowFeature(e,"manipulate_route");return{clickable:t&&!0,editable:!1,geodesic:!0,strokeOpacity:t?void 0:.8,visible:t&&!0}},c='There was a problem retrieving auto-route information for that location. Try disabling "follow roads" in the map controls or try again at a later time.',h={ERROR:c,NOT_FOUND:c,UNKNOWN_ERROR:c,ZERO_RESULTS:'The current travel mode is not available in this location. In the map controls, change to a different travel mode or disable "follow roads" and try again.'},u=function(e,t){e?(this.polyline.setPath(e.path),"view"!==o.apiMode(this.map_id)&&this.polyline.setMap(this.map),this.dragging?(this.points=[e.path[0],e.path.slice(-1)[0]],this.updateDistance()):(this.points=e.path.slice(),this.last_valid_points=this.points.slice(),this.refreshMarkers(),this.setNotes({notes:e.directions}),this.updateMetaData(),this.syncConnectingSegments()),this.status.error=!1):this.dragging||(this.status.error=t,this.messager.error(h.hasOwnProperty(t)?h[t]:c),this.last_valid_points&&(this.points=this.last_valid_points,this.render())),this.renderInProgress(!1),r.prototype.render.call(this)};return a}),mmf_mapping_api.define("classes/DistanceMarker",["require","jquery","logger","storage","config/marker_def","classes/Class"],function(e,t,i,n,s,o){var r=o.extend({init:function(e){this.map_id=e.map_id,this.Map=n.getMap(this.map_id),this.map=this.Map.map,this.marker=null,this.point=e.point,this.initMarker(e)},destroy:function(){this.marker&&(this.marker.setVisible(!1),this.marker.setMap(null))},initMarker:function(e){mmf_mapping_api.require(["RichMarker"],t.proxy(function(t){this.marker=new t({content:'<div class="mmf_mapping_api mmf_distance_marker_wrapper"><div class="mmf_mapping_api mmf_distance_marker">'+e.label+'</div><div class="mmf_mapping_api mmf_distance_marker_tip_container"><div class="mmf_distance_marker_tip"></div></div></div>',draggable:!1,flat:!0,position:this.point}),this.render()},this))},render:function(){this.marker.setMap(this.map)}});return r}),mmf_mapping_api.define("classes/FloatingMarker",["jquery","pubsub","logger","message_mgr","constants","map_configs","config/marker_def","classes/Marker"],function(e,t,i,n,s,o,r,a,l){var c=a.extend({init:function(t){this.associated_segment=null,this.associated_vertex=null,this.distance_along_segment=0,this.tangent=null;var i=e.extend(!0,{marker_options:{animation:t.animate===l||t.animate?"DROP":l,icon:t.icon,shadow:r.get("Square Shadow").icon}},t);this.notes=e.extend(!0,{parent:this,text:t.notes?t.notes.text:t.icon_id},this.notes),this._super(i)},destroy:function(){this._super(),this.destroyTangent(),this.associated_segment&&(delete this.associated_segment.associated_markers[this.uid],t.publish(this.map_id+".updated.cue_notes"))},destroyTangent:function(){this.tangent&&this.tangent.setMap(null)},getDistance:function(){return this.distance_to_here},getNotes:function(){return this.notes},initMarkerEvents:function(){this.api.addEventListener({obj:this.marker,event:"dragstart",callback:e.proxy(function(){this.destroyTangent(),t.publishSync(this.map_id+".begin.altering.map")},this)}),this.api.addEventListener({obj:this.marker,event:"dragend",callback:e.proxy(function(e){this.point=e,t.publish(this.map_id+".altered.floating_marker",{marker:this})},this)}),this.api.addEventListener({obj:this.marker,event:"click",callback:e.proxy(function(){t.publish(this.map_id+".activated.floating_marker",{Marker:this,marker:this.getMarker(),notes:this.getNotes().text,point:this.getPoint()})},this)})},setAssociatedVertex:function(e){this.associated_vertex=e,this.updateTangent()},updateTangent:function(){this.tangent=this.tangent||this.api.createPolyline({clickable:!1,editable:!1,strokeWeight:3,strokeOpacity:.5,strokeColor:"#777777",visible:!1}),this.tangent.setMap(this.map),this.tangent.setPath([this.point,this.associated_vertex])},setNote:function(e){e.note?this.notes=e.notes:e.text&&(this.notes.text=e.text),e.suppress_publish||t.publish(this.map_id+".updated.cue_notes")},setDistance:function(e){this.distance=e},toJSON:function(){var e=this._super();return e.properties.notes={text:this.getNotes().text},e}});return c}),mmf_mapping_api.define("classes/HoverMarker",["jquery","pubsub","logger","message_mgr","utils/gtm","config/marker_def","classes/Marker"],function(e,t,i,n,s,o,r){var a=r.extend({getTargetSegment:function(){return this.target_segment},initMarker:function(t){var i=e.extend(!0,{icon_id:"Waypoint Active",marker_options:{clickable:!0,draggable:!0,zIndex:1e3}},t);this._super(i)},initMarkerEvents:function(){var n,o,r,a,l=!1,c=this.api.directions_service_quota_manager,h=e.proxy(function(){return n.is_directions_based?c.test(this.dragging?1:2):!0},this);this.api.addEventListener({obj:this.marker,event:"click",callback:e.proxy(function(e){i.log("HoverMarker click"),l||(s.push({event:"Route Manipulation",action:"extend route along itself"}),this.Map.handleMapClick(e))},this)},this),this.api.addEventListener({obj:this.marker,event:"dragstart",callback:e.proxy(function(){if(i.log("HoverMarker dragstart"),t.publishSync(this.map_id+".begin.altering.map"),n=this.getTargetSegment(),o=n.getNextSegment(),this.marker.getVisible()){if(n.markers[0].hovering||o&&o.markers[0].hovering)return l=!0,void 0;l=!1,n.disable(),o&&o.disable(),this.toggleDrag(!0),n.toggleDrag(!0),r=n.polyline.getPath().getArray().slice(0)}},this)},this),this.api.addEventListener({obj:this.marker,event:"drag",callback:e.proxy(function(e){i.log("HoverMarker drag"),!l&&this.marker.getVisible()&&(window.clearInterval(a),a=window.setTimeout(function(){h()?(i.log("Hovermarker drag -- ready to render"),window.clearInterval(a),n.setPoints({points:[r[0],e,r.slice(-1)[0]]})):i.log("failed render_availability_check()")},500))},this)},this),this.api.addEventListener({obj:this.marker,event:"dragend",callback:e.proxy(function(t){i.log("HoverMarker dragend"),!l&&this.marker.getVisible()&&(window.clearInterval(a),a=window.setTimeout(e.proxy(function(){h()&&(window.clearInterval(a),n.enable(),o&&o.enable(),this.toggleDrag(!1),n.toggleDrag(!1),this.setVisible(!1),n.subdivide(t))},this),500))},this)},this)},setTargetSegment:function(e){this.target_segment=e}});return a}),mmf_mapping_api.define("classes/StateManager",["jquery","pubsub","namespace","map_configs","constants","logger","message_mgr","utils/array","classes/Class"],function(e,t,i,n,s,o,r,a,l,c){var h=30,u=l.extend({init:function(e){this.map_id=e,this.messager=r.get(e),s.max_undo_stack_size>h&&o.log("Stack size setting exceeds the maximum allowed stack size. Using maximum of ",h),this.max_stack_size=s.max_undo_stack_size<h?s.max_undo_stack_size:h,this.undo=[],this.redo=[]},getRedo:function(e){return e===c?this.redo.slice():this.redo.slice()[e]},getLastUndo:function(){return this.undo.length?this.undo.slice(-1)[0]:c},getUndo:function(e){return e===c?this.undo.slice():this.undo.slice()[e]},popRedo:function(){return 0===this.redo.length?(o.warn("Redo stack is empty."),void 0):this.redo.pop()},popUndo:function(){return 0===this.undo.length?(o.warn("Undo stack is empty."),void 0):this.undo.pop()},pushRedo:function(e){this.redo.push(e)},pushUndo:function(e,t){return t||(this.redo.length=0),this.undo.length>0&&e===this.undo.slice(-1)[0]?(o.warn("Undo state identical to state on top of stack. Not adding."),void 0):(this.undo.push(e),this.undo.length>this.max_stack_size&&(this.undo=this.undo.slice(-1*this.max_stack_size)),void 0)}});return u}),mmf_mapping_api.define("classes/Map",["jquery","pubsub","simplify","logger","message_mgr","utils/map_helpers","utils/calculations","utils/geocode","utils/geolocation","constants","map_configs","storage","config/marker_def","globals/hover_markers","config/map_types","uris","config/regexp","libs/google/Adapter","classes/Class","classes/Collection","classes/UserInterface","classes/Segments","classes/ManualSegment","classes/AutoSegment","classes/Marker","classes/DistanceMarker","classes/FloatingMarker","classes/RouteOriginMarker","classes/HoverMarker","classes/StateManager","utils/gtm"],function(e,t,i,n,s,o,r,a,l,c,h,u,p,d,f,g,m,v,_,y,b,x,w,k,M,T,C,E,P,z,D,S){var I=_.extend({init:function(t,i){return this.user_has_altered_map=!1,this.map_id=t,this.state_manager=new z(t),this.map_config=h.get(t),this.messager=s.get(t),i?(this.container=e(i).get(0),this.api=null,this.map=null,this.timeouts={cue_notes:null,check_bicycle_directions:null,click_event_distinguishinator:null,map_idle:null,update_floating_marker_positions:null},this.bounds=null,this.meta={},this.distance=null,this.segments=null,this.markers=null,this.distance_markers=null,this.cue_notes=[],this.elevations=[],this.kml_layers={},this.route_origin_point=null,this.route_origin_marker=null,this.marker_dialog=null,this.start_drawing_message=null,this.google_maps_bicycle_directions_areas=null,this.bicycling_directions_available=!1,this.map_state={initialized:!1,panning:!1,zooming:!1},this.highlighter={polyline:null,markers:null},this.pointer=null,this.last_route_point=null,this.map_interaction_wait_threshold=2e3,this.user_interface=null,this.loaded=null,this.loading=!1,this.rendering=[],this.rendering_deferred=null,this.api=new v({map_id:this.map_id,unit:h.unit(this.map_id)}),u.setApi(this.api),this.class_parms={api:this.api,Map:this,map:S,map_id:this.map_id},this.createMap(this.container),this.subscribeToTopics(),void 0):(this.messager.error("No map container passed. Terminating map creation."),!1)},activateMarkerDialog:function(t){var i={content:this.user_interface.generateMarkerDialogContent(t),disableAutoPan:!1,position:t.point,isHidden:!1,enableEventPropagation:!1,alignBottom:!0,pixelOffset:{height:0,width:-85},closeBoxURL:g.img+"info_close.png",closeBoxMargin:"0px"};mmf_mapping_api.require(["InfoBox"],e.proxy(function(e){this.marker_dialog=this.marker_dialog||new e,this.marker_dialog.setOptions(i),this.marker_dialog.open(this.map)},this))},activateFloatingMarkerDialog:function(i){var n=e.proxy(function(e){e.preventDefault(),e.stopPropagation(),t.publishSync(this.map_id+".begin.altering.map")},this);i.remove_point_callback=e.proxy(function(e){n(e),this.markers.remove(i.Marker),i.Marker.destroy(),this.deactivateMarkerDialog()},this),i.floating_marker=!0,this.activateMarkerDialog(i)},activateLocationMarker:function(t){if(this.map_config.map.display.location_indicator!==!1){t=t||{};var i=t.point||this.map.getCenter();this.location_marker||(this.location_marker=new M(e.extend(!0,{marker_options:{clickable:!1,draggable:!1,editable:!1,flat:!0,icon:p.get("Location").icon},icon_id:p.get("Location").desc},this.class_parms))),this.location_marker.setPosition({point:i}),this.location_marker.render()}},activateRouteHighlighter:function(t){var i,n,s=t.path.length;this.highlighter.polyline=this.highlighter.polyline||new this.api.api.Polyline({clickable:!1,editable:!1,geodesic:!0,strokeColor:t.stroke_color||"#00FF66",strokeOpacity:this.map_config.map.paths.common.polylineOptions.strokeOpacity,strokeWeight:this.map_config.map.paths.common.polylineOptions.strokeWeight+5}),n=this.highlighter.polyline.getPath(),t.path[0].equals(n.getAt(0))?t.path[s-1].equals(n.getAt(n.length-1))||(i=t.path[s-1]):i=t.path[0],this.highlighter.polyline.setMap(this.map),this.highlighter.polyline.setPath(t.path),this.highlighter.markers=this.highlighter.markers||[new M(e.extend(!0,{marker_options:{clickable:!1,draggable:!1,icon:p.getStart().icon}},this.class_parms)),new M(e.extend(!0,{marker_options:{clickable:!1,draggable:!1,icon:p.getEnd().icon}},this.class_parms))],this.highlighter.markers[0].setPosition({point:t.path[0]}),this.highlighter.markers[1].setPosition({point:t.path.slice(-1)[0]}),i&&!this.map.getBounds().contains(i)&&this.map.panTo(i)},addKmlLayer:function(t){var i=this.api.createKmlLayer(e.extend(!0,{clickable:!1,preserveViewport:t.preserve_map_bounds,suppressInfoWindow:!0,url:t.url},t,{map:this.map})),n="kml_"+Date.now();return i.uid=n,this.kml_layers[n]=i,i},activatePointer:function(t){this.pointer=this.pointer||new M(e.extend(!0,{marker_options:{clickable:!1,draggable:!1,icon:p.get("pointer").icon}},this.class_parms)),this.pointer.setPosition({point:t}),this.pointer.render()},activateRouteMarkerDialog:function(i){var n=e.proxy(function(e){e.preventDefault(),e.stopPropagation(),t.publishSync(this.map_id+".begin.altering.map")},this);this.segments.isLast(i.segment)&&1===i.marker_index||(i.loop_to_point_callback=e.proxy(function(e){n(e),this.handleMapClick(i.point)},this),i.subdivide_segment_callback=e.proxy(function(e){n(e),i.segment.subdivide()},this)),i.remove_point_callback=e.proxy(function(e){n(e),this.segments.remove(i.segment.getIndex()),i.segment.destroy({marker_index:i.marker_index}),this.deactivateMarkerDialog()},this);var s={Marker:i.Marker,point:i.point,marker:i.marker,segment:i.segment};1!==i.marker_index&&(i.remove_points_after_callback=e.proxy(function(e){n(e),this.destroyPointsAfter(s)},this)),i.segment.getIndex()>0&&(i.remove_points_before_callback=e.proxy(function(e){n(e),this.destroyPointsBefore(s)},this)),this.activateMarkerDialog(i)},activateRouteMode:function(e){for(var t=0,i=this.segments.length();i>t;t++)this.segments.get(t).toggleRouteMode(e)},addCustomMapControls:function(e){var t={left_top:this.api.api.ControlPosition.LEFT_TOP,bottom_right:this.api.api.ControlPosition.BOTTOM_RIGHT};this.map.controls[t[e.position]].push(e.control)},addFloatingMarker:function(t){this.markers=this.markers||new y(e.extend(!0,{name:"marker"},this.class_parms)),n.log("addFloatingMarker.parms:",t);var i=new C(e.extend(!0,{point:t.point||this.getMapCenter().point,icon_id:t.icon_id||t.desc,icon:t.icon},t,this.class_parms));this.markers.push(i)},addSegment:function(t){var i;return this.segments=this.segments||new x(this.class_parms),t.index=t.index===S?this.segments.length():t.index,this.segments.insert(null,t.index),i=this.createSegment(t),this.segments.set(i,t.index),i&&i.init_deferred.done(e.proxy(function(){var e=i.getTravelMode();i.status.error&&(i.destroy(),this.segments.remove(t.index),e!==c.travel_modes.DIRECT&&(n.log("addSegment fallback travel_mode:",e),t.travel_mode=c.travel_modes.DIRECT,n.log("addSegment fallback parms:",t),this.addSegment(t)))},this)),i},calculateRouteDistance:function(){var e,t,i=0;for(e=0,t=this.segments.length();t>e;e++)i+=this.segments.get(e).distance;return i},centerMap:function(e){var t=e.vertex||e.point||this.api.createPoint(e);this.map.setCenter(t),this.activateLocationMarker(),e.preserve_map_zoom||(e.bounds?this.map.fitBounds(e.bounds):this.map.setZoom(this.getAppropriateZoomLevel(e)))},centerMapOnRoute:function(){var e=this.getRouteBounds();e.isEmpty()||this.fitMapToBounds(e)},centerMapOnUserLocation:function(){l.locate(e.proxy(function(e){e.location?this.centerMap(e.location):e.error&&this.messager.error(e.error)},this))},checkIfBicyclingDirectionsAvailable:function(e){var t,i,n=this.google_maps_bicycle_directions_areas.length,s=!1;for(t=0;n>t;t++)if(i=this.google_maps_bicycle_directions_areas[t],i.containsLatLng(e)){s=!0;break}return s},clearMap:function(){if(window.clearTimeout(this.timeouts.map_idle),this.destroyRouteGuideline(),this.destroyRouteOrigin(),this.destroyDistanceMarkers(),this.deactivatePointer(),this.deactivateLocationMarker(),this.markers)for(;this.markers.length();)this.markers.pop().destroy();this.destroySegments(),this.destroyKmlLayers(),t.publish(this.map_id+".updated.route"),this.updateCueNotes()},coordinatesToVertices:function(t){if(!t.coordinates||!t.coordinates.length)return[];var i,s,o=t.coordinates,r=[],a=e.proxy(function(e){return this.api.createPoint({longitude:e[0],latitude:e[1]})},this);if(o[0].hasOwnProperty("type")&&"Point"===o[0].type)for(i=0,s=o.length;s>i;i++)r.push(a(o[i].coordinates));else if(o[0]instanceof Array)for(i=0,s=o.length;s>i;i++)r.push(a(o[i]));else n.error("Array passed for Vertex conversion not recognized.");return r},createDistanceMarkers:function(){if(h.showDistanceMarkers(this.map_id)&&this.segments&&this.segments.length()){if(this.rendering.length>0)return n.warn("Route is rendering, cancelling distance marker creation"),void 0;if(this.distance_markers=this.distance_markers||new y(e.extend(!1,{name:"distance_marker"},this.class_parms)),this.distance_markers.get().length>0&&this.destroyDistanceMarkers(),this.guideline){var t,i,s,o,a;switch(t=h.distanceMarkerInterval(this.map_id),i=this.map.getZoom(),a=0===i?0:Math.floor(i/2)){case 0:s=1e3;break;case 1:s=500;break;case 2:s=100;break;case 3:s=50;break;case 4:s=25;break;case 5:s=5;break;default:s=1}t=s>t?s:t;var l=h.unit(this.map_id)===c.units.METRIC?r.kilometersToMeters(t):r.milesToMeters(t);if(l>this.getRouteDistance())return;o=this.guideline.getPointsAtDistance(l);var u,p=0,d=this.map.getBounds();for(o.reverse();o.length;)p+=t,u=o.pop(),d.contains(u)&&this.distance_markers.push(new T(e.extend(!1,{label:""+p,point:u},this.class_parms)));this.distance_markers.length>0&&this.marker_dialog.isHidden_===!1&&(this.marker_dialog.hide(),this.marker_dialog.show())}}},createInfoWindow:function(e){return e=e||{latitude:S,longitude:S},this.api.createInfoWindow(e)},createMap:function(t){var i=e.Deferred();o.getInitialPosition({deferred:i,initial_position:this.map_config.map.init.position}),i.done(e.proxy(function(i){i||(this.messager.warning("Your starting location could not be found. Using a default starting location."),i=this.map_config.geolocation.position);var n=e.extend(!0,{},this.map_config.map.init),s={container:t,draggable_cursor:"crosshair",map_type:n.map_type,map_type_control_options:{map_type_ids:n.map_types},max_zoom:n.max_zoom,min_zoom:n.min_zoom,overview_map_control:n.overview_map_control,overview_map_control_options:n.overview_map_control_options,pan_control:n.pan_control,position:i,scrollwheel:h.scrollWheelZoom(this.map_id),zoom:n.zoom||this.getAppropriateZoomLevel(i),zoom_control:n.zoom_control,zoom_control_options:n.zoom_control_options};"undefined"!=typeof n.map_type_control_options&&"undefined"!=typeof n.map_type_control_options.position&&(s.map_type_control_options.position=n.map_type_control_options.position),"undefined"!=typeof n.street_view_control_options&&(s.street_view_control_options=n.street_view_control_options),this.map=this.class_parms.map=this.api.createMap(s),this.initMap(),this.map_config.map_ready instanceof Function&&this.map_config.map_ready()},this))},createSegment:function(t){return t.travel_mode&&c.isValidTravelMode(t.travel_mode)||(t.travel_mode=h.followRoads(this.map_id)?h.travelMode(this.map_id):c.travel_modes.DIRECT),t=e.extend(!0,{segments:this.segments},t,this.class_parms),d.get(this.map_id)||this.initHoverMarker(),c.travel_modes.hasOwnProperty(t.travel_mode.toUpperCase())?t.travel_mode===c.travel_modes.DIRECT?new w(t):new k(t):(n.error("Failure to create new segment. Travel mode "+t.travel_mode+" not recognized."),void 0)},destroyDistanceMarkers:function(){if(!this.distance_markers||!this.distance_markers.length())return n.log("No distance markers to destroy."),void 0;var e,t,i=this.distance_markers,s=i?i.get():[];for(e=0,t=s.length;t>e;e++)s[e].destroy();i.clear()},deactivateLocationMarker:function(){this.location_marker&&this.location_marker.setMap(null)},deactivateMarkerDialog:function(){this.marker_dialog&&this.api.deactivateInfoWindow({info_window:this.marker_dialog})},deactivatePointer:function(){this.pointer&&this.pointer.destroy()},destroyRouteGuideline:function(){this.guideline&&(this.guideline.setPath([]),this.guideline.setMap(null))},deactivateRouteHighlighter:function(){this.highlighter.polyline.setMap(null),this.highlighter.markers[0].setMap(null),this.highlighter.markers[1].setMap(null)},destroyKmlLayers:function(){var e,t=this.kml_layers;for(e in t)t.hasOwnProperty(e)&&this.removeKmlLayer(e)},destroyPointsAfter:function(e){var t=e.segment,i=0===t.getIndex()&&e.point===t.points[0],n=e.point===t.points.slice(-1)[0];if(!n)if(i)this.clearMap(),this.handleMapClick(e.point);else for(;t.getIndex()<this.segments.length();)this.segments.pop().destroy()},destroyPointsBefore:function(e){var t=e.segment,i=0===t.getIndex()&&e.point===t.points[0],n=e.point===t.points.slice(-1)[0];if(!i)if(n)this.clearMap(),this.handleMapClick(e.point);else for(;t.getIndex()>0;)this.segments.dequeue().destroy()},destroyRouteOrigin:function(){this.route_origin_marker&&(this.api.clearEventListeners({obj:this.route_origin_marker}),this.route_origin_point=null,this.route_origin_marker.setMap(null),this.route_origin_marker=null)},destroySegments:function(){if(this.segments){for(;this.segments.length()>1;)this.segments.pop().destroy({mute:!0});this.segments.length()&&this.segments.pop().destroy()}},doubleBack:function(){for(var e,t,i=this.segments,n=i.length()-1;n>=0;n--)e=i.get(n),t=e.getPoints(),this.addSegment({travel_mode:e.getTravelMode(),points:[t.slice(-1)[0],t[0]],waypoints:[],polyline_options:{strokeColor:"#FFFF00",strokeWeight:3}})},fitMapToBounds:function(e){this.map.fitBounds(e)},getAppropriateZoomLevel:function(e){var t=this.map_config.map.init.zoom;return e.latitude&&e.longitude&&(t=16),e.address?t=16:e.city?t=14:e.country_code?t=5:e.region&&(t=7),t},getCueNotes:function(){return this.cue_notes},getMapCenter:function(){var e=this.map.getCenter();return{latitude:e.lat(),longitude:e.lng(),point:e}},getRouteBounds:function(e){this.bounds=this.api.createLatLngBounds(),e=e||this.getRoutePoints();for(var t=0,i=e.length;i>t;t++)this.bounds.extend(e[t]);return this.bounds},getRouteDistance:function(){return this.distance},getRoutePoints:function(){var e,t=[];if(this.segments&&this.segments.length()){for(var i=0,n=this.segments.length();n>i;i++)e=this.segments.get(i).getPoints(),t=t.concat(e.slice(0,-1));t.push(e.slice(-1)[0])}return t},goToAddress:function(t){var i=t.address,s=t.callback||function(){};if(0===i.length)return n.warn("Address search was executed with no address."),void 0;var o=i.match(m.lat_lng);if(o){var r=o[0].split(",");this.centerMap({latitude:parseFloat(r[0]),longitude:parseFloat(r[1])}),s({point:this.getMapCenter().point})}else a.geocode({address:i,callback:e.proxy(function(i,o){var r="";i.error.length>0?(n.error("goToAddress:",o),r="There was a problem locating the address provided. Please check that the address is valid and try again.",this.messager.error(r)):this.centerMap(e.extend(!0,{},t,i.output,{bounds:i.output.viewport_bounds})),s({point:this.getMapCenter().point,error:i.error})},this)})},handleFirstMapClick:function(i){var n=new E(e.extend(!1,{point:i},this.class_parms));this.route_origin_point=i,this.route_origin_marker=n,this.initRouteOrigin(),this.user_has_altered_map=!0,t.publish(this.map_id+".user.clicked.map")
},handleMapBoundsChanged:function(){this.map_state.panning||(this.map_state.panning=!0,this.destroyDistanceMarkers())},handleMapClick:function(e){this.map_config.map.events.click instanceof Function&&this.map_config.map.events.click(e),h.allowFeature(this.map_id,"mouse_events")!==!1&&(this.last_route_point=e,t.publishSync(this.map_id+".begin.altering.map"),!this.segments||this.segments.isEmpty()?this.route_origin_point?this.handleSecondMapClick(e):this.handleFirstMapClick(e):this.handleStandardMapClick(e),h.centerOnClick(this.map_id)&&this.map.panTo(e))},handleMapIdle:function(){this.map_state.initialized&&(n.log("Map Idle"),this.map_state.panning=!1,window.clearTimeout(this.timeouts.map_idle),this.timeouts.map_idle=window.setTimeout(e.proxy(function(){this.loading===!1&&0===this.rendering.length&&this.distance_markers&&this.refreshDistanceMarkers()},this),1e3),window.clearTimeout(this.timeouts.check_bicycle_directions),this.timeouts.check_bicycle_directions=window.setTimeout(e.proxy(function(){this.updateBicyclingDirectionsState()},this),1e3))},handleMapMouseMove:function(i){return this.user_has_altered_map||"view"===h.apiMode(this.map_id)?(this.handleMapMouseMove=function(){},void 0):(mmf_mapping_api.require(["InfoBox"],e.proxy(function(n){this.start_drawing_message?(this.start_drawing_message.setPosition(i),this.start_drawing_message.show()):(this.start_drawing_message=new n({content:'<div><div class="mmf_mapping_api mmf_marker_dialog click_to_start"><p>Click to start mapping a route.</p></div></div><div class="mmf_mapping_api mmf_marker_dialog_tip_container"><div class="mmf_marker_dialog_tip"></div></div>',disableAutoPan:!0,enableEventPropagation:!0,position:i,alignBottom:!0,pixelOffset:{height:-8,width:-70},closeBoxURL:""}),this.start_drawing_message.open(this.map)),t.subscribe(this.map_id+".user.clicked.map",e.proxy(function(){this.start_drawing_message&&this.start_drawing_message.hide()},this))},this)),void 0)},handleMapMouseOut:function(){this.start_drawing_message&&this.start_drawing_message.hide&&this.start_drawing_message.hide()},handleSecondMapClick:function(e){this.addSegment({points:[this.route_origin_point,e]}),this.destroyRouteOrigin()},handleStandardMapClick:function(e){this.addSegment({points:[this.segments.getLast().points.slice(-1)[0],e]})},initHoverMarker:function(){var e=new P(this.class_parms);d.set(this.map_id,e)},initMap:function(){var i=e.Deferred();mmf_mapping_api.require(["geojson_conversion","point_in_polygon"],e.proxy(function(e){this.google_maps_bicycle_directions_areas=e(c.google_maps_bicycle_directions_areas),this.updateBicyclingDirectionsState(),i.resolve(),n.log("google_maps_bicycle_directions_areas setup complete")},this)),this.user_interface=new b(e.extend(!1,{container:this.container},this.class_parms)),this.map_config.user_interface.display.geolocation&&this.addCustomMapControls({control:this.user_interface.generateGeolocationControl().click(e.proxy(function(e){e.preventDefault(),e.stopPropagation(),D.push({event:"Route Marker Actions",routeMarkerEvent:"geolocate"}),this.centerMapOnUserLocation()},this)).get(0),position:"left_top"}),this.initOverlays(),this.activateLocationMarker();var s=30;h.allowFeature(this.map_id,"mouse_events")&&(this.api.addEventListener({obj:this.map,event:"dblclick",callback:e.proxy(function(){window.clearTimeout(this.timeouts.click_event_distinguishinator)},this)},this),this.map_config.map.display.start_drawing_message&&(this.api.addEventListener({obj:this.map,event:"mousemove",callback:e.proxy(function(e){this.handleMapMouseMove(e)},this)},this),this.api.addEventListener({obj:this.map,event:"mouseout",callback:e.proxy(function(){this.handleMapMouseOut()},this)},this))),this.api.addEventListener({obj:this.map,event:"click",callback:e.proxy(function(t){this.timeouts.click_event_distinguishinator=window.setTimeout(e.proxy(function(){this.handleMapClick(t)},this),s)},this)},this),this.api.addEventListener({obj:this.map,event:"bounds_changed",callback:e.proxy(function(){this.handleMapBoundsChanged()},this)}),this.api.addEventListener({obj:this.map,event:"idle",callback:e.proxy(function(){this.handleMapIdle()},this)});var o,r,a=e.proxy(function(t){var i=e("<div>").css({fontSize:"11px",marginRight:"-45px",whiteSpace:"nowrap"}),n=e("<span>").css({color:"#000000"}).html(t);i.append(n),this.addCustomMapControls({control:i.get(0),position:"bottom_right"})},this);this.api.addEventListener({obj:this.map,event:"maptypeid_changed",callback:e.proxy(function(){var e=this.map.controls[this.api.api.ControlPosition.BOTTOM_RIGHT];e.getLength()>0&&e.pop(),o=this.api.getMapType(),r=f.hasOwnProperty(o)?f[o].attribution:S,r&&a(r),h.setMapType(this.map_id,o)},this)});var l,u=this.map_config.map.init.map_types,p=c.map_types[this.map_config.map.init.map_type],d=u.length;for(l=0;d>l;l++)this.api.addMapType(f[u[l]]);e.inArray(p,u)>-1&&this.api.setMapType(p),i.done(e.proxy(function(){this.map_state.initialized=!0,t.publish(this.map_id+".initialized.map",this.map)},this)),n.log("initMap complete")},initOverlays:function(){h.showBicyclePaths(this.map_id)&&this.toggleMapOverlay("bicycle_paths",!0),h.showTraffic(this.map_id)&&this.toggleMapOverlay("traffic",!0)},initRouteOrigin:function(){this.api.addEventListener({obj:this.route_origin_marker.getMarker(),event:"drag",callback:e.proxy(function(e){this.route_origin_point=e},this)}),this.api.addEventListener({obj:this.route_origin_marker.getMarker(),event:"click",callback:e.proxy(function(){window.confirm("Delete this waypoint from the route?")&&this.destroyRouteOrigin()},this)})},loadRoute:function(i){if(i&&i.route){this.loading=!0;var n=i.route,s=i.preserve_map_bounds,o=i.bypass_optimization,r=this.segments?!1:!0,a=r,l=e.proxy(function(e){return this.api.createPoint({longitude:e[0],latitude:e[1]})},this),h=i.load_static_data!==S?i.load_static_data:r;r&&t.publish("start.processing",{text:"Loading route..."});var u=e.proxy(function(n){r||this.clearMap(),this.segments=this.segments||new x(this.class_parms),this.meta=n.meta||this.meta;var u,d,f,g,m,v,_,y,b,w,k=n.markers,M=n.segments;if(k&&k.length)for(_=0,y=k.length;y>_;_++)u=k[_],this.addFloatingMarker(e.extend(!0,{},{animate:r,icon_id:p.get(u.properties.iconId).desc,notes:u.properties.notes,point:l(u.geometry.coordinates)}));if(0===M.length)return this.messager.error("Route must consist of one or more segments. Map load halted."),void 0;var T=e.proxy(function(t){var i=t.properties.notes&&t.properties.notes.length>0?e.map(t.properties.notes,function(e){return e.point=l(e.geometry.coordinates),e.point.isValid()?e:void 0}):[];this.addSegment({render_static_data:h,notes:i&&i.length>0?i:S,points:e.map(t.geometry.coordinates,e.proxy(function(e){return l(e)},this)),travel_mode:f===c.travel_modes.DIRECT?c.travel_modes.DIRECT:c.travel_modes.WALKING})},this);for(_=0,y=M.length;y>_;_++){if(d=M[_],f=d.properties.travelMode,!c.isValidTravelMode(f))return this.messager.error('Travel mode "'+f+'" not recognized. Map load halted.'),void 0;if(f===c.travel_modes.DIRECT){g=!o&&d.geometry.coordinates.length>200?this.simplifyPolyline(d.geometry.coordinates):d.geometry.coordinates;var C=d.properties;for(b=0,w=g.length;w-1>b;b++)m=g[b],v=g[b+1],T({properties:C,geometry:{type:"LineString",coordinates:[[m[0],m[1]],[v[0],v[1]]]}}),C.notes=[]}else a=!1,T(d)}var E=window.setInterval(e.proxy(function(){this.rendering.length||(window.clearInterval(E),s||this.map.fitBounds(this.getRouteBounds()),a&&t.publish(this.map_id+".enable.snap_to_roads"),this.loading=!1,this.loaded=!0,this.user_has_altered_map=!0,t.publish(this.map_id+".updated.route"),t.publish(this.map_id+".updated.cue_notes"),this.map_config.map_ready instanceof Function?(this.map_config.map_ready(),delete this.map_config.map_ready):i.callback instanceof Function&&i.callback(),r&&t.publish("end.processing"))},this),200)},this)(n);return u}},loopToRouteOrigin:function(){t.publishSync(this.map_id+".begin.altering.map");var e=this.segments.get(0).getPoints()[0];this.handleMapClick(e)},refreshDistanceMarkers:function(){this.destroyDistanceMarkers(),this.createDistanceMarkers()},resizeMap:function(){var e=this.getMapCenter();this.api.resizeMap({map:this.map}),this.map.setCenter(e)},reverseRoute:function(e){e=e||{},this.segments.reverse();for(var t=0,i=this.segments.length();i>t;t++)this.segments.get(t).reversePoints()},refreshRouteGuideline:function(){n.log("Map: refreshRouteGuideline");var t="view"===h.apiMode(this.map_id),i=e.extend(!0,{},this.map_config.map.paths.direct.polylineOptions,this.map_config.map.paths.common.polylineOptions);this.guideline=this.guideline||this.api.createPolyline({clickable:!1,geodesic:!0,editable:!1,strokeColor:i.strokeColor,strokeOpacity:i.strokeOpacity,strokeWeight:i.strokeWeight,visible:!1}),this.guideline.setPath(this.getRoutePoints()),(t||c.debug)&&(this.guideline.setMap(this.map),this.guideline.setOptions({visible:!0}))},setBicyclingDirectionsState:function(e){this.bicycling_directions_available=e,this.user_interface.setBicyclingDirectionsAvailable(e)},setMapOptions:function(e){this.api.setMapOptions(e)},setRouteDistance:function(e){this.distance=e},setRouteElevations:function(i){this.elevations={actions:{showPoint:e.proxy(function(e){this.activatePointer(e)},this),hidePoint:e.proxy(function(){this.deactivatePointer()},this)},data:i,meta:{distance:this.getRouteDistance()}},t.publish(this.map_id+".updated.route.elevations",this.elevations)},setZoom:function(e){this.map.setZoom(e)},simplifyPolyline:function(t){var n=c.route_optimization_tolerance,s=t.length;1e3>s?n=5e-5:s>=1e3&&4e3>s?n=1e-4:s>=4e3&&(n=15e-5);for(var o=e.map(t,function(e){return{x:e[0],y:e[1]}}),r=i(o,n,!1),a=[],l=0,h=r.length;h>l;l++)a.push([r[l].x,r[l].y]);return a},snapRouteToRoads:function(){t.publishSync(this.map_id+".begin.altering.map"),this.destroyDistanceMarkers();var e,i,n=this.segments.get().slice(0);for(this.segments.clear(),e=0,i=n.length;i>e;e++)this.addSegment({points:n[e].getPoints(),travel_mode:c.travel_modes.WALKING}),n[e].destroy()},subscribeToTopics:function(){t.subscribe(this.map_id+".add.floating_marker",e.proxy(function(e,i){t.publishSync(this.map_id+".begin.altering.map"),this.addFloatingMarker(i)},this)),t.subscribe(this.map_id+".activated.floating_marker",e.proxy(function(e,t){this.activateFloatingMarkerDialog(t)},this)),t.subscribe(this.map_id+".activated.route.marker",e.proxy(function(e,t){this.activateRouteMarkerDialog(t)},this)),t.subscribe(this.map_id+".begin.altering.map",e.proxy(function(){this.user_has_altered_map=!0,this.destroyDistanceMarkers(),this.deactivatePointer(),this.state_manager.pushUndo(this.toJSON())},this)),t.subscribe(this.map_id+".destroyed.segment",e.proxy(function(e,t){this.segments.isEmpty()&&t.point&&this.handleFirstMapClick(t.point)},this)),t.subscribe(this.map_id+".map_config.set.unit",e.proxy(function(){this.deactivateMarkerDialog()},this)),t.subscribe(this.map_id+".mapped.via_directions_mode",e.proxy(function(i,n){t.publishSync(this.map_id+".begin.altering.map"),this.clearMap(),this.addSegment({init_origin_address:n.path[0],init_destination_address:n.path[1],travel_mode:n.travel_mode});var s=window.setInterval(e.proxy(function(){this.segments&&this.segments.get(0).status.initialized&&(window.clearInterval(s),this.map.fitBounds(this.getRouteBounds()))},this),500)},this)),t.subscribe(this.map_id+".altered.floating_marker",e.proxy(function(e,t){this.updateFloatingMarkerPosition(t.marker)},this)),t.subscribe(this.map_id+".set.distance_marker_interval",e.proxy(function(){this.refreshDistanceMarkers()},this)),t.subscribe(this.map_id+".set.map_options",e.proxy(function(e,t){this.setMapOptions(t)},this)),t.subscribe(this.map_id+".toggled.distance_markers",e.proxy(function(){this.refreshDistanceMarkers()},this)),t.subscribe(this.map_id+".toggled.bicycle_paths",e.proxy(function(e,t){this.toggleMapOverlay("bicycle_paths",t.bool)},this)),t.subscribe(this.map_id+".toggled.traffic",e.proxy(function(e,t){this.toggleMapOverlay("traffic",t.bool)},this)),t.subscribe(this.map_id+".toggle.unit",e.proxy(function(){var i=e.inArray(this.map_config.unit,c.units);this.map_config.unit=c.units[i+1]||c.units[0],t.publish(this.map_id+".updated.route.distance",this.getRouteDistance())},this)),t.subscribe(this.map_id+".updated.map",e.proxy(function(){},this)),t.subscribe(this.map_id+".updated.route",e.proxy(function(){window.clearInterval(this.updated_route_interval),window.clearInterval(this.update_elevation_interval),this.updated_route_interval=window.setInterval(e.proxy(function(){this.loading||this.rendering.length>0||(window.clearInterval(this.updated_route_interval),window.clearInterval(this.update_elevation_interval),this.deactivateMarkerDialog(),this.refreshRouteGuideline(),this.update_elevation_interval=window.setInterval(e.proxy(function(){window.clearInterval(this.update_elevation_interval),this.updateRouteElevations()},this),1800),this.refreshDistanceMarkers())},this),500)},this)),t.subscribe(this.map_id+".map_config.set.unit",e.proxy(function(){this.updateRouteElevations(),this.updateCueNotes(),this.refreshDistanceMarkers(),t.publish(this.map_id+".updated.route.distance",this.getRouteDistance())},this)),t.subscribe(this.map_id+".updated.cue_notes",e.proxy(function(){this.loading||0!==this.rendering.length||(this.timeouts.cue_notes&&window.clearTimeout(this.timeouts.cue_notes),this.timeouts.cue_notes=window.setTimeout(e.proxy(function(){this.updateCueNotes()},this),this.map_interaction_wait_threshold))},this)),t.subscribe(this.map_id+".updated.segment.distance",e.proxy(function(){0===this.rendering.length&&(this.setRouteDistance(this.calculateRouteDistance()),this.updateFloatingMarkerPositions(),t.publish(this.map_id+".updated.route.distance",this.getRouteDistance()))},this))},toggleMapOverlay:function(e,t){var i={bicycle_paths:[this.api.activateBicyclingLayer,this.api.deactivateBicyclingLayer],traffic:[this.api.activateTrafficLayer,this.api.deactivateTrafficLayer]};i[e][t?0:1].call(this.api)},toJSON:function(){var t,i,n,s={api:{version:c.version},areas:[],meta:e.extend(!0,{},this.meta,{distance:this.distance}),markers:[],segments:[],timestamp:(new Date).toString()};if(this.markers&&this.markers.length())for(i=0,n=this.markers.length();n>i;i++)t=this.markers.get(i).toJSON(),t.properties.iconId=p.get(t.properties.iconId).id,s.markers.push(t);if(this.segments&&this.segments.length())for(i=0,n=this.segments.length();n>i;i++)t=this.segments.get(i).toJSON(),t.properties.iconIds[0]=p.get(t.properties.iconIds[0]).id||0,t.properties.iconIds[1]=p.get(t.properties.iconIds[1]).id||0,s.segments.push(t);return s},removeKmlLayer:function(e){this.kml_layers.hasOwnProperty(e)&&(this.kml_layers[e].setMap(null),delete this.kml_layers[e])},renderInProgress:function(){this.rendering.push(!0)},renderComplete:function(){return 0===this.rendering.length?(n.warn("Tried to complete a render but rendering array is empty."),void 0):(this.rendering.pop(),void 0)},undo:function(){var e=this.state_manager.popUndo();if(e){if(0===e.segments.length)return this.clearMap(),void 0;this.loadRoute({route:e,preserve_map_bounds:!0,bypass_optimization:!0,load_static_data:!0})}},updateBicyclingDirectionsState:function(){var e,t=this.getMapCenter().point;return e=this.checkIfBicyclingDirectionsAvailable(t),this.setBicyclingDirectionsState(e),e},updateCueNotes:function(){var i=[];if(this.segments&&this.segments.length()){var s,r,a,l=function(){var t="info",i={slightleft:"up left",slightright:"up right"},s=new window.RegExp(/north\s?east|north\s?west|south\s?east|south\s?west|north|south|east|west|slight\s?(<.*>)?right|slight\s?(<.*>)?left|right|left/i),r=new window.RegExp(/\s|(<.*>)/g),a=e("<div>");return function(l){if(!l)return n.error("No parms passed."),void 0;var c,h,u;return l.icon?c=l.icon:(l.icon_id?u=l.icon_id:l.text&&(u=l.text.match(s),u=u?u[0].replace(r,"").toLowerCase():""),u=u?u in i?i[u]:u:t,c=p.get(u)),h=e("<img>"),h.attr({alt:c.desc,src:o.transparentGif(),title:c.desc}).css({backgroundImage:"url("+c.icon.url+")",backgroundRepeat:"no-repeat",backgroundPosition:c.icon.origin.x+"px "+c.icon.origin.y+"px",height:c.icon.size.height,width:c.icon.size.width}),a.html("").append(h).html()}}(),h=0,u=new RegExp(/(<div.*Destination[\w\s]+<\/div>)/i),d=this.segments.get(),f=d.length,g={distance:this.distance,icon:p.getEnd().icon,point:d.length>0&&d[d.length-1].points.slice(-1)[0],text:"Destination"};e.each(d,e.proxy(function(t,n){s=n.getCueNotes(),t===d.length-1&&s.push(g),r=s.length,i=i.concat(e.map(s,e.proxy(function(o,d){return h++,f-1>t&&d===r-1&&(o.text=o.text.replace(u,"")),t===f-1&&d===r-2&&(a=u.exec(o.text),a&&(a=a[0],o.text=o.text.replace(a,""),s[d+1].text=a)),0===d&&i.length>0&&n.travel_mode!==c.travel_modes.DIRECT&&o.text===i[i.length-1].text?void 0:{actions:{center:e.proxy(function(){this.map.panTo(o.point),this.activatePointer(o.point)},this),update:function(){return o.parent?function(e){o.parent.setNote({text:e,index:o.order,suppress_publish:!0})}:null}(),zoom:e.proxy(function(){this.fitMapToBounds(this.getRouteBounds([o.point]))},this)},distance:o.distance,duration:o.duration,icon:e.proxy(function(){var e;return 1===h?e=p.getStart():o.icon&&(e={icon:o.icon}),l(e?{icon:e}:{text:o.text})},this)(t,d),text:o.text}},this)))},this))}this.cue_notes=i,t.publish(this.map_id+".updated.route.cue_notes",this.cue_notes)},updateFloatingMarkerPosition:function(i,n){if(this.segments.length()){var s,o,a,l,c,h,u,p,d,f,g,m,v,_=this.api.createPolyline({clickable:!1,editable:!1,geodesic:!0,visible:!1}),y=this.map.getProjection(),b=this.segments.get(),x=i.getPoint(),w=y.fromLatLngToPoint(x),k=9999999,M=function(e){return y.fromLatLngToPoint(e)};for(o=0,a=b.length;a>o;o++)for(s=b[o],p=s.getPoints(),d=e.map(p,M),l=0,c=d.length-1;c>l;l++)f=r.getClosestPoint(d[l],d[l+1],w,!0),g=y.fromPointToLatLng(f),_.setPath([x,g]),m=_.computeDistance(),k>m&&(v=d.slice(0,l+1),k=m,u=g,h=s);h&&(i.associated_segment!==h&&(i.associated_segment&&i.associated_segment.associated_markers.hasOwnProperty(i.uid)&&delete i.associated_segment.associated_markers[i.uid],h.associated_markers[i.uid]=i,i.associated_segment=h),i.associated_vertex!==u&&(i.setAssociatedVertex(u),v=e.map(v,function(e){return y.fromPointToLatLng(e)}),_.setPath(v.concat(u)),i.distance=_.computeDistance(),n||t.publish(this.map_id+".updated.cue_notes")))}},updateFloatingMarkerPositions:function(){var t,i;this.markers&&(window.clearTimeout(this.timeouts.update_floating_marker_positions),this.timeouts.update_floating_marker_positions=window.setTimeout(e.proxy(function(){for(t=0,i=this.markers.length();i>t;t++)this.updateFloatingMarkerPosition(this.markers.get(t))},this),1e3))},updateRouteElevations:function(){setTimeout(function(){var t=100;if(this.segments&&this.segments.length()>0){if(o.ignoreElevation())return;this.api.getElevationsForPath({callback:e.proxy(function(e){this.setRouteElevations(e)},this),polyline:this.guideline,samples:t})}else this.setRouteElevations([])}.bind(this),100)}});return I}),mmf_mapping_api.define("classes/DirectionsModeHandler",["jquery","pubsub","logger","message_mgr","map_configs","classes/Class"],function(e,t,i,n,s,o){var r=o.extend({init:function(e){this.map_id=e.map_id,this.routes=[],this.polylines=[]},clearRoute:function(){for(;this.polylines.length>0;)this.polylines.pop().setMap(null);this.routes.length=0},displayRoute:function(){this.routes&&this.routes.length&&t.publish(this.map_id+".mapped.directions_mode_route",{path:this.routes[0].path})},getRoute:function(e){return e.origin&&e.destination?(this.clearRoute(),t.publish(this.map_id+".mapped.via_directions_mode",{path:[e.origin,e.destination],travel_mode:e.travel_mode||s.travelMode(this.map_id)}),void 0):(a(this.map_id,"Please enter both origin and destination addresses."),void 0)}}),a=function(e,i){t.publish(e+".error",{message:i})};return r}),mmf_mapping_api.define("classes/AutoRouteModeHandler",["jquery","pubsub","logger","message_mgr","utils/calculations","constants","storage","map_configs","classes/Class"],function(e,t,i,n,s,o,r,a,l,c){var h=.75,u=1.5,p=1609344,d=20,f=5,g=5,m=l.extend({init:function(e){this.map_id=e.map_id,this.Map=r.getMap(this.map_id),this.map=this.Map.map,this.api=this.Map.api,this.original_request_parms=null,this.original_waypoint_guide=null,this.transient_route_polyline=null,this.measurement_polyline=null,this.calc_try_ctr=0,this.calc_fail_ctr=0,this.route_length_match_attempt_ctr=0,this.debug_counters={calc_route:0,gen_route:0,scaled_length:0},this.scaling={ctr:0,factor:.8,route_too_long_ctr:0,route_too_short_ctr:0},this.route=null,this.key_waypoints=null,this.default_options={avoid_ferries:!0,avoid_highways:a.avoidHighways(this.map_id),avoid_tolls:!1,clean_route:!0,override_comparison:!1,travel_mode:e.travel_mode||a.travelMode(this.map_id),unit:a.unit(this.map_id)}},calculateRoute:function(n){this.debug_counters.calc_route++;var s,o=e.proxy(function(e){e&&(i.log("calc_try_ctr: ",this.calc_try_ctr),i.log("calc_fail_ctr:",this.calc_fail_ctr),i.log("gen_route_ctr:",this.debug_counters.gen_route),i.log("calc_route_ctr:",this.debug_counters.calc_route),i.log("scaled_length_ctr:",this.scaling.ctr),i.log("route_too_long_ctr:",this.scaling.route_too_long_ctr),i.log("route_too_short_ctr:",this.scaling.route_too_short_ctr))},this),r=!1,a=!1,l={avoid_highways:n.avoid_highways,avoid_tolls:n.avoid_tolls,origin:n.base_location,destination:n.base_location,travel_mode:n.travel_mode,unit:n.unit,waypoints:_(n.waypoints)};this.calc_try_ctr++,this.api.callDirectionsService(l,e.proxy(function(i,l){i&&i.path?(this.transient_route_polyline.setPath(i.path),this.transient_route_polyline.setMap(this.map),t.publish(this.map_id+".updated.route.distance",i.distance),s=n.override_comparison===!0?{keep:!0}:b({avoid_ferries:n.avoid_ferries,current_length:i.distance,desired_length:this.original_request_parms.length,directions:i.directions,unit:n.unit}),s.override&&(n.override_comparison=!0),s.keep===!1?this.calc_try_ctr<=d?a=!0:k(this.map_id,"",{msg:"Route to param comparison is a mismatch, and max # of tries has been reached.",parms:n,directions_service_status:l}):(this.calc_fail_ctr=0,this.route=i,o(!1),n.clean_route&&(n.last_generated_distance===c||i.distance<n.last_generated_distance)&&(n.last_generated_distance=i.distance,n.waypoints=y(i.path,i.raw_response.routes[0].legs[0].via_waypoints),this.key_waypoints=n.waypoints,this.shape_polyline&&this.shape_polyline.setPath([this.original_request_parms.base_location].concat(n.waypoints,[this.original_request_parms.base_location])),r=!0))):(this.calc_fail_ctr++,this.calc_fail_ctr<=f?a=!0:k(this.map_id,"",{msg:"Bad response from directions service call and the max # of tries has been reached.",parms:n,directions_service_status:l})),r?this.calculateRoute(n):a?this.generateRoute(this.original_request_parms):(o(!0),this.finish(e.extend(!0,{},n,{directions:i?i.directions:c,path:i?i.path:c})))},this))},calculateTargetLength:function(){var t=this.route?this.route.distance:0,n=this.original_request_parms.length,s={min:.7,normal:.8,max:1.3};return 0===t?(this.scaling.factor=s.normal,this.scaling.ctr=0,this.scaling.route_too_long_ctr=0,this.scaling.route_too_short_ctr=0):0===this.scaling.ctr?(this.scaling.ctr++,this.scaling.route_too_long_ctr=0,this.scaling.route_too_short_ctr=0):(this.scaling.ctr++,t<n*s.max?(this.scaling.route_too_long_ctr=0,this.scaling.route_too_short_ctr++):t>n*s.min?(this.scaling.route_too_short_ctr=0,this.scaling.route_too_long_ctr++):(this.scaling.route_too_long_ctr=0,this.scaling.route_too_short_ctr=0),this.scaling.route_too_short_ctr>2?(this.scaling.factor+=.02,this.scaling.route_too_short_ctr=0):this.scaling.route_too_long_ctr>2&&(this.scaling.factor-=.02,this.scaling.route_too_long_ctr=0),this.scaling.factor<s.min?this.scaling.factor=s.min:this.scaling.factor>s.max&&(this.scaling.factor=s.max)),i.log("KEY ROUTE LENGTH:",e.proxy(function(){return{km:1e3*n*this.scaling.factor,mi:1609.344*n*this.scaling.factor}},this)()),n*this.scaling.factor},clearMap:function(){this.transient_route_polyline&&this.transient_route_polyline.setMap(null),this.measurement_polyline&&this.measurement_polyline.setMap(null),this.shape_polyline&&this.shape_polyline.setMap(null)},finish:function(e){if(i.log("AR: finish parms:",e),!e.path||e.path.length<2)k(this.map_id,"",{msg:"Reached the finish process without a suitable path.",parms:e});else{var n=M(e);this.clearMap(),this.Map.loadRoute({route:n,load_static_data:!0})}t.publish("end.processing",{}),t.publish("end.auto_route",{})},generateRoute:function(t){i.log("generateRoute"),this.debug_counters.gen_route++,this.debug_counters.calc_route=0;var n=v({base_location:[t.base_location.lng(),t.base_location.lat()],length:this.calculateTargetLength(),heading:t.heading,rotation:t.rotation}),s=e.extend(!0,{},t,{waypoints:e.map(n,e.proxy(function(e){return this.api.createPoint({longitude:e[0],latitude:e[1]})},this))});if(this.original_waypoint_guide=s.waypoints,this.shape_polyline){var o=[t.base_location].concat(s.waypoints,t.base_location);this.shape_polyline.setPath(o)}s.waypoints.length>0?(i.log("generating route: ",s),this.calculateRoute(s)):i.error("No waypoints."),i.log('"generateRoute" has completed')},start:function(n){if(i.log("start:",n),t.publish("start.auto_route",{}),t.publish("start.processing",{text:"Generating route..."}),T(n)===!1)return!1;this.Map.getRouteDistance()>0&&t.publishSync(this.map_id+".begin.altering.map"),this.calc_try_ctr=0,this.calc_fail_ctr=0,this.transient_route_polyline=this.transient_route_polyline||this.api.createPolyline({clickable:!1,draggable:!1,editable:!1,visible:!0,strokeColor:"#0000FF",strokeWeight:7,strokeOpacity:.3}),this.transient_route_polyline.setMap(null),this.measurement_polyline=this.measurement_polyline||this.api.createPolyline({clickable:!1,draggable:!1,editable:!1,visible:!1}),this.measurement_polyline.setMap(this.map),n.debug?(this.shape_polyline=this.shape_polyline||this.api.createPolyline({clickable:!1,draggable:!1,editable:!1,visible:!0,strokeColor:"#666666",strokeWeight:7,strokeOpacity:.3}),this.shape_polyline.setMap(this.map)):this.shape_polyline&&this.shape_polyline.setMap(null);var s=e.extend(!0,{},this.default_options,n,{base_location:this.Map.route_origin_marker?this.Map.route_origin_marker.getPoint():this.Map.location_marker.getPoint()});this.original_request_parms=s;var o;for(o in this.debug_counters)this.debug_counters.hasOwnProperty(o)&&(this.debug_counters[o]=0);this.Map.clearMap(),this.generateRoute(s)}}),v=function(e){var t,i=Math.floor(2*Math.random());return 0===i?t=w.circle(e):1===i?t=w.rectangle(e):2===i&&(t=w.figure8(e)),t},_=function(t){return t?e.map(t,function(e){return{location:e,stopover:!1}}):[]},y=function(e,t){e.slice(1,-1);var i,n,o,r,a=[],l=[],c=[],h=0;for(a.push(0),o=e.length,i=0,n=o-1;n>i;i++)h+=s.computeDistanceBetweenCoordinates(e[i].lat(),e[i].lng(),e[i+1].lat(),e[i+1].lng()),a.push(h);var u,p,d,f,g;for(i=0;o>i;i++){for(d=0,u=window.Number.POSITIVE_INFINITY,f=e[i],n=i+1;o>n;n++)g=e[n],d=s.computeDistanceBetweenCoordinates(f.lat(),f.lng(),g.lat(),g.lng()),u>d&&(u=d,p=n);l[i]=p}var m,v,_=.25;for(i=0;o>i;i++)c.push(e[i]),v=l[i],v!==i+1&&(m=(a[v]-a[i])/h,_>m&&(i=l[i]));var y=[];for(o=t.length,r=c.length,i=0;o>i;i++){for(d=0,u=window.Number.POSITIVE_INFINITY,n=0;r>n;n++)d=s.computeDistanceBetweenCoordinates(t[i].lat(),t[i].lng(),c[n].lat(),c[n].lng()),u>d&&(u=d,p=n);y.push(c[p])}return y},b=function(e){var t=!0,i=!1,n=e.desired_length,s=e.current_length,o=e.directions,r=e.avoid_ferries,a={IMPERIAL:"mi",METRIC:"km"};a[e.unit.toUpperCase()];var l=s/n;t=l>u||h>l&&this.route_length_match_attempt_ctr<=g?!1:!0;var c,p,d=new RegExp(/take the[\s\w\W]+ferry/gi);if(r)for(c=0,p=o.length;p>c;c++)d.exec(o[c].text)&&(t=!1);return{keep:t,override:i}},x=[function(){return Math.random()*Math.PI/4+3*Math.PI/8},function(){return Math.random()*Math.PI/4+1*Math.PI/8},function(){return Math.random()*Math.PI/4-Math.PI/8},function(){return Math.random()*Math.PI/4+13*Math.PI/8},function(){return Math.random()*Math.PI/4+11*Math.PI/8},function(){return Math.random()*Math.PI/4+9*Math.PI/8},function(){return Math.random()*Math.PI/4+7*Math.PI/8},function(){return Math.random()*Math.PI/4+5*Math.PI/8},function(){return 2*Math.random()*Math.PI}],w={circle:function(e){var t,i,n=4,s=e.base_location[0],o=e.base_location[1],r=e.heading===c||e.heading<0||e.heading>7?8:e.heading,a=e.rotation===c||e.rotation>1||e.rotation<0?Math.floor(2*Math.random()):e.rotation,l=x[r].call(),h=e.length/2/Math.PI,u=[],p=0===a?-1:1,d=h*Math.cos(l),f=h*Math.sin(l),g=f/110540,m=d/(111320*Math.cos(o*Math.PI/180)),v=[s+m,o+g],_=[];for(u[0]=l+Math.PI,t=1,i=n+1;i>t;t++)u[t]=u[t-1]+2*p*Math.PI/i,d=h*Math.cos(u[t]),f=h*Math.sin(u[t]),g=f/110540,m=d/(111320*Math.cos(v[1]*Math.PI/180)),_.push([v[0]+m,v[1]+g]);return _},rectangle:function(e){var t,i,n,s,o,r,a=e.base_location[0],l=e.base_location[1],h=e.heading===c||e.heading<0||e.heading>7?8:e.heading,u=e.rotation===c||e.rotation>1||e.rotation<0?Math.floor(2*Math.random()):e.rotation,p=x[h].call(),d=e.length,f=0===u?-1:1,g=5,m=1/g,v=g-m,_=Math.random()*v+m,y=d/(2*_+2),b=y*_,w=Math.sqrt(y*y+b*b),k=Math.acos(b/w),M=[0+p,f*k+p,f*Math.PI/2+p],T=[b,w,y],C=[];for(t=0;3>t;t++)i=M[t],n=T[t]*Math.cos(i),s=T[t]*Math.sin(i),o=s/110540,r=n/(111320*Math.cos(l*Math.PI/180)),C.push([a+r,l+o]);return C},figure8:function(e){var t,i,n,s,o,r,a,l,h,u=e.base_location[0],p=e.base_location[1],d=e.heading===c||e.heading<0||e.heading>7?8:e.heading,f=e.rotation===c||e.rotation>1||e.rotation<0?Math.floor(2*Math.random()):e.rotation,g=x[d].call(),m=e.length,v=[],_=0===f?-1:1,y=m/4/Math.PI,b=3,w=0;for(h=0;2>h;h++){for(l=[g+Math.PI],n=y*Math.cos(g),s=y*Math.sin(g),o=s/110540,r=n/(111320*Math.cos(p*Math.PI/180)),a=[u+r,p+o],t=1,i=b+1;i>t;t++)l.push(l[t-1]+2*_*Math.PI/i),n=y*Math.cos(l[t]),s=y*Math.sin(l[t]),o=s/110540,r=n/(111320*Math.cos(a[1]*Math.PI/180)),v.push([a[0]+r,a[1]+o]),w++;g+=Math.PI,_=-1*_}return v}},k=function(e,n,s){var o="A suitable route could not be generated with the given parameters. Try again in a location with more roads or paths, or try a search with less restrictive options.";t.publish(e+".error",{message:n||o}),s&&i.error(s)},M=function(t){var i,n,s=t.path,o={segments:[]},r={geometry:{coordinates:[],type:"LineString"},properties:{travelMode:t.travel_mode}},a=e.extend(!0,{},r,{properties:{notes:e.map(t.directions,function(e){return e.geometry={coordinates:[e.point.lng(),e.point.lat()],type:"Point"},delete e.point,e})}}),l=s[0],c=[[l.longitude(),l.latitude()]];for(i=1,n=s.length;n>i;i++)l=s[i],c.push([l.longitude(),l.latitude()]),25===c.length&&(a.geometry.coordinates=c,o.segments.push(a),a=e.extend(!0,{},r),c=[[l.longitude(),l.latitude()]]);return c.length>1&&c.length<25&&(a.geometry.coordinates=c,o.segments.push(a)),o},T=function(e){return e=e||{},e.length||e.length>0?e.length>p?(k(this.map_id,"Route length may not be greater than "+e.unit===o.units.METRIC?s.metersToKilometers(p):s.metersToMiles(p)),!1):void 0:(k(this.map_id,"A route length is required."),!1)};return m}),mmf_mapping_api.define("classes/GenericMarker",["jquery","pubsub","logger","message_mgr","constants","map_configs","config/marker_def","uris","classes/Marker"],function(e,t,i,n,s,o,r,a,l){var c=l.extend({init:function(t){t.marker_options=e.extend(!0,{},h,t.marker_options),this.marker_events_initialized=!1,this._super(t),this.marker_events_initialized===!1&&this.initMarkerEvents(),this.content=t.content,this.callbacks=t.callbacks,this.marker_dialog=null},initMarkerEvents:function(){var t=function(e){return'<div><div class="mmf_mapping_api mmf_generic_marker_dialog">'+e+'</div></div><div class="mmf_mapping_api mmf_marker_dialog_tip_container"><div class="mmf_marker_dialog_tip"></div></div></div>'},i=e.proxy(function(e){e?(this.marker_dialog.setContent(t(e)),this.marker_dialog.open(this.map)):this.api.clearEventListeners({event:"click"})},this);this.api.addEventListener({obj:this.marker,event:"click",callback:e.proxy(function(t){this.callbacks&&this.callbacks.click instanceof Function?this.callbacks.click.call(this.marker,{marker:this.marker,point:t}):this.content&&mmf_mapping_api.require(["InfoBox"],e.proxy(function(t){this.marker_dialog=this.marker_dialog||e.proxy(function(){var e={alignBottom:!0,boxStyle:{zIndex:1e4},closeBoxMargin:"8px",disableAutoPan:!1,enableEventPropagation:!1,isHidden:!1,pixelOffset:{height:0,width:u(this.content)},position:this.point,zIndex:1e4};
return new t(e)},this)(),this.content instanceof Function?this.content(e.proxy(function(e){this.content=e,this.marker_dialog.setOptions({pixelOffset:{height:0,width:u(e)}}),i(e)},this)):i(this.content)},this))},this)}),this.api.addEventListener({obj:this.marker,event:"mouseover",callback:e.proxy(function(e){this.callbacks&&this.callbacks.mouseover instanceof Function&&this.callbacks.mouseover.call(this.marker,{marker:this.marker,point:e})},this)}),this.api.addEventListener({obj:this.marker,event:"mouseout",callback:e.proxy(function(e){this.callbacks&&this.callbacks.mouseout instanceof Function&&this.callbacks.mouseout.call(this.marker,{marker:this.marker,point:e})},this)}),this.marker_events_initialized=!0}}),h={clickable:!0,draggable:!1,flat:!0,crossOnDrag:!1,visible:!0},u=function(t){if(t){var i=e(t);return-i.outerWidth()/2}return 0};return c}),mmf_mapping_api.define("public/MapManipulators",["jquery","pubsub","logger","storage","constants","uris","classes/Class","classes/GenericMarker"],function(e,t,i,n,s,o,r,a,l){var c=r.extend({init:function(e){this.map_id=e.map_id,this.Map=n.getMap(this.map_id),this.map=this.Map.map,this.api=this.Map.api,this.markers={}},addMarker:function(i){var n,s;return i.point||i.latitude&&i.longitude?i.point||!window.isNaN(i.latitude)&&!window.isNaN(i.longitude)?(i.marker_options&&(i.marker_options.map=l),s=e.extend(!0,{},i,{api:this.api,map:this.map,map_id:this.map_id,marker_options:e.extend(!0,{icon:{url:i.url}},i.marker_options),callbacks:{click:i.click,mouseover:i.mouseover,mouseout:i.mouseout}}),n=new a(s),this.markers[n.uid]=n,{getPosition:e.proxy(function(){return n.getPoint()},this),remove:e.proxy(function(){delete this.markers[n.uid],n.destroy()},this),setOptions:e.proxy(function(){var e=n.getMarker();return e.setOptions.apply(e,arguments)},this)}):(t.publish(this.map+".error",{message:"addMarker: Coordinates must be Numbers."}),void 0):(t.publish(this.map+".error",{message:"addMarker: Either a point or coordinates must be provided."}),void 0)},fitMapToBounds:function(e){this.Map.fitMapToBounds(this.Map.getRouteBounds(e.vertices||this.Map.coordinatesToVertices({coordinates:e.coordinates})))},clearMarkers:function(){var e,t=this.markers;for(e in t)t.hasOwnProperty(e)&&(t[e].destroy(),delete t[e])},loadKml:function(t){var i=this.Map.addKmlLayer(t);return{remove:e.proxy(function(){this.Map.removeKmlLayer(i.uid)},this)}}});return c}),mmf_mapping_api.define("app",["jquery","libs/polyfill","pubsub","logger","message_mgr","namespace","map_configs","constants","config/default_options","storage","classes/Class","classes/Map","classes/DirectionsModeHandler","classes/AutoRouteModeHandler","public/MapManipulators"],function(e,t,i,n,s,o,r,a,l,c,h,u,p,d,f){var g=h.extend({init:function(){o.MapTypes=a.map_types,o.TravelModes=a.travel_modes,o.UnitsOfMeasure=a.units,o.ApiModes=a.api_modes,o.version=a.version,o.createMap=this.createMap},createMap:function(t,h,g){n.log("map init: ",t),h instanceof Function&&(g=h,h={});var m,v,_;m=c.generateMapId(),n.log("Initialization base settings: ",l),n.log("Initialization user options: ",h),v=r.set(m,e.extend(!0,{},l,h)),_=s.init(m);var y,b,x,w,k={addMarker:function(e){return e.url=e.url||e.uri,e.marker_options=e.options,b.addMarker(e)},autoRoute:function(e){w.start(e)},clearKmls:function(){y.destroyKmlLayers()},clearMarkers:function(){b.clearMarkers()},centerMapOnUserLocation:function(){y.centerMapOnUserLocation()},coordinatesToPoints:function(e){return void 0===e.coordinates&&(e={coordinates:arguments[0]}),y.coordinatesToVertices(e)},fitMapToLocations:function(e){e&&b.fitMapToBounds({coordinates:e.coordinates,vertices:e.points})},getDirectionsModeRoute:function(e){x.getRoute({origin:e.origin,destination:e.destination,travel_mode:e.travel_mode})},getLastPoint:function(){return y.last_route_point},getCenter:function(){return y.getMapCenter().point},getRouteData:function(){return y.toJSON.call(y)},getTravelModesForLocation:function(){var e,t={},i=a.travel_modes;for(e in i)i.hasOwnProperty(e)&&(t[i[e]]=!0);return function(e){return t[a.travel_modes.BICYCLING]=y.checkIfBicyclingDirectionsAvailable(e),t}}(),getUnit:function(){return y.user_interface.getUnitOfMeasure()},goToAddress:function(e){return void 0===e.address&&(e={address:arguments[0],preserve_map_zoom:arguments[1]}),y.goToAddress.call(y,e)},load:function(e){return void 0===e.route&&(e={route:arguments[0]}),y.loadRoute.call(y,e)},loadKml:function(e){return b.loadKml(e)},resizeMap:function(){return y.resizeMap.call(y)},setRouteHighlighter:function(e){arguments.length>0&&void 0===e.points&&(e={points:arguments[0],zoom_to_fit:arguments[1]}),e.points.length>0?y.activateRouteHighlighter({path:e.points}):y.deactivateRouteHighlighter()},setTravelMode:function(e){return r.setTravelMode(m,e)},setUnit:function(e){return r.setUnit(m,e)}},M=function(){c.setMap(m,y),a.debug&&(n.info("new map id: ",m),o.debug=o.debug||{storage:c},o.maps=o.maps||[],o.maps.push(k))};return i.subscribe(m+".initialized.map",function(){M(),b=new f({map_id:m}),x=new p({map_id:m}),w=new d({map_id:m}),g&&g(k)}),y=new u(m,t),k.base_map=y.map,k}});return g}),mmf_mapping_api.require.config({map:{"*":{jquery:"jquery.nc"},"jquery.nc":{jquery:"jquery"}},namespace:"mmf_mapping_api",paths:{constants:"config/constants",map_configs:"globals/map_configs",namespace:"globals/namespace",paths:"config/paths",storage:"globals/storage",uris:"config/uris",units:"config/units",google_maps_api:"libs/google/api",jquery:"libs/jquery/jquery-1.8.2","jquery.nc":"libs/jquery/jquery.nc",pubsub:"libs/pubsub/pubsub",require_lib:"libs/require/require",simplify:"libs/simplify/simplify",geojson_conversion:"libs/google/plugins/geojson_conversion",InfoBox:"libs/google/plugins/InfoBox",point_in_polygon:"libs/google/plugins/point_in_polygon",RichMarker:"libs/google/plugins/RichMarker",jquery_ui:"libs/jquery/plugins/jquery-ui-1.9.0.custom",async:"libs/require/plugins/async",logger:"utils/logger",message_mgr:"utils/message_mgr"},shim:{jquery_ui:{deps:["jquery"]}},waitSeconds:15}),mmf_mapping_api.require(["mapping_api_loaded_callback","app","logger"],function(e,t,i){new t,e instanceof Function?e():i.warn("No callback registered or no callback function name passed.")}),mmf_mapping_api.define("main",function(){});
//# sourceMappingURL=main.js.map
/**
 * @fileOverview This template is meant to be consumed and transformed by the
 *   api loading mechanism. Default values are set in the find/replace routine
 *   of the api loader.
 *
 *   RequireJS Namespace must match what is set in the main.js config.
 */

mmf_mapping_api.require.config({
    baseUrl: 'https://d3o6qfi6hwcdhb.cloudfront.net/1132bce339eb/js' // map to >>> mapping_api_root/dist/js
});

mmf_mapping_api.define('dynamic_constants', {
    consumer_key: 'b513571b80685c74fa95b7755d916c24048889df4',
    debug: (function (str) {
        return str.match(/^true$/i) ? true : false;
    }('false')),
    namespace: 'MMF.Maps',
    signed_token: '1546989903*19eb2ee244d4d7a45bd1e6884369cd7c2a463f32',
    site: 'MapMyRun',
    version: '1132bce339eb'
});

mmf_mapping_api.define('mapping_api_loaded_callback', function () {
    return window['mmf_mapping_api_callback_wrapper' || 'undefined'];
});
